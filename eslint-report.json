[{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\scripts\\mcp-server.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2172,2175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2172,2175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { McpServer } from \"@modelcontextprotocol/sdk/server/mcp.js\";\r\nimport { StdioServerTransport } from \"@modelcontextprotocol/sdk/server/stdio.js\";\r\nimport { z } from \"zod\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\nimport dotenv from \"dotenv\";\r\n\r\ndotenv.config();\r\n\r\nconst SUPABASE_URL = process.env.VITE_SUPABASE_URL;\r\nconst SUPABASE_SERVICE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!SUPABASE_URL || !SUPABASE_SERVICE_KEY) {\r\n    console.error(\"Error: Missing Supabase configuration.\");\r\n    console.error(\"Please add VITE_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY to your .env file.\");\r\n    console.error(\"(You can find the Service Role Key in your Supabase Dashboard > Settings > API)\");\r\n    process.exit(1);\r\n}\r\n\r\n// Create Supabase client with Service Role Key to bypass RLS\r\nconst supabase = createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY);\r\n\r\n// Create MCP Server\r\nconst server = new McpServer({\r\n    name: \"Compliance Companion\",\r\n    version: \"1.0.0\",\r\n});\r\n\r\n// Tool: Get Tasks\r\nserver.tool(\r\n    \"get_tasks\",\r\n    \"List compliance tasks from the database\",\r\n    {\r\n        limit: z.number().optional().default(50).describe(\"Max number of tasks to return\"),\r\n        status: z.enum([\"all\", \"pending\", \"completed\"]).optional().default(\"all\").describe(\"Filter by task status\"),\r\n    },\r\n    async ({ limit, status }) => {\r\n        let query = supabase.from(\"tasks\").select(\"*\").order(\"deadline\", { ascending: true }).limit(limit);\r\n\r\n        if (status === \"pending\") {\r\n            query = query.eq(\"completed\", false);\r\n        } else if (status === \"completed\") {\r\n            query = query.eq(\"completed\", true);\r\n        }\r\n\r\n        const { data, error } = await query;\r\n\r\n        if (error) {\r\n            return {\r\n                content: [{ type: \"text\", text: `Error fetching tasks: ${error.message}` }],\r\n                isError: true,\r\n            };\r\n        }\r\n\r\n        if (!data || data.length === 0) {\r\n            return {\r\n                content: [{ type: \"text\", text: \"No tasks found.\" }],\r\n            };\r\n        }\r\n\r\n        // Format tasks for easier reading\r\n        const formattedTasks = data.map((t: any) =>\r\n            `- [${t.completed ? \"x\" : \" \"}] ${t.name} (Due: ${t.deadline.split(\"T\")[0]}) [ID: ${t.id}]`\r\n        ).join(\"\\n\");\r\n\r\n        return {\r\n            content: [{ type: \"text\", text: formattedTasks }],\r\n        };\r\n    }\r\n);\r\n\r\n// Tool: Add Task\r\nserver.tool(\r\n    \"add_task\",\r\n    \"Create a new compliance task\",\r\n    {\r\n        name: z.string().describe(\"Task name\"),\r\n        deadline: z.string().describe(\"Deadline (YYYY-MM-DD or ISO string)\"),\r\n        category: z.string().describe(\"Category (e.g., tax, audit, filing)\"),\r\n        user_id: z.string().describe(\"User ID to assign the task to (required for database)\"),\r\n    },\r\n    async ({ name, deadline, category, user_id }) => {\r\n        const { data, error } = await supabase\r\n            .from(\"tasks\")\r\n            .insert({\r\n                name,\r\n                deadline,\r\n                category,\r\n                user_id,\r\n                completed: false\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            return {\r\n                content: [{ type: \"text\", text: `Error adding task: ${error.message}` }],\r\n                isError: true,\r\n            };\r\n        }\r\n\r\n        return {\r\n            content: [{ type: \"text\", text: `Task added successfully: ${data.name} (ID: ${data.id})` }],\r\n        };\r\n    }\r\n);\r\n\r\n// Tool: Complete Task\r\nserver.tool(\r\n    \"complete_task\",\r\n    \"Mark a task as completed\",\r\n    {\r\n        task_id: z.string().describe(\"The UUID of the task to complete\"),\r\n    },\r\n    async ({ task_id }) => {\r\n        const { data, error } = await supabase\r\n            .from(\"tasks\")\r\n            .update({ completed: true, completed_at: new Date().toISOString() })\r\n            .eq(\"id\", task_id)\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            return {\r\n                content: [{ type: \"text\", text: `Error completing task: ${error.message}` }],\r\n                isError: true,\r\n            };\r\n        }\r\n\r\n        return {\r\n            content: [{ type: \"text\", text: `Task marked as completed: ${data.name}` }],\r\n        };\r\n    }\r\n);\r\n\r\nasync function main() {\r\n    const transport = new StdioServerTransport();\r\n    await server.connect(transport);\r\n    console.error(\"Compliance Companion MCP Server running on stdio\");\r\n}\r\n\r\nmain().catch((error) => {\r\n    console.error(\"Fatal error in main loop:\", error);\r\n    process.exit(1);\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\CategoryBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\CategoryFilter.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\Header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\NavLink.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\StatsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\TaskCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\TaskDialog.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchCategories'. Either include it or remove the dependency array.","line":67,"column":6,"nodeType":"ArrayExpression","endLine":67,"endColumn":32,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, profile?.organization_id]","fix":{"range":[2223,2249],"text":"[fetchCategories, profile?.organization_id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":160,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4829,4832],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4829,4832],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { ComplianceTask, RecurrenceType, RECURRENCE_OPTIONS } from \"@/types/task\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { CalendarIcon } from \"lucide-react\";\r\nimport { format } from \"date-fns\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport CreatableSelect from \"react-select/creatable\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\nimport { taskSchema } from \"@/lib/validations\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\n\r\n/* ===============================\r\n   Types\r\n================================ */\r\ninterface CategoryOption {\r\n  value: string;\r\n  label: string;\r\n}\r\n\r\ninterface TaskDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  task?: ComplianceTask | null;\r\n  onSave: (task: Omit<ComplianceTask, \"id\" | \"completed\">) => void;\r\n  onUpdate?: (id: string, task: Partial<ComplianceTask>) => void;\r\n}\r\n\r\nexport function TaskDialog({\r\n  open,\r\n  onOpenChange,\r\n  task,\r\n  onSave,\r\n  onUpdate,\r\n}: TaskDialogProps) {\r\n  const [name, setName] = useState(\"\");\r\n  const [category, setCategory] = useState<string>(\"GST\");\r\n  const [deadline, setDeadline] = useState<Date>(new Date());\r\n  const [clientName, setClientName] = useState(\"\");\r\n  const [clientPhone, setClientPhone] = useState(\"\");\r\n  const [recurrence, setRecurrence] = useState<RecurrenceType>(\"monthly\");\r\n  const [description, setDescription] = useState(\"\");\r\n  const { profile } = useAuth();\r\n\r\n  const [categories, setCategories] = useState<CategoryOption[]>([]);\r\n  const isEditing = !!task;\r\n\r\n  /* ===============================\r\n     Fetch categories from DB\r\n  ================================ */\r\n  useEffect(() => {\r\n    if (profile?.organization_id) {\r\n      fetchCategories();\r\n    }\r\n  }, [profile?.organization_id]);\r\n\r\n  const fetchCategories = async () => {\r\n    if (!profile?.organization_id) return;\r\n    const { data } = await supabase\r\n      .from(\"categories\")\r\n      .select(\"name\")\r\n      .eq(\"organization_id\", profile.organization_id)\r\n      .order(\"name\");\r\n\r\n    if (data) {\r\n      setCategories(\r\n        data.map((c) => ({\r\n          value: c.name,\r\n          label: c.name,\r\n        }))\r\n      );\r\n    }\r\n  };\r\n\r\n  /* ===============================\r\n     Populate form on edit\r\n  ================================ */\r\n  useEffect(() => {\r\n    if (task) {\r\n      setName(task.name);\r\n      setCategory(task.category);\r\n      setDeadline(new Date(task.deadline));\r\n      setClientName(task.client_name || \"\");\r\n      setClientPhone(task.client_phone || \"\");\r\n      setRecurrence(task.recurrence);\r\n      setDescription(task.description || \"\");\r\n    } else {\r\n      setName(\"\");\r\n      setCategory(\"GST\");\r\n      setDeadline(new Date());\r\n      setClientName(\"\");\r\n      setClientPhone(\"\");\r\n      setRecurrence(\"monthly\");\r\n      setDescription(\"\");\r\n    }\r\n  }, [task, open]);\r\n\r\n  /* ===============================\r\n     Ensure category exists (FIXED)\r\n  ================================ */\r\n  const ensureCategoryExists = async (value: string) => {\r\n    if (!value?.trim() || !profile?.organization_id) return;\r\n\r\n    const { error } = await supabase\r\n      .from(\"categories\")\r\n      .upsert(\r\n        {\r\n          name: value.trim(),\r\n          organization_id: profile.organization_id\r\n        },\r\n        { onConflict: \"organization_id,name\" }\r\n      );\r\n\r\n    if (error) {\r\n      console.error(\"Category save failed:\", error);\r\n    }\r\n\r\n    fetchCategories();\r\n  };\r\n\r\n  /* ===============================\r\n     Submit handler\r\n  ================================ */\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!name.trim()) return;\r\n\r\n    await ensureCategoryExists(category);\r\n\r\n    // üõ°Ô∏è SECURITY: SaaS-Standard Validation (Zod)\r\n    const validation = taskSchema.safeParse({\r\n      name: name.trim(),\r\n      category,\r\n      deadline,\r\n      client_name: clientName.trim() || undefined,\r\n      client_phone: clientPhone.trim() || undefined,\r\n      recurrence,\r\n      description: description.trim() || undefined,\r\n    });\r\n\r\n    if (!validation.success) {\r\n      const firstError = validation.error.errors[0].message;\r\n      toast.error(firstError);\r\n      return;\r\n    }\r\n\r\n    // Cast to any then to specific type to bypass strict Omit mismatch if Zod inference is slightly off\r\n    const taskData = validation.data as any;\r\n\r\n    if (isEditing && task && onUpdate) {\r\n      onUpdate(task.id, taskData);\r\n    } else {\r\n      onSave(taskData);\r\n    }\r\n\r\n    onOpenChange(false);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[500px]\">\r\n        <DialogHeader>\r\n          <DialogTitle>\r\n            {isEditing ? \"Edit Task\" : \"Add New Compliance Task\"}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <form onSubmit={handleSubmit}>\r\n          <div className=\"grid gap-4 py-4\">\r\n            <div className=\"grid gap-2\">\r\n              <Label>Task Name *</Label>\r\n              <Input\r\n                value={name}\r\n                onChange={(e) => setName(e.target.value)}\r\n                required\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Category</Label>\r\n              <CreatableSelect\r\n                options={categories}\r\n                value={{ value: category, label: category }}\r\n                onChange={(opt) => setCategory(opt?.value ?? \"\")}\r\n                placeholder=\"Select or create category\"\r\n                formatCreateLabel={(input) => `‚ûï Add \"${input}\"`}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Client Name</Label>\r\n              <Input\r\n                value={clientName}\r\n                onChange={(e) => setClientName(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Client Phone</Label>\r\n              <Input\r\n                value={clientPhone}\r\n                onChange={(e) => setClientPhone(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Deadline</Label>\r\n              <Popover>\r\n                <PopoverTrigger asChild>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    className={cn(\"w-full justify-start\")}\r\n                  >\r\n                    <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                    {format(deadline, \"PPP\")}\r\n                  </Button>\r\n                </PopoverTrigger>\r\n                <PopoverContent className=\"w-auto p-0\">\r\n                  <Calendar\r\n                    mode=\"single\"\r\n                    selected={deadline}\r\n                    onSelect={(d) => d && setDeadline(d)}\r\n                  />\r\n                </PopoverContent>\r\n              </Popover>\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Recurrence</Label>\r\n              <select\r\n                className=\"border rounded-md px-3 py-2\"\r\n                value={recurrence}\r\n                onChange={(e) =>\r\n                  setRecurrence(e.target.value as RecurrenceType)\r\n                }\r\n              >\r\n                {RECURRENCE_OPTIONS.map((r) => (\r\n                  <option key={r.value} value={r.value}>\r\n                    {r.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"grid gap-2\">\r\n              <Label>Description</Label>\r\n              <Textarea\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                rows={3}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n              Cancel\r\n            </Button>\r\n            <Button type=\"submit\">\r\n              {isEditing ? \"Update Task\" : \"Add Task\"}\r\n            </Button>\r\n          </DialogFooter>\r\n        </form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\TaskTransferDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5435,5438],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5435,5438],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from \"react\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogDescription,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\r\nimport { ArrowRight, User, ClipboardList, AlertCircle } from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n    fetchUserTasks,\r\n    transferTasks,\r\n    SystemTask,\r\n} from \"@/utils/taskTransferService\";\r\nimport type { Database } from \"@/integrations/supabase/types\";\r\n\r\ntype Profile = Database[\"public\"][\"Tables\"][\"profiles\"][\"Row\"];\r\n\r\ninterface TaskTransferDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    users: Profile[];\r\n    currentAdminId: string;\r\n    onTransferComplete: () => void;\r\n}\r\n\r\nexport function TaskTransferDialog({\r\n    open,\r\n    onOpenChange,\r\n    users,\r\n    currentAdminId,\r\n    onTransferComplete,\r\n}: TaskTransferDialogProps) {\r\n    const [step, setStep] = useState<\"select\" | \"confirm\">(\"select\");\r\n    const [transferMode, setTransferMode] = useState<\"all\" | \"selected\">(\"all\");\r\n    const [sourceUserId, setSourceUserId] = useState<string>(\"\");\r\n    const [targetUserId, setTargetUserId] = useState<string>(\"\");\r\n    const [tasks, setTasks] = useState<SystemTask[]>([]);\r\n    const [selectedTaskIds, setSelectedTaskIds] = useState<Set<string>>(new Set());\r\n    const [loading, setLoading] = useState(false);\r\n    const [loadingTasks, setLoadingTasks] = useState(false);\r\n\r\n    // Filter out the target user from source options and vice versa\r\n    const sourceUsers = useMemo(\r\n        () => users.filter((u) => u.id !== targetUserId),\r\n        [users, targetUserId]\r\n    );\r\n\r\n    const targetUsers = useMemo(\r\n        () => users.filter((u) => u.id !== sourceUserId),\r\n        [users, sourceUserId]\r\n    );\r\n\r\n    // Selected user's display name\r\n    const sourceUserName = useMemo(() => {\r\n        const user = users.find((u) => u.id === sourceUserId);\r\n        return user?.full_name || user?.email || \"Unknown\";\r\n    }, [users, sourceUserId]);\r\n\r\n    const targetUserName = useMemo(() => {\r\n        const user = users.find((u) => u.id === targetUserId);\r\n        return user?.full_name || user?.email || \"Unknown\";\r\n    }, [users, targetUserId]);\r\n\r\n    // Fetch tasks when source user changes\r\n    useEffect(() => {\r\n        if (sourceUserId) {\r\n            setLoadingTasks(true);\r\n            fetchUserTasks(sourceUserId)\r\n                .then((data) => {\r\n                    setTasks(data);\r\n                    // Default select all tasks\r\n                    setSelectedTaskIds(new Set(data.map((t) => t.id)));\r\n                })\r\n                .catch((error) => {\r\n                    console.error(\"Error fetching tasks:\", error);\r\n                    toast.error(\"Failed to load tasks\");\r\n                    setTasks([]);\r\n                })\r\n                .finally(() => setLoadingTasks(false));\r\n        } else {\r\n            setTasks([]);\r\n            setSelectedTaskIds(new Set());\r\n        }\r\n    }, [sourceUserId]);\r\n\r\n    // Reset state when dialog closes\r\n    useEffect(() => {\r\n        if (!open) {\r\n            setStep(\"select\");\r\n            setTransferMode(\"all\");\r\n            setSourceUserId(\"\");\r\n            setTargetUserId(\"\");\r\n            setTasks([]);\r\n            setSelectedTaskIds(new Set());\r\n        }\r\n    }, [open]);\r\n\r\n    const handleSelectAll = (checked: boolean) => {\r\n        if (checked) {\r\n            setSelectedTaskIds(new Set(tasks.map((t) => t.id)));\r\n        } else {\r\n            setSelectedTaskIds(new Set());\r\n        }\r\n    };\r\n\r\n    const handleTaskSelect = (taskId: string, checked: boolean) => {\r\n        const newSelected = new Set(selectedTaskIds);\r\n        if (checked) {\r\n            newSelected.add(taskId);\r\n        } else {\r\n            newSelected.delete(taskId);\r\n        }\r\n        setSelectedTaskIds(newSelected);\r\n    };\r\n\r\n    const tasksToTransfer = useMemo(() => {\r\n        if (transferMode === \"all\") {\r\n            return tasks;\r\n        }\r\n        return tasks.filter((t) => selectedTaskIds.has(t.id));\r\n    }, [transferMode, tasks, selectedTaskIds]);\r\n\r\n    const canProceed = useMemo(() => {\r\n        if (!sourceUserId || !targetUserId) return false;\r\n        if (sourceUserId === targetUserId) return false;\r\n        if (tasksToTransfer.length === 0) return false;\r\n        return true;\r\n    }, [sourceUserId, targetUserId, tasksToTransfer]);\r\n\r\n    const handleConfirmTransfer = async () => {\r\n        if (!canProceed) return;\r\n\r\n        setLoading(true);\r\n        try {\r\n            const taskIds = tasksToTransfer.map((t) => t.id);\r\n            const result = await transferTasks(taskIds, targetUserId, currentAdminId);\r\n\r\n            if (result.success) {\r\n                toast.success(result.message);\r\n                onTransferComplete();\r\n                onOpenChange(false);\r\n            } else {\r\n                toast.error(result.message);\r\n            }\r\n        } catch (error: any) {\r\n            toast.error(error.message || \"Failed to transfer tasks\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const formatDate = (dateStr: string) => {\r\n        return new Date(dateStr).toLocaleDateString(\"en-IN\", {\r\n            day: \"numeric\",\r\n            month: \"short\",\r\n            year: \"numeric\",\r\n        });\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-hidden flex flex-col\">\r\n                <DialogHeader>\r\n                    <DialogTitle className=\"flex items-center gap-2\">\r\n                        <ArrowRight className=\"h-5 w-5 text-primary\" />\r\n                        Transfer Tasks\r\n                    </DialogTitle>\r\n                    <DialogDescription>\r\n                        Transfer tasks from one user to another. This action will update task ownership.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                {step === \"select\" && (\r\n                    <div className=\"space-y-6 py-4 flex-1 overflow-hidden flex flex-col\">\r\n                        {/* Source User Selection */}\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"source-user\" className=\"flex items-center gap-2\">\r\n                                <User className=\"h-4 w-4\" />\r\n                                Transfer FROM User\r\n                            </Label>\r\n                            <Select value={sourceUserId} onValueChange={setSourceUserId}>\r\n                                <SelectTrigger id=\"source-user\">\r\n                                    <SelectValue placeholder=\"Select source user...\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {sourceUsers.map((user) => (\r\n                                        <SelectItem key={user.id} value={user.id}>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <span>{user.full_name || user.email}</span>\r\n                                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                    {user.role}\r\n                                                </Badge>\r\n                                            </div>\r\n                                        </SelectItem>\r\n                                    ))}\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n\r\n                        {/* Target User Selection */}\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"target-user\" className=\"flex items-center gap-2\">\r\n                                <User className=\"h-4 w-4\" />\r\n                                Transfer TO User\r\n                            </Label>\r\n                            <Select value={targetUserId} onValueChange={setTargetUserId}>\r\n                                <SelectTrigger id=\"target-user\">\r\n                                    <SelectValue placeholder=\"Select target user...\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    {targetUsers.map((user) => (\r\n                                        <SelectItem key={user.id} value={user.id}>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <span>{user.full_name || user.email}</span>\r\n                                                <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                    {user.role}\r\n                                                </Badge>\r\n                                            </div>\r\n                                        </SelectItem>\r\n                                    ))}\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n\r\n                        {/* Transfer Mode */}\r\n                        {sourceUserId && (\r\n                            <div className=\"space-y-3\">\r\n                                <Label>Transfer Mode</Label>\r\n                                <RadioGroup\r\n                                    value={transferMode}\r\n                                    onValueChange={(v) => setTransferMode(v as \"all\" | \"selected\")}\r\n                                    className=\"flex gap-4\"\r\n                                >\r\n                                    <div className=\"flex items-center space-x-2\">\r\n                                        <RadioGroupItem value=\"all\" id=\"mode-all\" />\r\n                                        <Label htmlFor=\"mode-all\" className=\"cursor-pointer\">\r\n                                            All Tasks ({tasks.length})\r\n                                        </Label>\r\n                                    </div>\r\n                                    <div className=\"flex items-center space-x-2\">\r\n                                        <RadioGroupItem value=\"selected\" id=\"mode-selected\" />\r\n                                        <Label htmlFor=\"mode-selected\" className=\"cursor-pointer\">\r\n                                            Selected Tasks ({selectedTaskIds.size})\r\n                                        </Label>\r\n                                    </div>\r\n                                </RadioGroup>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Task List (for selected mode) */}\r\n                        {sourceUserId && transferMode === \"selected\" && (\r\n                            <div className=\"h-[300px] flex flex-col\">\r\n                                <div className=\"flex items-center justify-between mb-2\">\r\n                                    <Label className=\"flex items-center gap-2\">\r\n                                        <ClipboardList className=\"h-4 w-4\" />\r\n                                        Select Tasks\r\n                                    </Label>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <Checkbox\r\n                                            id=\"select-all\"\r\n                                            checked={\r\n                                                tasks.length > 0 && selectedTaskIds.size === tasks.length\r\n                                            }\r\n                                            onCheckedChange={handleSelectAll}\r\n                                        />\r\n                                        <Label htmlFor=\"select-all\" className=\"text-sm cursor-pointer\">\r\n                                            Select All\r\n                                        </Label>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {loadingTasks ? (\r\n                                    <div className=\"flex items-center justify-center py-8 text-muted-foreground\">\r\n                                        Loading tasks...\r\n                                    </div>\r\n                                ) : tasks.length === 0 ? (\r\n                                    <div className=\"flex items-center justify-center py-8 text-muted-foreground\">\r\n                                        No tasks found for this user\r\n                                    </div>\r\n                                ) : (\r\n                                    <ScrollArea className=\"flex-1 border rounded-md\">\r\n                                        <div className=\"p-2 space-y-1\">\r\n                                            {tasks.map((task) => (\r\n                                                <div\r\n                                                    key={task.id}\r\n                                                    className=\"flex items-center gap-3 p-2 hover:bg-muted rounded-md\"\r\n                                                >\r\n                                                    <Checkbox\r\n                                                        id={`task-${task.id}`}\r\n                                                        checked={selectedTaskIds.has(task.id)}\r\n                                                        onCheckedChange={(checked) =>\r\n                                                            handleTaskSelect(task.id, checked as boolean)\r\n                                                        }\r\n                                                    />\r\n                                                    <div className=\"flex-1 min-w-0\">\r\n                                                        <p className=\"text-sm font-medium truncate\">\r\n                                                            {task.name}\r\n                                                        </p>\r\n                                                        <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                                                            <Badge variant=\"outline\" className=\"text-xs\">\r\n                                                                {task.category.replace(\"_\", \"-\")}\r\n                                                            </Badge>\r\n                                                            <span>Due: {formatDate(task.deadline)}</span>\r\n                                                            {task.completed && (\r\n                                                                <Badge variant=\"secondary\" className=\"text-xs\">\r\n                                                                    Completed\r\n                                                                </Badge>\r\n                                                            )}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    </ScrollArea>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Validation Messages */}\r\n                        {sourceUserId && targetUserId && sourceUserId === targetUserId && (\r\n                            <div className=\"flex items-center gap-2 text-destructive text-sm\">\r\n                                <AlertCircle className=\"h-4 w-4\" />\r\n                                Source and target user cannot be the same\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {step === \"confirm\" && (\r\n                    <div className=\"py-6 space-y-4\">\r\n                        <div className=\"border rounded-lg p-4 bg-muted/50\">\r\n                            <h4 className=\"font-medium mb-3\">Transfer Summary</h4>\r\n                            <div className=\"space-y-2 text-sm\">\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-muted-foreground\">From:</span>\r\n                                    <span className=\"font-medium\">{sourceUserName}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-muted-foreground\">To:</span>\r\n                                    <span className=\"font-medium\">{targetUserName}</span>\r\n                                </div>\r\n                                <div className=\"flex justify-between\">\r\n                                    <span className=\"text-muted-foreground\">Tasks to transfer:</span>\r\n                                    <span className=\"font-medium\">{tasksToTransfer.length}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4 text-sm text-amber-800\">\r\n                            <div className=\"flex items-start gap-2\">\r\n                                <AlertCircle className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\r\n                                <div>\r\n                                    <p className=\"font-medium\">This action will:</p>\r\n                                    <ul className=\"list-disc list-inside mt-1 space-y-1\">\r\n                                        <li>Change ownership of {tasksToTransfer.length} task(s)</li>\r\n                                        <li>Tasks will appear in {targetUserName}'s dashboard</li>\r\n                                        <li>This transfer will be logged for audit purposes</li>\r\n                                    </ul>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n\r\n                <DialogFooter className=\"gap-2\">\r\n                    {step === \"select\" ? (\r\n                        <>\r\n                            <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n                                Cancel\r\n                            </Button>\r\n                            <Button\r\n                                onClick={() => setStep(\"confirm\")}\r\n                                disabled={!canProceed}\r\n                                className=\"gap-2\"\r\n                            >\r\n                                Continue\r\n                                <ArrowRight className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </>\r\n                    ) : (\r\n                        <>\r\n                            <Button variant=\"outline\" onClick={() => setStep(\"select\")}>\r\n                                Back\r\n                            </Button>\r\n                            <Button\r\n                                onClick={handleConfirmTransfer}\r\n                                disabled={loading}\r\n                                className=\"gap-2\"\r\n                            >\r\n                                {loading ? \"Transferring...\" : `Transfer ${tasksToTransfer.length} Task(s)`}\r\n                                <ArrowRight className=\"h-4 w-4\" />\r\n                            </Button>\r\n                        </>\r\n                    )}\r\n                </DialogFooter>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\UrgencyBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\AnalyticsCharts.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[665,668],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[665,668],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[727,730],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[727,730],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchAnalytics'. Either include it or remove the dependency array.","line":22,"column":8,"nodeType":"ArrayExpression","endLine":22,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchAnalytics, profile]","fix":{"range":[838,847],"text":"[fetchAnalytics, profile]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport {\r\n    PieChart, Pie, Cell, ResponsiveContainer, Legend, Tooltip,\r\n    BarChart, Bar, XAxis, YAxis, CartesianGrid\r\n} from \"recharts\";\r\nimport { Loader2, PieChart as PieChartIcon, BarChart as BarChartIcon } from \"lucide-react\";\r\n\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\n\r\nexport function AnalyticsCharts() {\r\n    const { profile } = useAuth();\r\n    const [loading, setLoading] = useState(true);\r\n    const [categoryData, setCategoryData] = useState<any[]>([]);\r\n    const [statusData, setStatusData] = useState<any[]>([]);\r\n\r\n    useEffect(() => {\r\n        if (profile) {\r\n            fetchAnalytics();\r\n        }\r\n    }, [profile]);\r\n\r\n    const fetchAnalytics = async () => {\r\n        if (!profile) return;\r\n        try {\r\n            const { data: tasks, error } = await supabase\r\n                .from(\"tasks\")\r\n                .select(\"category, completed\")\r\n                .eq(\"organization_id\", profile.organization_id); // üõ°Ô∏è Org isolation\r\n\r\n            if (error) throw error;\r\n\r\n            if (tasks) {\r\n                // Process Category Data\r\n                const catMap: Record<string, number> = {};\r\n                tasks.forEach(t => {\r\n                    const cat = t.category || \"Uncategorized\";\r\n                    catMap[cat] = (catMap[cat] || 0) + 1;\r\n                });\r\n                const cData = Object.keys(catMap).map(key => ({\r\n                    name: key,\r\n                    value: catMap[key]\r\n                }));\r\n                setCategoryData(cData);\r\n\r\n                // Process Status Data\r\n                const pending = tasks.filter(t => !t.completed).length;\r\n                const completed = tasks.filter(t => t.completed).length;\r\n                setStatusData([\r\n                    { name: \"Pending\", value: pending, fill: \"hsl(var(--warning))\" },\r\n                    { name: \"Completed\", value: completed, fill: \"hsl(var(--success))\" } // You might need to define success color or use a static one\r\n                ]);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error fetching analytics:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const COLORS = ['#0088FE', '#00C49F', '#FFBB28', '#FF8042', '#8884d8'];\r\n\r\n    if (loading) {\r\n        return <div className=\"flex justify-center p-8\"><Loader2 className=\"animate-spin text-primary\" /></div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"grid gap-6 md:grid-cols-2\">\r\n            {/* Category Distribution */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"text-lg flex items-center gap-2\">\r\n                        <PieChartIcon className=\"h-5 w-5 text-primary\" />\r\n                        Task Distribution\r\n                    </CardTitle>\r\n                    <CardDescription>Breakdown by compliance category</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"h-[300px] w-full\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <PieChart>\r\n                                <Pie\r\n                                    data={categoryData}\r\n                                    cx=\"50%\"\r\n                                    cy=\"50%\"\r\n                                    innerRadius={60}\r\n                                    outerRadius={100}\r\n                                    paddingAngle={5}\r\n                                    dataKey=\"value\"\r\n                                >\r\n                                    {categoryData.map((entry, index) => (\r\n                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\r\n                                    ))}\r\n                                </Pie>\r\n                                <Tooltip />\r\n                                <Legend />\r\n                            </PieChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n\r\n            {/* Status Overview */}\r\n            <Card>\r\n                <CardHeader>\r\n                    <CardTitle className=\"text-lg flex items-center gap-2\">\r\n                        <BarChartIcon className=\"h-5 w-5 text-primary\" />\r\n                        Completion Status\r\n                    </CardTitle>\r\n                    <CardDescription>Active vs Completed tasks</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                    <div className=\"h-[300px] w-full\">\r\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                            <BarChart data={statusData}>\r\n                                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                                <XAxis dataKey=\"name\" />\r\n                                <YAxis />\r\n                                <Tooltip />\r\n                                <Bar dataKey=\"value\" radius={[4, 4, 0, 0]}>\r\n                                    {statusData.map((entry, index) => (\r\n                                        <Cell key={`cell-${index}`} fill={index === 0 ? \"#f59e0b\" : \"#22c55e\"} />\r\n                                    ))}\r\n                                </Bar>\r\n                            </BarChart>\r\n                        </ResponsiveContainer>\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\CalendarView.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTasks'. Either include it or remove the dependency array.","line":34,"column":8,"nodeType":"ArrayExpression","endLine":34,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTasks, profile]","fix":{"range":[1073,1082],"text":"[fetchTasks, profile]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Calendar, momentLocalizer } from 'react-big-calendar';\r\nimport moment from 'moment';\r\nimport 'react-big-calendar/lib/css/react-big-calendar.css';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Calendar as CalendarIcon, Loader2 } from 'lucide-react';\r\nimport type { Database } from '@/integrations/supabase/types';\r\nimport { useAuth } from '@/hooks/useAuth';\r\n\r\n// Setup localizer\r\nconst localizer = momentLocalizer(moment);\r\n\r\ntype Task = Database['public']['Tables']['tasks']['Row'];\r\n\r\ninterface CalendarEvent {\r\n    id: string;\r\n    title: string;\r\n    start: Date;\r\n    end: Date;\r\n    allDay: boolean;\r\n    resource: Task;\r\n}\r\n\r\nexport function CalendarView() {\r\n    const { profile } = useAuth();\r\n    const [events, setEvents] = useState<CalendarEvent[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (profile) {\r\n            fetchTasks();\r\n        }\r\n    }, [profile]);\r\n\r\n    const fetchTasks = async () => {\r\n        if (!profile) return;\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('tasks')\r\n                .select('*')\r\n                .eq('organization_id', profile.organization_id); // üõ°Ô∏è Org isolation\r\n\r\n            if (error) throw error;\r\n\r\n            if (data) {\r\n                const formattedEvents: CalendarEvent[] = data.map(task => ({\r\n                    id: task.id,\r\n                    title: task.name,\r\n                    start: new Date(task.deadline),\r\n                    end: new Date(task.deadline),\r\n                    allDay: true,\r\n                    resource: task\r\n                }));\r\n                setEvents(formattedEvents);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching tasks for calendar:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const eventStyleGetter = (event: CalendarEvent) => {\r\n        let backgroundColor = 'hsl(var(--primary))';\r\n        const category = event.resource.category.toLowerCase();\r\n\r\n        if (category === 'gst') backgroundColor = 'hsl(var(--gst))';\r\n        else if (category === 'income tax') backgroundColor = 'hsl(var(--income-tax))';\r\n        else if (category === 'insurance') backgroundColor = 'hsl(var(--insurance))';\r\n        else if (category === 'transport') backgroundColor = 'hsl(var(--transport))';\r\n\r\n        if (event.resource.completed) {\r\n            backgroundColor = 'hsl(var(--muted-foreground))';\r\n        }\r\n\r\n        return {\r\n            style: {\r\n                backgroundColor,\r\n                borderRadius: '4px',\r\n                opacity: 0.8,\r\n                color: 'white',\r\n                border: '0px',\r\n                display: 'block'\r\n            }\r\n        };\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex justify-center items-center h-96\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <Card className=\"h-[800px] border-none shadow-none\">\r\n            <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                    <CalendarIcon className=\"h-5 w-5 text-primary\" />\r\n                    Compliance Calendar\r\n                </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"h-full\">\r\n                <Calendar\r\n                    localizer={localizer}\r\n                    events={events}\r\n                    startAccessor=\"start\"\r\n                    endAccessor=\"end\"\r\n                    style={{ height: '100%', minHeight: '600px' }}\r\n                    eventPropGetter={eventStyleGetter}\r\n                    views={['month', 'agenda']}\r\n                    defaultView='month'\r\n                    className=\"text-inherit\"\r\n                    tooltipAccessor={event => `${event.title} (${event.resource.category})`}\r\n                />\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\ClientRemindersTab.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchDbClients'. Either include it or remove the dependency array.","line":148,"column":8,"nodeType":"ArrayExpression","endLine":148,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [fetchDbClients, profile?.organization_id]","fix":{"range":[5363,5389],"text":"[fetchDbClients, profile?.organization_id]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a duplicate dependency: 'customCategories'. Either omit it or remove the dependency array.","line":178,"column":8,"nodeType":"ArrayExpression","endLine":178,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [customCategories, hiddenCategoryNames]","fix":{"range":[6439,6496],"text":"[customCategories, hiddenCategoryNames]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTasks'. Either include it or remove the dependency array.","line":191,"column":8,"nodeType":"ArrayExpression","endLine":191,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTasks, profile?.organization_id]","fix":{"range":[6847,6873],"text":"[fetchTasks, profile?.organization_id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":227,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":227,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8139,8142],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8139,8142],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":228,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8207,8210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8207,8210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":233,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":233,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8400,8403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8400,8403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":348,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":348,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12634,12637],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12634,12637],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":515,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":515,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19171,19174],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19171,19174],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":587,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":587,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22041,22044],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22041,22044],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\";\r\nimport { Mail, Send, Loader2, Users, AlertCircle, Search, CheckCircle2, Plus, UserPlus, FolderOpen, Tag, X, Trash2 } from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\nimport type { Database } from \"@/integrations/supabase/types\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\n\r\n// Predefined compliance categories\r\nconst PREDEFINED_CATEGORIES = [\r\n    \"GST\",\r\n    \"ESIC\",\r\n    \"PF\",\r\n    \"Income Tax\",\r\n    \"TDS\",\r\n    \"ROC\",\r\n    \"MCA\",\r\n    \"Audit\",\r\n    \"Other\",\r\n] as const;\r\n\r\ntype Task = Database[\"public\"][\"Tables\"][\"tasks\"][\"Row\"];\r\n\r\ninterface ClientInfo {\r\n    name: string;\r\n    email: string;\r\n    taskCount: number;\r\n    pendingTasks: Task[];\r\n    isManual?: boolean;\r\n    category?: string;\r\n}\r\n\r\nexport function ClientRemindersTab() {\r\n    const { profile } = useAuth();\r\n    const [tasks, setTasks] = useState<Task[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [sending, setSending] = useState(false);\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [selectedClients, setSelectedClients] = useState<Set<string>>(new Set());\r\n    const [emailOverrides, setEmailOverrides] = useState<Record<string, string>>({});\r\n    const [subject, setSubject] = useState(\"Reminder: Upcoming Compliance Deadline\");\r\n    const [messageBody, setMessageBody] = useState(\r\n        `Dear Client,\\n\\nThis is a friendly reminder regarding your upcoming compliance deadlines. Please review and take necessary action.\\n\\nBest regards,\\nCompliance Team`\r\n    );\r\n\r\n    // Persistent clients from DB\r\n    const [dbClients, setDbClients] = useState<ClientInfo[]>([]);\r\n    const [newClientName, setNewClientName] = useState(\"\");\r\n    const [newClientEmail, setNewClientEmail] = useState(\"\");\r\n\r\n    // Category system\r\n    const [clientCategories, setClientCategories] = useState<Record<string, string>>({});\r\n    const [customCategories, setCustomCategories] = useState<string[]>([]);\r\n    // Hidden clients (deleted from view)\r\n    const [hiddenClients, setHiddenClients] = useState<string[]>([]);\r\n    const [activeCategory, setActiveCategory] = useState<string>(\"all\");\r\n    const [newCategoryName, setNewCategoryName] = useState(\"\");\r\n    const [addCategoryOpen, setAddCategoryOpen] = useState(false);\r\n\r\n    // Fetch all settings on load\r\n    useEffect(() => {\r\n        if (!profile?.organization_id) return;\r\n\r\n        const loadAllSettings = async () => {\r\n            try {\r\n                // 1. Fetch Client Settings (Assignments & Hidden status)\r\n                const { data: settingsData } = await supabase\r\n                    .from(\"client_settings\")\r\n                    .select(\"*\")\r\n                    .eq(\"organization_id\", profile.organization_id);\r\n\r\n                if (settingsData) {\r\n                    const newCategories: Record<string, string> = {};\r\n                    const newHiddenClients: string[] = [];\r\n\r\n                    settingsData.forEach(s => {\r\n                        if (s.category) newCategories[s.client_name] = s.category;\r\n                        if (s.is_hidden) newHiddenClients.push(s.client_name);\r\n                    });\r\n\r\n                    setClientCategories(newCategories);\r\n                    setHiddenClients(newHiddenClients);\r\n                }\r\n\r\n                // 2. Fetch Hidden Categories\r\n                const { data: hiddenCatsData } = await supabase\r\n                    .from(\"hidden_categories\")\r\n                    .select(\"category_name\")\r\n                    .eq(\"organization_id\", profile.organization_id);\r\n\r\n                if (hiddenCatsData) {\r\n                    setHiddenCategoryNames(hiddenCatsData.map(c => c.category_name));\r\n                }\r\n\r\n                // 3. Fetch Custom Categories\r\n                const { data: catData } = await supabase\r\n                    .from(\"categories\")\r\n                    .select(\"name\")\r\n                    .eq(\"organization_id\", profile.organization_id);\r\n\r\n                if (catData) {\r\n                    setCustomCategories(catData.map(c => c.name));\r\n                }\r\n\r\n            } catch (error) {\r\n                console.error(\"Error loading settings:\", error);\r\n            }\r\n        };\r\n\r\n        loadAllSettings();\r\n    }, [profile?.organization_id]);\r\n\r\n    // Fetch persistent clients on load\r\n    useEffect(() => {\r\n        if (profile?.organization_id) {\r\n            fetchDbClients();\r\n        }\r\n    }, [profile?.organization_id]);\r\n\r\n    const fetchDbClients = async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"clients\")\r\n                .select(\"*\")\r\n                .eq(\"organization_id\", profile?.organization_id);\r\n\r\n            if (error) throw error;\r\n\r\n            const formatted = (data || []).map(c => ({\r\n                name: c.name,\r\n                email: c.email || \"\",\r\n                taskCount: 0,\r\n                pendingTasks: [],\r\n                isManual: true, // Treat as manual for delete logic\r\n                id: c.id // Keep ID for deletion\r\n            }));\r\n            setDbClients(formatted);\r\n        } catch (error) {\r\n            console.error(\"Error fetching clients:\", error);\r\n        }\r\n    };\r\n\r\n    // Hidden predefined categories\r\n    const [hiddenCategoryNames, setHiddenCategoryNames] = useState<string[]>([]);\r\n\r\n    const activeCategories = useMemo(() => {\r\n        return [...PREDEFINED_CATEGORIES.filter(c => !hiddenCategoryNames.includes(c)), ...customCategories];\r\n    }, [customCategories, hiddenCategoryNames, customCategories]);\r\n\r\n    const allCategories = useMemo(() => {\r\n        return [...PREDEFINED_CATEGORIES, ...customCategories];\r\n    }, [customCategories]);\r\n\r\n    // For dropdowns, use active categories\r\n    const dropdownCategories = activeCategories;\r\n\r\n    useEffect(() => {\r\n        if (profile?.organization_id) {\r\n            fetchTasks();\r\n        }\r\n    }, [profile?.organization_id]);\r\n\r\n    const fetchTasks = async () => {\r\n        if (!profile?.organization_id) return;\r\n        setLoading(true);\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from(\"tasks\")\r\n                .select(\"*\")\r\n                .eq(\"organization_id\", profile.organization_id)\r\n                .eq(\"completed\", false)\r\n                .not(\"client_name\", \"is\", null)\r\n                .order(\"deadline\", { ascending: true });\r\n\r\n            if (error) throw error;\r\n            setTasks(data || []);\r\n        } catch (error) {\r\n            console.error(\"Error fetching tasks:\", error);\r\n            toast.error(\"Failed to fetch client data\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Group tasks by client name\r\n    const clients = useMemo(() => {\r\n        const clientMap = new Map<string, ClientInfo>();\r\n\r\n        for (const task of tasks) {\r\n            if (!task.client_name) continue;\r\n\r\n            const existing = clientMap.get(task.client_name);\r\n            if (existing) {\r\n                existing.taskCount++;\r\n                existing.pendingTasks.push(task);\r\n                // Use task email if client doesn't have one yet\r\n                if (!existing.email && (task as any).client_email) {\r\n                    existing.email = (task as any).client_email;\r\n                }\r\n            } else {\r\n                clientMap.set(task.client_name, {\r\n                    name: task.client_name,\r\n                    email: (task as any).client_email || \"\",\r\n                    taskCount: 1,\r\n                    pendingTasks: [task],\r\n                });\r\n            }\r\n        }\r\n\r\n        return Array.from(clientMap.values());\r\n    }, [tasks]);\r\n\r\n    // Merge task clients with manual clients and filter hidden ones\r\n    // Merge task clients with DB clients and filter hidden ones\r\n    const allClients = useMemo(() => {\r\n        // Create a map to merge task clients and DB clients by name\r\n        const mergedMap = new Map<string, ClientInfo>();\r\n\r\n        // Add DB clients first\r\n        dbClients.forEach(c => mergedMap.set(c.name.toLowerCase(), c));\r\n\r\n        // Overlay task clients (they have task counts)\r\n        clients.forEach(c => {\r\n            const existing = mergedMap.get(c.name.toLowerCase());\r\n            if (existing) {\r\n                // Merge details: Task client takes precedence for task counts, but preserve ID/email if better\r\n                existing.taskCount = c.taskCount;\r\n                existing.pendingTasks = c.pendingTasks;\r\n                if (!existing.email && c.email) existing.email = c.email;\r\n                existing.isManual = false; // It has tasks now\r\n            } else {\r\n                mergedMap.set(c.name.toLowerCase(), c);\r\n            }\r\n        });\r\n\r\n        const merged = Array.from(mergedMap.values());\r\n        return merged.filter(c => !hiddenClients.includes(c.name));\r\n    }, [clients, dbClients, hiddenClients]);\r\n\r\n    // Filter clients by search and category\r\n    const filteredClients = useMemo(() => {\r\n        let result = allClients;\r\n\r\n        // Filter by category\r\n        if (activeCategory !== \"all\") {\r\n            result = result.filter(c => clientCategories[c.name] === activeCategory);\r\n        }\r\n\r\n        // Filter by search\r\n        if (searchQuery) {\r\n            const q = searchQuery.toLowerCase();\r\n            result = result.filter(c =>\r\n                c.name.toLowerCase().includes(q) ||\r\n                c.email.toLowerCase().includes(q)\r\n            );\r\n        }\r\n\r\n        return result;\r\n    }, [allClients, searchQuery, activeCategory, clientCategories]);\r\n\r\n    // Handle category assignment (Persist to DB)\r\n    const handleCategoryChange = async (clientName: string, category: string) => {\r\n        const newCategory = category === \"none\" ? null : category;\r\n\r\n        // Optimistic Update\r\n        setClientCategories(prev => ({\r\n            ...prev,\r\n            [clientName]: newCategory || \"\"\r\n        }));\r\n\r\n        try {\r\n            await supabase.from(\"client_settings\").upsert({\r\n                organization_id: profile?.organization_id,\r\n                client_name: clientName,\r\n                category: newCategory,\r\n                updated_at: new Date().toISOString()\r\n            }, { onConflict: \"organization_id,client_name\" });\r\n        } catch (error) {\r\n            console.error(\"Error saving category:\", error);\r\n            toast.error(\"Failed to save category preference\");\r\n        }\r\n    };\r\n\r\n    // Add new custom category\r\n    const handleAddCategory = async () => {\r\n        const trimmed = newCategoryName.trim();\r\n        if (!trimmed) {\r\n            toast.error(\"Please enter a category name\");\r\n            return;\r\n        }\r\n        if ([...PREDEFINED_CATEGORIES, ...customCategories].includes(trimmed)) {\r\n            toast.error(\"This category already exists\");\r\n            return;\r\n        }\r\n\r\n        // Optimistic\r\n        setCustomCategories(prev => [...prev, trimmed]);\r\n        setNewCategoryName(\"\");\r\n        setAddCategoryOpen(false);\r\n\r\n        try {\r\n            await supabase.from(\"categories\").insert({\r\n                organization_id: profile?.organization_id,\r\n                name: trimmed\r\n            });\r\n            toast.success(`Added category: ${trimmed}`);\r\n        } catch (error) {\r\n            console.error(\"Error adding category:\", error);\r\n            toast.error(\"Failed to save category\");\r\n        }\r\n    };\r\n\r\n    // Delete/Hide category\r\n    const handleDeleteCategory = async (category: string) => {\r\n        // Reset active category if deleted\r\n        if (activeCategory === category) setActiveCategory(\"all\");\r\n\r\n        if (PREDEFINED_CATEGORIES.includes(category as any)) {\r\n            // Hide it\r\n            setHiddenCategoryNames(prev => [...prev, category]); // Optimistic\r\n            try {\r\n                await supabase.from(\"hidden_categories\").insert({\r\n                    organization_id: profile?.organization_id,\r\n                    category_name: category\r\n                });\r\n                toast.success(`Category \"${category}\" removed from view`);\r\n            } catch (error) {\r\n                console.error(\"Error hiding category:\", error);\r\n            }\r\n        } else {\r\n            // Delete custom\r\n            setCustomCategories(prev => prev.filter(c => c !== category)); // Optimistic\r\n            try {\r\n                await supabase.from(\"categories\").delete()\r\n                    .eq(\"organization_id\", profile?.organization_id)\r\n                    .eq(\"name\", category);\r\n                toast.success(`Category \"${category}\" deleted`);\r\n            } catch (error) {\r\n                console.error(\"Error deleting category:\", error);\r\n                toast.error(\"Failed to delete category\");\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleToggleCategory = async (cat: string) => {\r\n        const isHidden = hiddenCategoryNames.includes(cat);\r\n\r\n        // Optimistic\r\n        if (isHidden) {\r\n            setHiddenCategoryNames(prev => prev.filter(c => c !== cat));\r\n        } else {\r\n            setHiddenCategoryNames(prev => [...prev, cat]);\r\n        }\r\n\r\n        try {\r\n            if (isHidden) {\r\n                // Show (Delete from hidden)\r\n                await supabase.from(\"hidden_categories\").delete()\r\n                    .eq(\"organization_id\", profile?.organization_id)\r\n                    .eq(\"category_name\", cat);\r\n            } else {\r\n                // Hide (Insert to hidden)\r\n                await supabase.from(\"hidden_categories\").insert({\r\n                    organization_id: profile?.organization_id,\r\n                    category_name: cat\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error toggling category:\", error);\r\n        }\r\n    };\r\n\r\n    // Delete client (Manual -> Delete from DB, Task -> Hide)\r\n    const handleDeleteClient = async (clientName: string) => {\r\n        const client = dbClients.find(c => c.name === clientName);\r\n\r\n        if (client && client.id) {\r\n            // It's in the DB, delete it\r\n            try {\r\n                const { error } = await supabase.from(\"clients\").delete().eq(\"id\", client.id);\r\n                if (error) throw error;\r\n                toast.success(`Removed client \"${clientName}\"`);\r\n                fetchDbClients();\r\n            } catch (error) {\r\n                console.error(\"Error deleting client:\", error);\r\n                toast.error(\"Failed to delete client\");\r\n            }\r\n        } else {\r\n            // It's a system/task-only client, hide it locally & persist\r\n            setHiddenClients(prev => [...prev, clientName]);\r\n            try {\r\n                await supabase.from(\"client_settings\").upsert({\r\n                    organization_id: profile?.organization_id,\r\n                    client_name: clientName,\r\n                    is_hidden: true,\r\n                    updated_at: new Date().toISOString()\r\n                }, { onConflict: \"organization_id,client_name\" });\r\n                toast.success(`Removed \"${clientName}\" from list`);\r\n            } catch (error) {\r\n                console.error(\"Error hiding client:\", error);\r\n                toast.error(\"Failed to hide client\");\r\n            }\r\n        }\r\n        // Remove from selection if selected\r\n        if (selectedClients.has(clientName)) {\r\n            const newSet = new Set(selectedClients);\r\n            newSet.delete(clientName);\r\n            setSelectedClients(newSet);\r\n        }\r\n    };\r\n\r\n    const handleSelectAll = (checked: boolean) => {\r\n        if (checked) {\r\n            const allNames = filteredClients.map(c => c.name);\r\n            setSelectedClients(new Set(allNames));\r\n        } else {\r\n            setSelectedClients(new Set());\r\n        }\r\n    };\r\n\r\n    const handleSelectClient = (clientName: string, checked: boolean) => {\r\n        const newSet = new Set(selectedClients);\r\n        if (checked) {\r\n            newSet.add(clientName);\r\n        } else {\r\n            newSet.delete(clientName);\r\n        }\r\n        setSelectedClients(newSet);\r\n    };\r\n\r\n    const getClientEmail = (clientName: string): string => {\r\n        return emailOverrides[clientName] || allClients.find(c => c.name === clientName)?.email || \"\";\r\n    };\r\n\r\n    const handleEmailChange = (clientName: string, email: string) => {\r\n        setEmailOverrides(prev => ({ ...prev, [clientName]: email }));\r\n    };\r\n\r\n    const validateEmail = (email: string): boolean => {\r\n        return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\r\n    };\r\n\r\n    const handleAddManualClient = async () => {\r\n        const trimmedName = newClientName.trim();\r\n        if (!trimmedName) {\r\n            toast.error(\"Please enter a client name\");\r\n            return;\r\n        }\r\n        if (newClientEmail.trim() && !validateEmail(newClientEmail)) {\r\n            toast.error(\"Please enter a valid email address\");\r\n            return;\r\n        }\r\n\r\n        // Check if currently visible\r\n        if (allClients.some(c => c.name.toLowerCase() === trimmedName.toLowerCase())) {\r\n            toast.error(\"A client with this name already exists\");\r\n            return;\r\n        }\r\n\r\n        // Check if hidden (restore if so)\r\n        if (hiddenClients.some(c => c.toLowerCase() === trimmedName.toLowerCase())) {\r\n            setHiddenClients(prev => prev.filter(c => c.toLowerCase() !== trimmedName.toLowerCase()));\r\n            // Unhide in DB\r\n            await supabase.from(\"client_settings\").upsert({\r\n                organization_id: profile?.organization_id,\r\n                client_name: trimmedName,\r\n                is_hidden: false\r\n            }, { onConflict: \"organization_id,client_name\" });\r\n        }\r\n\r\n        try {\r\n            const { error } = await supabase.from(\"clients\").insert({\r\n                organization_id: profile?.organization_id,\r\n                name: trimmedName,\r\n                email: newClientEmail.trim() || null\r\n            });\r\n\r\n            if (error) throw error;\r\n\r\n            toast.success(`Added ${trimmedName} to directory`);\r\n            setNewClientName(\"\");\r\n            setNewClientEmail(\"\");\r\n            setActiveCategory(\"all\");\r\n            fetchDbClients(); // Refresh list\r\n        } catch (error: any) {\r\n            console.error(\"Error adding client:\", error);\r\n            toast.error(error.message || \"Failed to add client\");\r\n        }\r\n    };\r\n\r\n    const handleSendReminders = async () => {\r\n        const recipients: { email: string; name: string; tasks: string[] }[] = [];\r\n\r\n        for (const clientName of selectedClients) {\r\n            const email = getClientEmail(clientName);\r\n            if (!email || !validateEmail(email)) {\r\n                toast.error(`Invalid email for ${clientName}`);\r\n                return;\r\n            }\r\n            const client = allClients.find(c => c.name === clientName);\r\n            recipients.push({\r\n                email,\r\n                name: clientName,\r\n                tasks: client?.pendingTasks.map(t => t.name) || [],\r\n            });\r\n        }\r\n\r\n        if (recipients.length === 0) {\r\n            toast.error(\"No clients selected\");\r\n            return;\r\n        }\r\n\r\n        setSending(true);\r\n        try {\r\n            // Check if user is authenticated\r\n            const { data: sessionData } = await supabase.auth.getSession();\r\n            if (!sessionData?.session) {\r\n                toast.error(\"Please log in again to send reminders\");\r\n                return;\r\n            }\r\n\r\n            const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\r\n            const response = await fetch(`${supabaseUrl}/functions/v1/send-task-reminders`, {\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"Authorization\": `Bearer ${sessionData.session.access_token}`,\r\n                },\r\n                body: JSON.stringify({\r\n                    clientMode: true,\r\n                    recipients,\r\n                    subject,\r\n                    body: messageBody,\r\n                }),\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                console.error(\"Function error body:\", data);\r\n                throw new Error(data.details || data.error || \"Function call failed\");\r\n            }\r\n\r\n            if (data?.errors && data.errors.length > 0) {\r\n                console.warn(\"Some emails failed:\", data.errors);\r\n                // Check for common Resend error\r\n                const resendError = data.errors.find((e: string) => e.includes(\"onboarding@resend.dev\"));\r\n                if (resendError) {\r\n                    toast.error(\"Resend Free Tier: Can only send to your verified email address.\");\r\n                } else {\r\n                    toast.warning(`Sent ${data.sent} emails, ${data.failed} failed`);\r\n                }\r\n            } else {\r\n                toast.success(`Sent reminders to ${data?.sent || recipients.length} clients`);\r\n            }\r\n            setSelectedClients(new Set());\r\n        } catch (error: any) {\r\n            console.error(\"Error sending reminders:\", error);\r\n            toast.error(error.message || \"Failed to send reminders\");\r\n        } finally {\r\n            setSending(false);\r\n        }\r\n    };\r\n\r\n    const selectedWithValidEmail = Array.from(selectedClients).filter(name =>\r\n        validateEmail(getClientEmail(name))\r\n    ).length;\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center py-12\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Stats Row */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                <Card className=\"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200\">\r\n                    <CardContent className=\"p-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p className=\"text-xs text-blue-600 font-medium uppercase tracking-wide\">Total Clients</p>\r\n                                <p className=\"text-2xl font-bold text-blue-900\">{allClients.length}</p>\r\n                            </div>\r\n                            <Users className=\"h-8 w-8 text-blue-400\" />\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card className=\"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200\">\r\n                    <CardContent className=\"p-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p className=\"text-xs text-green-600 font-medium uppercase tracking-wide\">With Email</p>\r\n                                <p className=\"text-2xl font-bold text-green-900\">\r\n                                    {allClients.filter(c => c.email).length}\r\n                                </p>\r\n                            </div>\r\n                            <Mail className=\"h-8 w-8 text-green-400\" />\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card className=\"bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200\">\r\n                    <CardContent className=\"p-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p className=\"text-xs text-amber-600 font-medium uppercase tracking-wide\">Selected</p>\r\n                                <p className=\"text-2xl font-bold text-amber-900\">{selectedClients.size}</p>\r\n                            </div>\r\n                            <CheckCircle2 className=\"h-8 w-8 text-amber-400\" />\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n                <Card className=\"bg-gradient-to-br from-red-50 to-red-100/50 border-red-200\">\r\n                    <CardContent className=\"p-4\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div>\r\n                                <p className=\"text-xs text-red-600 font-medium uppercase tracking-wide\">Missing Email</p>\r\n                                <p className=\"text-2xl font-bold text-red-900\">\r\n                                    {clients.filter(c => !c.email).length}\r\n                                </p>\r\n                            </div>\r\n                            <AlertCircle className=\"h-8 w-8 text-red-400\" />\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n\r\n            {/* Category Filter Tabs */}\r\n            <Card className=\"p-4\">\r\n                <div className=\"flex flex-wrap items-center gap-2\">\r\n                    <FolderOpen className=\"h-5 w-5 text-muted-foreground\" />\r\n                    <span className=\"text-sm font-medium text-muted-foreground mr-2\">Filter by Category:</span>\r\n\r\n                    <Badge\r\n                        variant={activeCategory === \"all\" ? \"default\" : \"outline\"}\r\n                        className=\"cursor-pointer hover:bg-primary/80 transition-colors\"\r\n                        onClick={() => setActiveCategory(\"all\")}\r\n                    >\r\n                        All ({allClients.length})\r\n                    </Badge>\r\n\r\n                    {activeCategories.map(cat => {\r\n                        const count = allClients.filter(c => clientCategories[c.name] === cat).length;\r\n\r\n                        return (\r\n                            <Badge\r\n                                key={cat}\r\n                                variant={activeCategory === cat ? \"default\" : \"outline\"}\r\n                                className={`cursor-pointer hover:bg-primary/80 transition-colors pr-1 ${activeCategory === cat ? '' : 'text-muted-foreground'}`}\r\n                                onClick={() => setActiveCategory(cat)}\r\n                            >\r\n                                <span className=\"mr-1\">{cat} ({count})</span>\r\n                            </Badge>\r\n                        );\r\n                    })}\r\n\r\n                    <Dialog open={addCategoryOpen} onOpenChange={setAddCategoryOpen}>\r\n                        <DialogTrigger asChild>\r\n                            <Button variant=\"outline\" size=\"sm\" className=\"h-6 gap-1 border-dashed hover:bg-green-100 px-2.5 text-xs font-normal rounded-full\">\r\n                                <Tag className=\"h-3 w-3\" /> Manage Categories\r\n                            </Button>\r\n                        </DialogTrigger>\r\n                        <DialogContent className=\"max-w-md\">\r\n                            <DialogHeader>\r\n                                <DialogTitle>Manage Categories</DialogTitle>\r\n                                <DialogDescription>\r\n                                    Add custom categories or hide default ones you don't use.\r\n                                </DialogDescription>\r\n                            </DialogHeader>\r\n                            <div className=\"space-y-6 py-4\">\r\n                                {/* Add New */}\r\n                                <div className=\"space-y-2\">\r\n                                    <Label htmlFor=\"category-name\">Add New Category</Label>\r\n                                    <div className=\"flex gap-2\">\r\n                                        <Input\r\n                                            id=\"category-name\"\r\n                                            name=\"categoryName\"\r\n                                            placeholder=\"e.g., Audit\"\r\n                                            value={newCategoryName}\r\n                                            onChange={(e) => setNewCategoryName(e.target.value)}\r\n                                            onKeyDown={(e) => e.key === \"Enter\" && handleAddCategory()}\r\n                                        />\r\n                                        <Button size=\"sm\" onClick={handleAddCategory}>Add</Button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Manage Existing */}\r\n                                <div className=\"space-y-2\">\r\n                                    <Label>Active Categories</Label>\r\n                                    <div className=\"border rounded-md p-2 space-y-2 max-h-[200px] overflow-y-auto bg-slate-50\">\r\n                                        {PREDEFINED_CATEGORIES.map(cat => {\r\n                                            const isHidden = hiddenCategoryNames.includes(cat);\r\n                                            return (\r\n                                                <div key={cat} className=\"flex items-center justify-between bg-white p-2 rounded border text-sm\">\r\n                                                    <span className={isHidden ? \"text-muted-foreground line-through\" : \"\"}>{cat}</span>\r\n                                                    <Button\r\n                                                        variant=\"ghost\"\r\n                                                        size=\"sm\"\r\n                                                        className=\"h-6 w-6 p-0\"\r\n                                                        onClick={() => handleToggleCategory(cat)}\r\n                                                        title={isHidden ? \"Show Category\" : \"Hide Category\"}\r\n                                                    >\r\n                                                        {isHidden ? <Plus className=\"h-4 w-4 text-green-500\" /> : <X className=\"h-4 w-4 text-muted-foreground\" />}\r\n                                                    </Button>\r\n                                                </div>\r\n                                            );\r\n                                        })}\r\n                                        {customCategories.map(cat => (\r\n                                            <div key={cat} className=\"flex items-center justify-between bg-white p-2 rounded border text-sm\">\r\n                                                <span>{cat} (Custom)</span>\r\n                                                <Button\r\n                                                    variant=\"ghost\"\r\n                                                    size=\"sm\"\r\n                                                    className=\"h-6 w-6 p-0 hover:text-destructive\"\r\n                                                    onClick={() => handleDeleteCategory(cat)}\r\n                                                    title=\"Delete Category\"\r\n                                                >\r\n                                                    <Trash2 className=\"h-4 w-4\" />\r\n                                                </Button>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </DialogContent>\r\n                    </Dialog>\r\n                </div>\r\n            </Card>\r\n\r\n            <div className=\"grid gap-6 lg:grid-cols-3\">\r\n                {/* Client List */}\r\n                <Card className=\"lg:col-span-2\">\r\n                    <CardHeader>\r\n                        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n                            <div>\r\n                                <CardTitle>Client Directory</CardTitle>\r\n                                <CardDescription>Select clients to send reminders</CardDescription>\r\n                            </div>\r\n                            <div className=\"relative\">\r\n                                <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\r\n                                <Input\r\n                                    id=\"client-search\"\r\n                                    name=\"clientSearch\"\r\n                                    placeholder=\"Search clients...\"\r\n                                    className=\"pl-8 w-[200px] h-9\"\r\n                                    value={searchQuery}\r\n                                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </CardHeader>\r\n                    <CardContent>\r\n                        {filteredClients.length === 0 ? (\r\n                            <div className=\"text-center py-12 text-muted-foreground border-2 border-dashed rounded-lg\">\r\n                                <Users className=\"h-12 w-12 mx-auto mb-4 text-slate-300\" />\r\n                                <p>No clients found with pending tasks.</p>\r\n                                <p className=\"text-sm\">Add client names to your tasks to see them here.</p>\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"rounded-md border max-h-[400px] overflow-auto\">\r\n                                <Table>\r\n                                    <TableHeader className=\"sticky top-0 bg-background\">\r\n                                        <TableRow>\r\n                                            <TableHead className=\"w-[40px]\">\r\n                                                <Checkbox\r\n                                                    checked={selectedClients.size === filteredClients.length && filteredClients.length > 0}\r\n                                                    onCheckedChange={handleSelectAll}\r\n                                                />\r\n                                            </TableHead>\r\n                                            <TableHead>Client</TableHead>\r\n                                            <TableHead>Category</TableHead>\r\n                                            <TableHead>Email</TableHead>\r\n                                            <TableHead className=\"text-center\">Tasks</TableHead>\r\n                                            <TableHead className=\"w-[50px]\"></TableHead>\r\n                                        </TableRow>\r\n                                    </TableHeader>\r\n                                    <TableBody>\r\n                                        {filteredClients.map((client) => {\r\n                                            const email = getClientEmail(client.name);\r\n                                            const isValid = email && validateEmail(email);\r\n                                            return (\r\n                                                <TableRow key={client.name}>\r\n                                                    <TableCell>\r\n                                                        <Checkbox\r\n                                                            checked={selectedClients.has(client.name)}\r\n                                                            onCheckedChange={(checked) => handleSelectClient(client.name, !!checked)}\r\n                                                        />\r\n                                                    </TableCell>\r\n                                                    <TableCell className=\"font-medium\">{client.name}</TableCell>\r\n                                                    <TableCell>\r\n                                                        <Select\r\n                                                            value={clientCategories[client.name] || \"none\"}\r\n                                                            onValueChange={(val) => handleCategoryChange(client.name, val)}\r\n                                                        >\r\n                                                            <SelectTrigger className=\"h-8 w-[120px]\">\r\n                                                                <SelectValue placeholder=\"Select...\" />\r\n                                                            </SelectTrigger>\r\n                                                            <SelectContent>\r\n                                                                <SelectItem value=\"none\">\r\n                                                                    <span className=\"text-muted-foreground\">None</span>\r\n                                                                </SelectItem>\r\n                                                                {dropdownCategories.map(cat => (\r\n                                                                    <SelectItem key={cat} value={cat}>{cat}</SelectItem>\r\n                                                                ))}\r\n                                                            </SelectContent>\r\n                                                        </Select>\r\n                                                    </TableCell>\r\n                                                    <TableCell>\r\n                                                        <Input\r\n                                                            type=\"email\"\r\n                                                            name={`email-${client.name}`}\r\n                                                            placeholder=\"Enter email...\"\r\n                                                            value={emailOverrides[client.name] ?? client.email}\r\n                                                            onChange={(e) => handleEmailChange(client.name, e.target.value)}\r\n                                                            className={`h-8 w-[200px] ${!isValid && email ? 'border-red-300' : ''}`}\r\n                                                        />\r\n                                                    </TableCell>\r\n                                                    <TableCell className=\"text-center\">\r\n                                                        <Badge variant=\"secondary\">{client.taskCount}</Badge>\r\n                                                    </TableCell>\r\n                                                    <TableCell>\r\n                                                        <Button\r\n                                                            variant=\"ghost\"\r\n                                                            size=\"sm\"\r\n                                                            className=\"h-8 w-8 p-0 text-muted-foreground hover:text-destructive\"\r\n                                                            onClick={() => handleDeleteClient(client.name)}\r\n                                                            title=\"Remove Client\"\r\n                                                        >\r\n                                                            <Trash2 className=\"h-4 w-4\" />\r\n                                                        </Button>\r\n                                                    </TableCell>\r\n                                                </TableRow>\r\n                                            );\r\n                                        })}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Manual Client Entry */}\r\n                        <div className=\"mt-4 p-4 border-2 border-dashed rounded-lg bg-slate-50/50\">\r\n                            <div className=\"flex items-center gap-2 mb-3\">\r\n                                <UserPlus className=\"h-4 w-4 text-primary\" />\r\n                                <span className=\"text-sm font-medium\">Add Client Manually</span>\r\n                            </div>\r\n                            <div className=\"flex flex-wrap gap-2\">\r\n                                <Input\r\n                                    id=\"new-client-name\"\r\n                                    name=\"newClientName\"\r\n                                    placeholder=\"Client Name\"\r\n                                    value={newClientName}\r\n                                    onChange={(e) => setNewClientName(e.target.value)}\r\n                                    className=\"h-9 w-[150px]\"\r\n                                />\r\n                                <Input\r\n                                    type=\"email\"\r\n                                    id=\"new-client-email\"\r\n                                    name=\"newClientEmail\"\r\n                                    placeholder=\"client@email.com\"\r\n                                    value={newClientEmail}\r\n                                    onChange={(e) => setNewClientEmail(e.target.value)}\r\n                                    className=\"h-9 w-[200px]\"\r\n                                />\r\n                                <Button\r\n                                    type=\"button\"\r\n                                    size=\"sm\"\r\n                                    onClick={handleAddManualClient}\r\n                                    className=\"h-9 gap-1\"\r\n                                >\r\n                                    <Plus className=\"h-4 w-4\" /> Add\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n\r\n                {/* Compose Email */}\r\n                <Card>\r\n                    <CardHeader>\r\n                        <CardTitle className=\"flex items-center gap-2\">\r\n                            <Mail className=\"h-5 w-5 text-primary\" />\r\n                            Compose Reminder\r\n                        </CardTitle>\r\n                        <CardDescription>Customize the email message</CardDescription>\r\n                    </CardHeader>\r\n                    <CardContent className=\"space-y-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"subject\">Subject</Label>\r\n                            <Input\r\n                                id=\"subject\"\r\n                                name=\"subject\"\r\n                                value={subject}\r\n                                onChange={(e) => setSubject(e.target.value)}\r\n                                placeholder=\"Email subject...\"\r\n                            />\r\n                        </div>\r\n                        <div className=\"space-y-2\">\r\n                            <Label htmlFor=\"body\">Message Body</Label>\r\n                            <Textarea\r\n                                id=\"body\"\r\n                                name=\"body\"\r\n                                value={messageBody}\r\n                                onChange={(e) => setMessageBody(e.target.value)}\r\n                                placeholder=\"Write your message...\"\r\n                                rows={8}\r\n                            />\r\n                        </div>\r\n                        <div className=\"pt-4 border-t\">\r\n                            <Button\r\n                                onClick={handleSendReminders}\r\n                                disabled={sending || selectedWithValidEmail === 0}\r\n                                className=\"w-full gap-2\"\r\n                                size=\"lg\"\r\n                            >\r\n                                {sending ? (\r\n                                    <>\r\n                                        <Loader2 className=\"h-4 w-4 animate-spin\" /> Sending...\r\n                                    </>\r\n                                ) : (\r\n                                    <>\r\n                                        <Send className=\"h-4 w-4\" /> Send to {selectedWithValidEmail} Client{selectedWithValidEmail !== 1 ? 's' : ''}\r\n                                    </>\r\n                                )}\r\n                            </Button>\r\n                            {selectedClients.size > 0 && selectedWithValidEmail < selectedClients.size && (\r\n                                <p className=\"text-xs text-amber-600 mt-2 flex items-center gap-1\">\r\n                                    <AlertCircle className=\"h-3 w-3\" />\r\n                                    {selectedClients.size - selectedWithValidEmail} selected client(s) have invalid emails\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                    </CardContent>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\CreateTaskDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":119,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4210,4213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4210,4213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":133,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4810,4813],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4810,4813],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogFooter,\r\n    DialogHeader,\r\n    DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { CalendarIcon, Loader2, Sparkles } from \"lucide-react\";\r\nimport { format } from \"date-fns\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport {\r\n    Popover,\r\n    PopoverContent,\r\n    PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { toast } from \"sonner\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { taskSchema } from \"@/lib/validations\";\r\n\r\ninterface CreateTaskDialogProps {\r\n    open: boolean;\r\n    onOpenChange: (open: boolean) => void;\r\n    onTaskCreated: () => void;\r\n}\r\n\r\nexport function CreateTaskDialog({\r\n    open,\r\n    onOpenChange,\r\n    onTaskCreated,\r\n}: CreateTaskDialogProps) {\r\n    const { profile } = useAuth();\r\n    const [loading, setLoading] = useState(false);\r\n    const [date, setDate] = useState<Date | undefined>(new Date());\r\n\r\n    const [formData, setFormData] = useState({\r\n        name: \"\",\r\n        category: \"General\",\r\n        description: \"\",\r\n        recurrence: \"none\",\r\n        client_name: \"\",\r\n        client_phone: \"\",\r\n        client_email: \"\",\r\n        amount: \"\", // Note: Schema update pending for this field\r\n    });\r\n\r\n    const templates = [\r\n        { name: \"GSTR-1 Filing\", category: \"GST\", recurrence: \"monthly\", day: 11 },\r\n        { name: \"GSTR-3B Filing\", category: \"GST\", recurrence: \"monthly\", day: 20 },\r\n        { name: \"TDS Payment\", category: \"Income Tax\", recurrence: \"monthly\", day: 7 },\r\n    ];\r\n\r\n    const applyTemplate = (template: typeof templates[0]) => {\r\n        const today = new Date();\r\n        const targetDate = new Date(today.getFullYear(), today.getMonth(), template.day);\r\n        if (targetDate < today) {\r\n            targetDate.setMonth(targetDate.getMonth() + 1);\r\n        }\r\n\r\n        setFormData({\r\n            ...formData,\r\n            name: template.name,\r\n            category: template.category,\r\n            recurrence: template.recurrence,\r\n        });\r\n        setDate(targetDate);\r\n        toast.success(`Applied template: ${template.name}`);\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!profile || !date) return;\r\n\r\n        setLoading(true);\r\n        try {\r\n            // üõ°Ô∏è SECURITY: SaaS-Standard Validation (Zod)\r\n            const validation = taskSchema.safeParse({\r\n                name: formData.name.trim(),\r\n                category: formData.category,\r\n                deadline: date,\r\n                description: formData.description.trim() || undefined,\r\n                client_name: formData.client_name.trim() || undefined,\r\n                client_phone: formData.client_phone.trim() || undefined,\r\n                client_email: formData.client_email.trim() || undefined,\r\n                recurrence: formData.recurrence === \"none\" ? \"one-time\" : formData.recurrence,\r\n            });\r\n\r\n            if (!validation.success) {\r\n                toast.error(validation.error.errors[0].message);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            const taskData = validation.data;\r\n\r\n            const { error } = await supabase.from(\"tasks\").insert({\r\n                user_id: profile.id,\r\n                organization_id: profile.organization_id, // üõ°Ô∏è Multi-tenancy enforcement\r\n                name: taskData.name,\r\n                category: taskData.category,\r\n                description: taskData.description || null,\r\n                client_name: taskData.client_name || null,\r\n                client_phone: taskData.client_phone || null,\r\n                client_email: (taskData as any).client_email || null,\r\n                recurrence: taskData.recurrence,\r\n                deadline: taskData.deadline.toISOString(),\r\n                completed: false,\r\n            });\r\n\r\n            if (error) throw error;\r\n\r\n            toast.success(\"Task created successfully\");\r\n            onTaskCreated();\r\n            onOpenChange(false);\r\n            // Reset form\r\n            setFormData({ name: \"\", category: \"General\", description: \"\", recurrence: \"none\", client_name: \"\", client_phone: \"\", client_email: \"\", amount: \"\" });\r\n            setDate(new Date());\r\n        } catch (error: any) {\r\n            console.error(\"Error creating task:\", error);\r\n            toast.error(error.message || \"Failed to create task\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Dialog open={open} onOpenChange={onOpenChange}>\r\n            <DialogContent className=\"sm:max-w-[500px]\">\r\n                <DialogHeader>\r\n                    <DialogTitle>Create New Task</DialogTitle>\r\n                    <DialogDescription>\r\n                        Add a new compliance task. Click \"Quick Templates\" for common filings.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"flex gap-2 mb-4 overflow-x-auto pb-2\">\r\n                    <span className=\"text-xs text-muted-foreground self-center mr-1\">Quick Templates:</span>\r\n                    {templates.map(t => (\r\n                        <Badge\r\n                            key={t.name}\r\n                            variant=\"outline\"\r\n                            className=\"cursor-pointer hover:bg-primary/10 transition-colors flex items-center gap-1\"\r\n                            onClick={() => applyTemplate(t)}\r\n                        >\r\n                            <Sparkles className=\"w-3 h-3 text-primary\" /> {t.name}\r\n                        </Badge>\r\n                    ))}\r\n                </div>\r\n\r\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"name\">Task Name</Label>\r\n                        <Input\r\n                            id=\"name\"\r\n                            placeholder=\"e.g. GSTR-1 Filing\"\r\n                            value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value.substring(0, 100) })}\r\n                            required\r\n                            maxLength={100}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"category\">Category</Label>\r\n                            <Select\r\n                                value={formData.category}\r\n                                onValueChange={(value) => setFormData({ ...formData, category: value })}\r\n                            >\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Select category\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"General\">General</SelectItem>\r\n                                    <SelectItem value=\"GST\">GST</SelectItem>\r\n                                    <SelectItem value=\"Income Tax\">Income Tax</SelectItem>\r\n                                    <SelectItem value=\"Insurance\">Insurance</SelectItem>\r\n                                    <SelectItem value=\"Transport\">Transport</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n\r\n                        <div className=\"grid gap-2\">\r\n                            <Label>Due Date</Label>\r\n                            <Popover>\r\n                                <PopoverTrigger asChild>\r\n                                    <Button\r\n                                        variant={\"outline\"}\r\n                                        className={cn(\r\n                                            \"w-full justify-start text-left font-normal\",\r\n                                            !date && \"text-muted-foreground\"\r\n                                        )}\r\n                                    >\r\n                                        <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                                        {date ? format(date, \"PPP\") : <span>Pick a date</span>}\r\n                                    </Button>\r\n                                </PopoverTrigger>\r\n                                <PopoverContent className=\"w-auto p-0\">\r\n                                    <Calendar\r\n                                        mode=\"single\"\r\n                                        selected={date}\r\n                                        onSelect={setDate}\r\n                                        initialFocus\r\n                                    />\r\n                                </PopoverContent>\r\n                            </Popover>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"recurrence\">Recurrence</Label>\r\n                            <Select\r\n                                value={formData.recurrence}\r\n                                onValueChange={(value) => setFormData({ ...formData, recurrence: value })}\r\n                            >\r\n                                <SelectTrigger>\r\n                                    <SelectValue placeholder=\"Frequency\" />\r\n                                </SelectTrigger>\r\n                                <SelectContent>\r\n                                    <SelectItem value=\"none\">One-time</SelectItem>\r\n                                    <SelectItem value=\"monthly\">Monthly</SelectItem>\r\n                                    <SelectItem value=\"quarterly\">Quarterly</SelectItem>\r\n                                    <SelectItem value=\"yearly\">Yearly</SelectItem>\r\n                                </SelectContent>\r\n                            </Select>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"client_name\">Client Name</Label>\r\n                            <Input\r\n                                id=\"client_name\"\r\n                                placeholder=\"e.g. Rahul Sharma\"\r\n                                value={formData.client_name}\r\n                                onChange={(e) => setFormData({ ...formData, client_name: e.target.value.substring(0, 100) })}\r\n                                maxLength={100}\r\n                            />\r\n                        </div>\r\n                        <div className=\"grid gap-2\">\r\n                            <Label htmlFor=\"client_phone\">Client Phone</Label>\r\n                            <Input\r\n                                id=\"client_phone\"\r\n                                placeholder=\"10-digit mobile\"\r\n                                value={formData.client_phone}\r\n                                onChange={(e) => setFormData({ ...formData, client_phone: e.target.value.substring(0, 15) })}\r\n                                maxLength={15}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"client_email\">Client Email</Label>\r\n                        <Input\r\n                            id=\"client_email\"\r\n                            type=\"email\"\r\n                            placeholder=\"client@example.com\"\r\n                            value={formData.client_email}\r\n                            onChange={(e) => setFormData({ ...formData, client_email: e.target.value.substring(0, 100) })}\r\n                            maxLength={100}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"grid gap-2\">\r\n                        <Label htmlFor=\"description\">Description (Optional)</Label>\r\n                        <Textarea\r\n                            id=\"description\"\r\n                            placeholder=\"Add details...\"\r\n                            value={formData.description}\r\n                            onChange={(e) => setFormData({ ...formData, description: e.target.value.substring(0, 500) })}\r\n                            maxLength={500}\r\n                        />\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button type=\"button\" variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n                            Cancel\r\n                        </Button>\r\n                        <Button type=\"submit\" disabled={loading}>\r\n                            {loading ? (\r\n                                <>\r\n                                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" /> Creating...\r\n                                </>\r\n                            ) : (\r\n                                \"Create Task\"\r\n                            )}\r\n                        </Button>\r\n                    </DialogFooter>\r\n                </form>\r\n            </DialogContent>\r\n        </Dialog>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\StatCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\TaskCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\dashboard\\TasksTabContent.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTasks'. Either include it or remove the dependency array.","line":33,"column":8,"nodeType":"ArrayExpression","endLine":33,"endColumn":60,"suggestions":[{"desc":"Update the dependencies array to be: [searchQuery, categoryFilter, statusFilter, profile, fetchTasks]","fix":{"range":[1145,1197],"text":"[searchQuery, categoryFilter, statusFilter, profile, fetchTasks]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { TaskCard } from \"@/components/dashboard/TaskCard\";\r\nimport { Search, Filter, X, Loader2 } from \"lucide-react\";\r\nimport type { Database } from \"@/integrations/supabase/types\";\r\nimport { toast } from \"sonner\";\r\n\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\n\r\ntype Task = Database[\"public\"][\"Tables\"][\"tasks\"][\"Row\"];\r\n\r\nexport function TasksTabContent() {\r\n    const { profile } = useAuth();\r\n    const [tasks, setTasks] = useState<Task[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [searchQuery, setSearchQuery] = useState(\"\");\r\n    const [categoryFilter, setCategoryFilter] = useState(\"all\");\r\n    const [statusFilter, setStatusFilter] = useState(\"pending\"); // default to pending\r\n\r\n    useEffect(() => {\r\n        if (profile) {\r\n            fetchTasks();\r\n        }\r\n    }, [searchQuery, categoryFilter, statusFilter, profile]);\r\n\r\n    const fetchTasks = async () => {\r\n        if (!profile) return;\r\n        setLoading(true);\r\n        try {\r\n            let query = supabase\r\n                .from(\"tasks\")\r\n                .select(\"*\")\r\n                .eq(\"organization_id\", profile.organization_id) // üõ°Ô∏è Org isolation\r\n                .order(\"deadline\", { ascending: true });\r\n\r\n            // Apply Search\r\n            if (searchQuery) {\r\n                query = query.ilike(\"name\", `%${searchQuery}%`);\r\n            }\r\n\r\n            // Apply Category Filter\r\n            if (categoryFilter !== \"all\") {\r\n                query = query.eq(\"category\", categoryFilter);\r\n            }\r\n\r\n            // Apply Status Filter\r\n            if (statusFilter === \"pending\") {\r\n                query = query.eq(\"completed\", false);\r\n            } else if (statusFilter === \"completed\") {\r\n                query = query.eq(\"completed\", true);\r\n            }\r\n\r\n            const { data, error } = await query;\r\n\r\n            if (error) throw error;\r\n            setTasks(data || []);\r\n        } catch (error) {\r\n            console.error(\"Error fetching filtered tasks:\", error);\r\n            toast.error(\"Failed to fetch tasks\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const clearFilters = () => {\r\n        setSearchQuery(\"\");\r\n        setCategoryFilter(\"all\");\r\n        setStatusFilter(\"pending\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Filters Bar */}\r\n            <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center bg-card p-4 rounded-lg border shadow-sm\">\r\n                <div className=\"relative flex-1 w-full\">\r\n                    <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\r\n                    <Input\r\n                        placeholder=\"Search tasks...\"\r\n                        value={searchQuery}\r\n                        onChange={(e) => setSearchQuery(e.target.value)}\r\n                        className=\"pl-9\"\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"flex flex-wrap gap-2 w-full md:w-auto\">\r\n                    <Select value={categoryFilter} onValueChange={setCategoryFilter}>\r\n                        <SelectTrigger className=\"w-[160px]\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <Filter className=\"h-4 w-4 text-muted-foreground\" />\r\n                                <SelectValue placeholder=\"Category\" />\r\n                            </div>\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                            <SelectItem value=\"all\">All Categories</SelectItem>\r\n                            <SelectItem value=\"GST\">GST</SelectItem>\r\n                            <SelectItem value=\"Income Tax\">Income Tax</SelectItem>\r\n                            <SelectItem value=\"Insurance\">Insurance</SelectItem>\r\n                            <SelectItem value=\"Transport\">Transport</SelectItem>\r\n                            <SelectItem value=\"General\">General</SelectItem>\r\n                        </SelectContent>\r\n                    </Select>\r\n\r\n                    <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                        <SelectTrigger className=\"w-[160px]\">\r\n                            <SelectValue placeholder=\"Status\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                            <SelectItem value=\"all\">All Status</SelectItem>\r\n                            <SelectItem value=\"pending\">Pending</SelectItem>\r\n                            <SelectItem value=\"completed\">Completed</SelectItem>\r\n                        </SelectContent>\r\n                    </Select>\r\n\r\n                    <Button variant=\"ghost\" size=\"icon\" onClick={clearFilters} title=\"Clear Filters\">\r\n                        <X className=\"h-4 w-4\" />\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Loading State */}\r\n            {loading ? (\r\n                <div className=\"flex justify-center items-center py-12\">\r\n                    <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n                </div>\r\n            ) : (\r\n                <>\r\n                    {/* Results Info */}\r\n                    <div className=\"flex justify-between items-center text-sm text-muted-foreground px-1\">\r\n                        <span>Found {tasks.length} tasks</span>\r\n                    </div>\r\n\r\n                    {/* Task Grid */}\r\n                    <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                        {tasks.map((task) => (\r\n                            <TaskCard\r\n                                key={task.id}\r\n                                task={task}\r\n                                onComplete={() => toast.info(\"Task completion managed by user\")}\r\n                            />\r\n                        ))}\r\n                        {tasks.length === 0 && (\r\n                            <div className=\"col-span-full py-20 text-center border-2 border-dashed border-slate-100 rounded-xl text-slate-400 bg-slate-50/50\">\r\n                                <p className=\"text-lg font-medium\">No tasks found matching your filters.</p>\r\n                                <Button variant=\"link\" onClick={clearFilters} className=\"text-primary mt-2\">Clear filters</Button>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\settings\\GoogleCalendarSettings.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadConnectionStatus'. Either include it or remove the dependency array.","line":42,"column":8,"nodeType":"ArrayExpression","endLine":42,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [loadConnectionStatus, user?.id]","fix":{"range":[1854,1864],"text":"[loadConnectionStatus, user?.id]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Google Calendar Settings Component\r\nimport { useState, useEffect } from \"react\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Calendar, CheckCircle2, AlertCircle, Loader2, Unlink } from \"lucide-react\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n    checkGoogleConnection,\r\n    initiateGoogleAuth,\r\n    disconnectGoogle,\r\n    updateSyncSettings,\r\n} from \"@/utils/googleCalendarService\";\r\n\r\nexport function GoogleCalendarSettings() {\r\n    const { user } = useAuth();\r\n    const [loading, setLoading] = useState(true);\r\n    const [connecting, setConnecting] = useState(false);\r\n    const [connected, setConnected] = useState(false);\r\n    const [syncEnabled, setSyncEnabled] = useState(false);\r\n    const [reminderDays, setReminderDays] = useState<number[]>([1]);\r\n\r\n    useEffect(() => {\r\n        if (user?.id) {\r\n            loadConnectionStatus();\r\n\r\n            // Check for OAuth callback result\r\n            const params = new URLSearchParams(window.location.search);\r\n            if (params.get(\"google_success\") === \"true\") {\r\n                toast.success(\"Google Calendar connected successfully!\");\r\n                window.history.replaceState({}, \"\", window.location.pathname);\r\n                loadConnectionStatus();\r\n            } else if (params.get(\"google_error\")) {\r\n                toast.error(`Failed to connect Google Calendar: ${params.get(\"google_error\")}`);\r\n                window.history.replaceState({}, \"\", window.location.pathname);\r\n            }\r\n        }\r\n    }, [user?.id]);\r\n\r\n    const loadConnectionStatus = async () => {\r\n        if (!user?.id) return;\r\n\r\n        setLoading(true);\r\n        try {\r\n            const status = await checkGoogleConnection(user.id);\r\n            setConnected(status.connected);\r\n            setSyncEnabled(status.syncEnabled);\r\n            setReminderDays(status.reminderDays);\r\n        } catch (error) {\r\n            console.error(\"Error loading Google connection status:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleConnect = async () => {\r\n        if (!user?.id) return;\r\n\r\n        setConnecting(true);\r\n        try {\r\n            await initiateGoogleAuth(user.id);\r\n        } catch (error) {\r\n            toast.error(\"Failed to start Google Calendar connection\");\r\n            setConnecting(false);\r\n        }\r\n    };\r\n\r\n    const handleDisconnect = async () => {\r\n        if (!user?.id) return;\r\n\r\n        const success = await disconnectGoogle(user.id);\r\n        if (success) {\r\n            setConnected(false);\r\n            setSyncEnabled(false);\r\n            toast.success(\"Google Calendar disconnected\");\r\n        } else {\r\n            toast.error(\"Failed to disconnect Google Calendar\");\r\n        }\r\n    };\r\n\r\n    const handleSyncToggle = async (enabled: boolean) => {\r\n        if (!user?.id) return;\r\n\r\n        setSyncEnabled(enabled);\r\n        const success = await updateSyncSettings(user.id, enabled, reminderDays);\r\n        if (success) {\r\n            toast.success(enabled ? \"Calendar sync enabled\" : \"Calendar sync disabled\");\r\n        } else {\r\n            setSyncEnabled(!enabled);\r\n            toast.error(\"Failed to update sync settings\");\r\n        }\r\n    };\r\n\r\n    const handleReminderChange = async (day: number, checked: boolean) => {\r\n        if (!user?.id) return;\r\n\r\n        const newDays = checked\r\n            ? [...reminderDays, day].sort((a, b) => b - a)\r\n            : reminderDays.filter((d) => d !== day);\r\n\r\n        setReminderDays(newDays);\r\n        const success = await updateSyncSettings(user.id, syncEnabled, newDays);\r\n        if (!success) {\r\n            setReminderDays(reminderDays);\r\n            toast.error(\"Failed to update reminder settings\");\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <Card>\r\n                <CardContent className=\"flex items-center justify-center py-8\">\r\n                    <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\r\n                </CardContent>\r\n            </Card>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Card>\r\n            <CardHeader>\r\n                <div className=\"flex items-center gap-3\">\r\n                    <div className=\"p-2 rounded-lg bg-blue-100\">\r\n                        <Calendar className=\"h-5 w-5 text-blue-600\" />\r\n                    </div>\r\n                    <div>\r\n                        <CardTitle className=\"text-lg\">Google Calendar</CardTitle>\r\n                        <CardDescription>\r\n                            Sync your compliance tasks to Google Calendar\r\n                        </CardDescription>\r\n                    </div>\r\n                    <div className=\"ml-auto\">\r\n                        {connected ? (\r\n                            <Badge variant=\"outline\" className=\"bg-green-50 text-green-700 border-green-200\">\r\n                                <CheckCircle2 className=\"h-3 w-3 mr-1\" /> Connected\r\n                            </Badge>\r\n                        ) : (\r\n                            <Badge variant=\"outline\" className=\"bg-slate-50 text-slate-500 border-slate-200\">\r\n                                Not Connected\r\n                            </Badge>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-6\">\r\n                {!connected ? (\r\n                    // Connection CTA\r\n                    <div className=\"flex flex-col items-center gap-4 py-4\">\r\n                        <p className=\"text-sm text-muted-foreground text-center max-w-sm\">\r\n                            Connect your Google Calendar to automatically create calendar events\r\n                            for your tasks with reminders before deadlines.\r\n                        </p>\r\n                        <Button onClick={handleConnect} disabled={connecting} className=\"gap-2\">\r\n                            {connecting ? (\r\n                                <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                            ) : (\r\n                                <Calendar className=\"h-4 w-4\" />\r\n                            )}\r\n                            Connect Google Calendar\r\n                        </Button>\r\n                    </div>\r\n                ) : (\r\n                    // Connected settings\r\n                    <>\r\n                        {/* Sync Toggle */}\r\n                        <div className=\"flex items-center justify-between\">\r\n                            <div className=\"space-y-0.5\">\r\n                                <Label htmlFor=\"sync-toggle\" className=\"text-sm font-medium\">\r\n                                    Sync Tasks to Calendar\r\n                                </Label>\r\n                                <p className=\"text-xs text-muted-foreground\">\r\n                                    Automatically create calendar events for new tasks\r\n                                </p>\r\n                            </div>\r\n                            <Switch\r\n                                id=\"sync-toggle\"\r\n                                checked={syncEnabled}\r\n                                onCheckedChange={handleSyncToggle}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Reminder Settings */}\r\n                        {syncEnabled && (\r\n                            <div className=\"space-y-3 pt-2 border-t\">\r\n                                <Label className=\"text-sm font-medium\">Reminder Timing</Label>\r\n                                <div className=\"flex flex-wrap gap-4\">\r\n                                    {[\r\n                                        { day: 0, label: \"Same day\" },\r\n                                        { day: 1, label: \"1 day before\" },\r\n                                        { day: 3, label: \"3 days before\" },\r\n                                        { day: 7, label: \"1 week before\" },\r\n                                    ].map(({ day, label }) => (\r\n                                        <div key={day} className=\"flex items-center space-x-2\">\r\n                                            <Checkbox\r\n                                                id={`reminder-${day}`}\r\n                                                checked={reminderDays.includes(day)}\r\n                                                onCheckedChange={(checked) => handleReminderChange(day, !!checked)}\r\n                                            />\r\n                                            <label\r\n                                                htmlFor={`reminder-${day}`}\r\n                                                className=\"text-sm cursor-pointer\"\r\n                                            >\r\n                                                {label}\r\n                                            </label>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Disconnect Button */}\r\n                        <div className=\"pt-4 border-t\">\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={handleDisconnect}\r\n                                className=\"text-destructive hover:text-destructive hover:bg-destructive/10 gap-2\"\r\n                            >\r\n                                <Unlink className=\"h-4 w-4\" />\r\n                                Disconnect Google Calendar\r\n                            </Button>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":29,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":29,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default: \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive: \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n);\n\nexport interface BadgeProps extends React.HTMLAttributes<HTMLDivElement>, VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return <div className={cn(badgeVariants({ variant }), className)} {...props} />;\n}\n\nexport { Badge, badgeVariants };\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":47,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":47,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive: \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline: \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n);\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n    return <Comp className={cn(buttonVariants({ variant, size, className }))} ref={ref} {...props} />;\n  },\n);\nButton.displayName = \"Button\";\n\nexport { Button, buttonVariants };\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\carousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\command.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":24,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":24,"endColumn":29,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[710,761],"text":"type CommandDialogProps = DialogProps"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { type DialogProps } from \"@radix-ui/react-dialog\";\nimport { Command as CommandPrimitive } from \"cmdk\";\nimport { Search } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\";\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className,\n    )}\n    {...props}\n  />\n));\nCommand.displayName = CommandPrimitive.displayName;\n\ninterface CommandDialogProps extends DialogProps {}\n\nconst CommandDialog = ({ children, ...props }: CommandDialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className,\n      )}\n      {...props}\n    />\n  </div>\n));\n\nCommandInput.displayName = CommandPrimitive.Input.displayName;\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n));\n\nCommandList.displayName = CommandPrimitive.List.displayName;\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => <CommandPrimitive.Empty ref={ref} className=\"py-6 text-center text-sm\" {...props} />);\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName;\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className,\n    )}\n    {...props}\n  />\n));\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName;\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator ref={ref} className={cn(\"-mx-1 h-px bg-border\", className)} {...props} />\n));\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName;\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50\",\n      className,\n    )}\n    {...props}\n  />\n));\n\nCommandItem.displayName = CommandPrimitive.Item.displayName;\n\nconst CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {\n  return <span className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)} {...props} />;\n};\nCommandShortcut.displayName = \"CommandShortcut\";\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n};\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\form.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":129,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":129,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { Controller, ControllerProps, FieldPath, FieldValues, FormProvider, useFormContext } from \"react-hook-form\";\n\nimport { cn } from \"@/lib/utils\";\nimport { Label } from \"@/components/ui/label\";\n\nconst Form = FormProvider;\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n> = {\n  name: TName;\n};\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>({} as FormFieldContextValue);\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  );\n};\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext);\n  const itemContext = React.useContext(FormItemContext);\n  const { getFieldState, formState } = useFormContext();\n\n  const fieldState = getFieldState(fieldContext.name, formState);\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\");\n  }\n\n  const { id } = itemContext;\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  };\n};\n\ntype FormItemContextValue = {\n  id: string;\n};\n\nconst FormItemContext = React.createContext<FormItemContextValue>({} as FormItemContextValue);\n\nconst FormItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => {\n    const id = React.useId();\n\n    return (\n      <FormItemContext.Provider value={{ id }}>\n        <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n      </FormItemContext.Provider>\n    );\n  },\n);\nFormItem.displayName = \"FormItem\";\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField();\n\n  return <Label ref={ref} className={cn(error && \"text-destructive\", className)} htmlFor={formItemId} {...props} />;\n});\nFormLabel.displayName = \"FormLabel\";\n\nconst FormControl = React.forwardRef<React.ElementRef<typeof Slot>, React.ComponentPropsWithoutRef<typeof Slot>>(\n  ({ ...props }, ref) => {\n    const { error, formItemId, formDescriptionId, formMessageId } = useFormField();\n\n    return (\n      <Slot\n        ref={ref}\n        id={formItemId}\n        aria-describedby={!error ? `${formDescriptionId}` : `${formDescriptionId} ${formMessageId}`}\n        aria-invalid={!!error}\n        {...props}\n      />\n    );\n  },\n);\nFormControl.displayName = \"FormControl\";\n\nconst FormDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(\n  ({ className, ...props }, ref) => {\n    const { formDescriptionId } = useFormField();\n\n    return <p ref={ref} id={formDescriptionId} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />;\n  },\n);\nFormDescription.displayName = \"FormDescription\";\n\nconst FormMessage = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(\n  ({ className, children, ...props }, ref) => {\n    const { error, formMessageId } = useFormField();\n    const body = error ? String(error?.message) : children;\n\n    if (!body) {\n      return null;\n    }\n\n    return (\n      <p ref={ref} id={formMessageId} className={cn(\"text-sm font-medium text-destructive\", className)} {...props}>\n        {body}\n      </p>\n    );\n  },\n);\nFormMessage.displayName = \"FormMessage\";\n\nexport { useFormField, Form, FormItem, FormLabel, FormControl, FormDescription, FormMessage, FormField };\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\navigation-menu.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":111,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":111,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\";\nimport { cva } from \"class-variance-authority\";\nimport { ChevronDown } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\"relative z-10 flex max-w-max flex-1 items-center justify-center\", className)}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n));\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\"group flex flex-1 list-none items-center justify-center space-x-1\", className)}\n    {...props}\n  />\n));\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item;\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\",\n);\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n));\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto\",\n      className,\n    )}\n    {...props}\n  />\n));\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link;\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className,\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n));\nNavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className,\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n));\nNavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n};\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\sidebar.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":636,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":636,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { VariantProps, cva } from \"class-variance-authority\";\nimport { PanelLeft } from \"lucide-react\";\n\nimport { useIsMobile } from \"@/hooks/use-mobile\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar:state\";\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;\nconst SIDEBAR_WIDTH = \"16rem\";\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\";\nconst SIDEBAR_WIDTH_ICON = \"3rem\";\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\";\n\ntype SidebarContext = {\n  state: \"expanded\" | \"collapsed\";\n  open: boolean;\n  setOpen: (open: boolean) => void;\n  openMobile: boolean;\n  setOpenMobile: (open: boolean) => void;\n  isMobile: boolean;\n  toggleSidebar: () => void;\n};\n\nconst SidebarContext = React.createContext<SidebarContext | null>(null);\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext);\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\");\n  }\n\n  return context;\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean;\n    open?: boolean;\n    onOpenChange?: (open: boolean) => void;\n  }\n>(({ defaultOpen = true, open: openProp, onOpenChange: setOpenProp, className, style, children, ...props }, ref) => {\n  const isMobile = useIsMobile();\n  const [openMobile, setOpenMobile] = React.useState(false);\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen);\n  const open = openProp ?? _open;\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value;\n      if (setOpenProp) {\n        setOpenProp(openState);\n      } else {\n        _setOpen(openState);\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;\n    },\n    [setOpenProp, open],\n  );\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);\n  }, [isMobile, setOpen, setOpenMobile]);\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {\n        event.preventDefault();\n        toggleSidebar();\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [toggleSidebar]);\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\";\n\n  const contextValue = React.useMemo<SidebarContext>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],\n  );\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\", className)}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  );\n});\nSidebarProvider.displayName = \"SidebarProvider\";\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\";\n    variant?: \"sidebar\" | \"floating\" | \"inset\";\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\";\n  }\n>(({ side = \"left\", variant = \"sidebar\", collapsible = \"offcanvas\", className, children, ...props }, ref) => {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        className={cn(\"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\", className)}\n        ref={ref}\n        {...props}\n      >\n        {children}\n      </div>\n    );\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    );\n  }\n\n  return (\n    <div\n      ref={ref}\n      className=\"group peer hidden text-sidebar-foreground md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        className={cn(\n          \"relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\",\n        )}\n      />\n      <div\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className,\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n});\nSidebar.displayName = \"Sidebar\";\n\nconst SidebarTrigger = React.forwardRef<React.ElementRef<typeof Button>, React.ComponentProps<typeof Button>>(\n  ({ className, onClick, ...props }, ref) => {\n    const { toggleSidebar } = useSidebar();\n\n    return (\n      <Button\n        ref={ref}\n        data-sidebar=\"trigger\"\n        variant=\"ghost\"\n        size=\"icon\"\n        className={cn(\"h-7 w-7\", className)}\n        onClick={(event) => {\n          onClick?.(event);\n          toggleSidebar();\n        }}\n        {...props}\n      >\n        <PanelLeft />\n        <span className=\"sr-only\">Toggle Sidebar</span>\n      </Button>\n    );\n  },\n);\nSidebarTrigger.displayName = \"SidebarTrigger\";\n\nconst SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<\"button\">>(\n  ({ className, ...props }, ref) => {\n    const { toggleSidebar } = useSidebar();\n\n    return (\n      <button\n        ref={ref}\n        data-sidebar=\"rail\"\n        aria-label=\"Toggle Sidebar\"\n        tabIndex={-1}\n        onClick={toggleSidebar}\n        title=\"Toggle Sidebar\"\n        className={cn(\n          \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 hover:after:bg-sidebar-border sm:flex\",\n          \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n          \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n          \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n          \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n          \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarRail.displayName = \"SidebarRail\";\n\nconst SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<\"main\">>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarInset.displayName = \"SidebarInset\";\n\nconst SidebarInput = React.forwardRef<React.ElementRef<typeof Input>, React.ComponentProps<typeof Input>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <Input\n        ref={ref}\n        data-sidebar=\"input\"\n        className={cn(\n          \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarInput.displayName = \"SidebarInput\";\n\nconst SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return <div ref={ref} data-sidebar=\"header\" className={cn(\"flex flex-col gap-2 p-2\", className)} {...props} />;\n});\nSidebarHeader.displayName = \"SidebarHeader\";\n\nconst SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return <div ref={ref} data-sidebar=\"footer\" className={cn(\"flex flex-col gap-2 p-2\", className)} {...props} />;\n});\nSidebarFooter.displayName = \"SidebarFooter\";\n\nconst SidebarSeparator = React.forwardRef<React.ElementRef<typeof Separator>, React.ComponentProps<typeof Separator>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <Separator\n        ref={ref}\n        data-sidebar=\"separator\"\n        className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n        {...props}\n      />\n    );\n  },\n);\nSidebarSeparator.displayName = \"SidebarSeparator\";\n\nconst SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarContent.displayName = \"SidebarContent\";\n\nconst SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  );\n});\nSidebarGroup.displayName = \"SidebarGroup\";\n\nconst SidebarGroupLabel = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\"> & { asChild?: boolean }>(\n  ({ className, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"div\";\n\n    return (\n      <Comp\n        ref={ref}\n        data-sidebar=\"group-label\"\n        className={cn(\n          \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n          \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\";\n\nconst SidebarGroupAction = React.forwardRef<HTMLButtonElement, React.ComponentProps<\"button\"> & { asChild?: boolean }>(\n  ({ className, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n\n    return (\n      <Comp\n        ref={ref}\n        data-sidebar=\"group-action\"\n        className={cn(\n          \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n          // Increases the hit area of the button on mobile.\n          \"after:absolute after:-inset-2 after:md:hidden\",\n          \"group-data-[collapsible=icon]:hidden\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarGroupAction.displayName = \"SidebarGroupAction\";\n\nconst SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(\n  ({ className, ...props }, ref) => (\n    <div ref={ref} data-sidebar=\"group-content\" className={cn(\"w-full text-sm\", className)} {...props} />\n  ),\n);\nSidebarGroupContent.displayName = \"SidebarGroupContent\";\n\nconst SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<\"ul\">>(({ className, ...props }, ref) => (\n  <ul ref={ref} data-sidebar=\"menu\" className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)} {...props} />\n));\nSidebarMenu.displayName = \"SidebarMenu\";\n\nconst SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<\"li\">>(({ className, ...props }, ref) => (\n  <li ref={ref} data-sidebar=\"menu-item\" className={cn(\"group/menu-item relative\", className)} {...props} />\n));\nSidebarMenuItem.displayName = \"SidebarMenuItem\";\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n);\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean;\n    isActive?: boolean;\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>;\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(({ asChild = false, isActive = false, variant = \"default\", size = \"default\", tooltip, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\";\n  const { isMobile, state } = useSidebar();\n\n  const button = (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  );\n\n  if (!tooltip) {\n    return button;\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    };\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent side=\"right\" align=\"center\" hidden={state !== \"collapsed\" || isMobile} {...tooltip} />\n    </Tooltip>\n  );\n});\nSidebarMenuButton.displayName = \"SidebarMenuButton\";\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean;\n    showOnHover?: boolean;\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\";\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform peer-hover/menu-button:text-sidebar-accent-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarMenuAction.displayName = \"SidebarMenuAction\";\n\nconst SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\";\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean;\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`;\n  }, []);\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && <Skeleton className=\"size-4 rounded-md\" data-sidebar=\"menu-skeleton-icon\" />}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  );\n});\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\";\n\nconst SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<\"ul\">>(\n  ({ className, ...props }, ref) => (\n    <ul\n      ref={ref}\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nSidebarMenuSub.displayName = \"SidebarMenuSub\";\n\nconst SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<\"li\">>(({ ...props }, ref) => (\n  <li ref={ref} {...props} />\n));\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\";\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean;\n    size?: \"sm\" | \"md\";\n    isActive?: boolean;\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\";\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring aria-disabled:pointer-events-none aria-disabled:opacity-50 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\";\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n};\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\sonner.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":24,"column":19,"nodeType":"Identifier","messageId":"namedExport","endLine":24,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Toaster as Sonner, toast } from \"sonner\";\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>;\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  return (\n    <Sonner\n      theme=\"light\"\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton: \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton: \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  );\n};\n\nexport { Toaster, toast };\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[75,159],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nexport interface TextareaProps extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className,\n      )}\n      ref={ref}\n      {...props}\n    />\n  );\n});\nTextarea.displayName = \"Textarea\";\n\nexport { Textarea };\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\toggle.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":37,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":37,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline: \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3\",\n        sm: \"h-9 px-2.5\",\n        lg: \"h-11 px-5\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n);\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> & VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root ref={ref} className={cn(toggleVariants({ variant, size, className }))} {...props} />\n));\n\nToggle.displayName = TogglePrimitive.Root.displayName;\n\nexport { Toggle, toggleVariants };\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\components\\ui\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\hooks\\use-mobile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\hooks\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\hooks\\useAuth.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1493,1496],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1493,1496],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport type { User } from \"@supabase/supabase-js\";\r\nimport type { Database } from \"@/integrations/supabase/types\";\r\n\r\ntype Profile = Database[\"public\"][\"Tables\"][\"profiles\"][\"Row\"] & {\r\n  organization_id: string;\r\n};\r\n\r\nexport function useAuth() {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [profile, setProfile] = useState<Profile | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // Get initial session\r\n    supabase.auth.getSession().then(({ data: { session } }) => {\r\n      setUser(session?.user ?? null);\r\n      if (session?.user) {\r\n        fetchProfile(session.user.id);\r\n      } else {\r\n        setLoading(false);\r\n      }\r\n    });\r\n\r\n    // Listen for auth changes\r\n    const {\r\n      data: { subscription },\r\n    } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setUser(session?.user ?? null);\r\n      if (session?.user) {\r\n        fetchProfile(session.user.id);\r\n      } else {\r\n        setProfile(null);\r\n        setLoading(false);\r\n      }\r\n    });\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  const fetchProfile = async (userId: string) => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"*\")\r\n        .eq(\"id\", userId)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      setProfile(data);\r\n    } catch (error: any) {\r\n      console.error(\"CRITICAL: Error fetching profile:\", error);\r\n      // Log more details if available\r\n      if (error.message) console.error(\"Message:\", error.message);\r\n      if (error.details) console.error(\"Details:\", error.details);\r\n      if (error.hint) console.error(\"Hint:\", error.hint);\r\n      setProfile(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const signOut = async () => {\r\n    try {\r\n      // üõ°Ô∏è SECURITY: Global scope invalidates session on Supabase server\r\n      const { error } = await supabase.auth.signOut({ scope: \"global\" });\r\n      if (error) throw error;\r\n    } catch (err) {\r\n      console.warn(\"Supabase signOut failed or already cleared\", err);\r\n    } finally {\r\n      // üî• CLEAR LOCAL STATE\r\n      localStorage.clear();\r\n      sessionStorage.clear();\r\n      window.location.href = \"/auth\"; // Redirect to login\r\n    }\r\n  };\r\n\r\n  const isAdmin = profile?.role === \"admin\";\r\n\r\n  return {\r\n    user,\r\n    profile,\r\n    loading,\r\n    isAdmin,\r\n    signOut,\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\hooks\\useCategories.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\hooks\\useTasks.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTasks'. Either include it or remove the dependency array.","line":23,"column":6,"nodeType":"ArrayExpression","endLine":23,"endColumn":12,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTasks, user]","fix":{"range":[741,747],"text":"[fetchTasks, user]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5532,5535],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5532,5535],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\nimport { ComplianceTask } from \"@/types/task\";\r\nimport { getNextDeadline } from \"@/lib/taskUtils\";\r\nimport { taskSchema } from \"@/lib/validations\";\r\nimport { toast } from \"sonner\";\r\nimport { syncTaskToCalendar } from \"@/utils/googleCalendarService\";\r\n\r\nexport function useTasks() {\r\n  const { user, profile } = useAuth();\r\n  const [tasks, setTasks] = useState<ComplianceTask[]>([]);\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n\r\n  // Load tasks from Supabase on mount\r\n  useEffect(() => {\r\n    if (!user) {\r\n      setIsLoaded(true);\r\n      return;\r\n    }\r\n\r\n    fetchTasks();\r\n  }, [user]);\r\n\r\n  const fetchTasks = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"tasks\")\r\n        .select(\"*\")\r\n        .eq(\"user_id\", user.id)\r\n        .order(\"deadline\", { ascending: true });\r\n\r\n      if (error) throw error;\r\n\r\n      // Convert database tasks to ComplianceTask format\r\n      const formattedTasks: ComplianceTask[] = (data || []).map((task) => ({\r\n        id: task.id,\r\n        name: task.name,\r\n        category: task.category.replace(\"_\", \"-\") as ComplianceTask[\"category\"],\r\n        deadline: new Date(task.deadline),\r\n        recurrence: task.recurrence as ComplianceTask[\"recurrence\"],\r\n        completed: task.completed,\r\n        completedAt: task.completed_at ? new Date(task.completed_at) : undefined,\r\n        client_name: task.client_name || undefined,\r\n        client_phone: task.client_phone || undefined,\r\n        description: task.description || undefined,\r\n      }));\r\n\r\n      setTasks(formattedTasks);\r\n    } catch (error) {\r\n      console.error(\"Error fetching tasks:\", error);\r\n      setTasks([]);\r\n    } finally {\r\n      setIsLoaded(true);\r\n    }\r\n  };\r\n\r\n  const addTask = async (task: Omit<ComplianceTask, \"id\" | \"completed\">) => {\r\n    if (!user) {\r\n      console.error(\"Cannot add task: User not authenticated\");\r\n      throw new Error(\"User not authenticated\");\r\n    }\r\n\r\n    try {\r\n      // üõ°Ô∏è SECURITY: Defense-in-Depth Validation\r\n      const validation = taskSchema.safeParse({\r\n        ...task,\r\n        deadline: task.deadline,\r\n      });\r\n\r\n      if (!validation.success) {\r\n        toast.error(`Validation Error: ${validation.error.errors[0].message}`);\r\n        throw new Error(validation.error.errors[0].message);\r\n      }\r\n\r\n      const validatedTask = validation.data;\r\n      const dbCategory = validatedTask.category.replace(\"-\", \"_\");\r\n\r\n      console.log(\"Adding task to database:\", {\r\n        user_id: user.id,\r\n        name: task.name,\r\n        category: dbCategory,\r\n        deadline: task.deadline.toISOString(),\r\n      });\r\n\r\n      const { data, error } = await supabase\r\n        .from(\"tasks\")\r\n        .insert({\r\n          user_id: user.id,\r\n          organization_id: profile?.organization_id, // üõ°Ô∏è Multi-tenancy enforcement\r\n          name: task.name,\r\n          category: dbCategory,\r\n          deadline: task.deadline.toISOString(),\r\n          recurrence: task.recurrence,\r\n          client_name: task.client_name || null,\r\n          client_phone: task.client_phone || null,\r\n          description: task.description || null,\r\n          completed: false,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (error) {\r\n        console.error(\"Database error adding task:\", error);\r\n        throw error;\r\n      }\r\n\r\n      console.log(\"Task added successfully:\", data);\r\n\r\n      const newTask: ComplianceTask = {\r\n        id: data.id,\r\n        name: data.name,\r\n        category: data.category.replace(\"_\", \"-\") as ComplianceTask[\"category\"],\r\n        deadline: new Date(data.deadline),\r\n        recurrence: data.recurrence as ComplianceTask[\"recurrence\"],\r\n        client_name: data.client_name || undefined,\r\n        client_phone: data.client_phone || undefined,\r\n        completed: data.completed,\r\n        completedAt: data.completed_at ? new Date(data.completed_at) : undefined,\r\n        description: data.description || undefined,\r\n      };\r\n\r\n      setTasks((prev) => [...prev, newTask]);\r\n\r\n      // üìÖ Sync to Google Calendar (fire and forget - don't block UI)\r\n      syncTaskToCalendar({\r\n        id: data.id,\r\n        name: data.name,\r\n        description: data.description || undefined,\r\n        category: data.category,\r\n        client_name: data.client_name || undefined,\r\n        deadline: data.deadline,\r\n        completed: false,\r\n        user_id: user.id,\r\n      }, \"create\")\r\n        .then(result => console.log(\"Calendar sync result:\", result))\r\n        .catch((err) => console.error(\"Calendar sync skipped:\", err));\r\n\r\n      return newTask;\r\n    } catch (error) {\r\n      console.error(\"Error adding task:\", error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n\r\n  const updateTask = async (id: string, updates: Partial<ComplianceTask>) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      // üõ°Ô∏è SECURITY: Partial Validation for updates\r\n      if (updates.name !== undefined || updates.category !== undefined || updates.deadline !== undefined) {\r\n        // We only validate the fields being updated\r\n        const partialSchema = taskSchema.partial();\r\n        const validation = partialSchema.safeParse(updates);\r\n        if (!validation.success) {\r\n          toast.error(`Update Error: ${validation.error.errors[0].message}`);\r\n          throw new Error(validation.error.errors[0].message);\r\n        }\r\n      }\r\n\r\n      const updateData: any = {};\r\n\r\n      if (updates.name !== undefined) updateData.name = updates.name;\r\n      if (updates.category !== undefined) {\r\n        updateData.category = updates.category.replace(\"-\", \"_\");\r\n      }\r\n      if (updates.deadline !== undefined) {\r\n        updateData.deadline = updates.deadline.toISOString();\r\n      }\r\n      if (updates.recurrence !== undefined) {\r\n        updateData.recurrence = updates.recurrence;\r\n      }\r\n      if (updates.description !== undefined) {\r\n        updateData.description = updates.description || null;\r\n      }\r\n      if (updates.client_name !== undefined) {\r\n        updateData.client_name = updates.client_name || null;\r\n      }\r\n      if (updates.client_phone !== undefined) {\r\n        updateData.client_phone = updates.client_phone || null;\r\n      }\r\n      if (updates.completed !== undefined) {\r\n        updateData.completed = updates.completed;\r\n        updateData.completed_at = updates.completed\r\n          ? new Date().toISOString()\r\n          : null;\r\n      }\r\n\r\n      console.log(\"Updating task in database:\", { id, updateData });\r\n\r\n      const { error, count } = await supabase\r\n        .from(\"tasks\")\r\n        .update(updateData, { count: \"exact\" })\r\n        .eq(\"id\", id);\r\n\r\n      // Note: We rely on RLS policies to ensure user can only update their own tasks.\r\n      // We removed .eq(\"user_id\") to avoid potential data mismatches if RLS is sufficient.\r\n\r\n      if (error) {\r\n        console.error(\"Database error updating task:\", error);\r\n        throw error;\r\n      }\r\n\r\n      if (count === 0) {\r\n        throw new Error(\"Task update failed: No rows affected. You may not have permission.\");\r\n      }\r\n\r\n      console.log(\"Task updated successfully\");\r\n\r\n      // Update local state\r\n      setTasks((prev) =>\r\n        prev.map((task) => {\r\n          if (task.id !== id) return task;\r\n\r\n          const updated: ComplianceTask = {\r\n            ...task,\r\n            ...updates,\r\n            completedAt:\r\n              updates.completed === true\r\n                ? new Date()\r\n                : updates.completed === false\r\n                  ? undefined\r\n                  : task.completedAt,\r\n          };\r\n\r\n          return updated;\r\n        })\r\n      );\r\n\r\n      // üìÖ Get the full task data for calendar sync\r\n      const currentTask = tasks.find(t => t.id === id);\r\n      if (currentTask && user) {\r\n        const syncAction = updates.completed ? \"delete\" : \"update\";\r\n        syncTaskToCalendar({\r\n          id,\r\n          name: updates.name || currentTask.name,\r\n          description: updates.description || currentTask.description,\r\n          category: (updates.category || currentTask.category).replace(\"-\", \"_\"),\r\n          client_name: updates.client_name || currentTask.client_name,\r\n          deadline: (updates.deadline || currentTask.deadline).toISOString(),\r\n          completed: updates.completed ?? currentTask.completed,\r\n          user_id: user.id,\r\n        }, syncAction).catch((err) => console.log(\"Calendar sync skipped:\", err));\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error updating task:\", error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const deleteTask = async (id: string) => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const { error, count } = await supabase\r\n        .from(\"tasks\")\r\n        .delete({ count: \"exact\" })\r\n        .eq(\"id\", id);\r\n\r\n      if (error) throw error;\r\n\r\n      if (count === 0) {\r\n        throw new Error(\"Task could not be deleted. It may not exist or you do not have permission.\");\r\n      }\r\n\r\n      setTasks((prev) => prev.filter((task) => task.id !== id));\r\n    } catch (error) {\r\n      console.error(\"Error deleting task:\", error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const completeTask = async (id: string) => {\r\n    if (!user) return;\r\n\r\n    const task = tasks.find((t) => t.id === id);\r\n    if (!task) return;\r\n\r\n    const newCompletedState = !task.completed;\r\n\r\n    try {\r\n      // Update in database\r\n      await updateTask(id, {\r\n        completed: newCompletedState,\r\n        completedAt: newCompletedState ? new Date() : undefined,\r\n      });\r\n\r\n      // If recurring and completing, create next occurrence\r\n      if (\r\n        task.recurrence !== \"one-time\" &&\r\n        !task.completed &&\r\n        newCompletedState\r\n      ) {\r\n        const nextDeadline = getNextDeadline(task.deadline, task.recurrence);\r\n        if (nextDeadline) {\r\n          // Create new task for next occurrence\r\n          await addTask({\r\n            name: task.name,\r\n            category: task.category,\r\n            deadline: nextDeadline,\r\n            recurrence: task.recurrence,\r\n            description: task.description,\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error completing task:\", error);\r\n    }\r\n  };\r\n\r\n  const uncompleteTask = async (id: string) => {\r\n    await updateTask(id, {\r\n      completed: false,\r\n      completedAt: undefined,\r\n    });\r\n  };\r\n\r\n  return {\r\n    tasks,\r\n    isLoaded,\r\n    addTask,\r\n    updateTask,\r\n    deleteTask,\r\n    completeTask,\r\n    uncompleteTask,\r\n    refreshTasks: fetchTasks,\r\n  };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\integrations\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\integrations\\supabase\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\lib\\taskUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\lib\\validations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\pages\\Admin.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchCategories', 'fetchOrgSettings', 'fetchRecentTasks', 'fetchTotalTasks', and 'profile'. Either include them or remove the dependency array.","line":136,"column":6,"nodeType":"ArrayExpression","endLine":136,"endColumn":45,"suggestions":[{"desc":"Update the dependencies array to be: [fetchCategories, fetchOrgSettings, fetchRecentTasks, fetchTotalTasks, profile, profile.id, profile.organization_id]","fix":{"range":[5372,5411],"text":"[fetchCategories, fetchOrgSettings, fetchRecentTasks, fetchTotalTasks, profile, profile.id, profile.organization_id]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":245,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8759,8762],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8759,8762],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":385,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":385,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13098,13101],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13098,13101],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useAuth } from \"@/hooks/useAuth\";\r\nimport { Header } from \"@/components/Header\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  Users, Shield, Mail, Phone, Calendar, Send, ArrowRightLeft,\r\n  FileSpreadsheet, LayoutDashboard, ListTodo, Activity, AlertCircle,\r\n  Clock, Settings, Plus, CheckCircle2, Search, SlidersHorizontal,\r\n  Eye, Trophy\r\n} from \"lucide-react\";\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetDescription,\r\n  SheetHeader,\r\n  SheetTitle,\r\n} from \"@/components/ui/sheet\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { triggerEmailReminders } from \"@/utils/emailService\";\r\nimport { TaskTransferDialog } from \"@/components/TaskTransferDialog\";\r\nimport { fetchUserTasks, downloadTasksCSV } from \"@/utils/taskTransferService\";\r\nimport { toast } from \"sonner\";\r\nimport type { Database } from \"@/integrations/supabase/types\";\r\nimport { StatCard } from \"@/components/dashboard/StatCard\";\r\nimport { TaskCard } from \"@/components/dashboard/TaskCard\";\r\nimport { CalendarView } from \"@/components/dashboard/CalendarView\";\r\nimport { CreateTaskDialog } from \"@/components/dashboard/CreateTaskDialog\";\r\nimport { TasksTabContent } from \"@/components/dashboard/TasksTabContent\";\r\nimport { ClientRemindersTab } from \"@/components/dashboard/ClientRemindersTab\";\r\nimport { AnalyticsCharts } from \"@/components/dashboard/AnalyticsCharts\";\r\nimport { profileSchema } from \"@/lib/validations\";\r\n\r\ntype Profile = Database[\"public\"][\"Tables\"][\"profiles\"][\"Row\"];\r\ntype Task = Database[\"public\"][\"Tables\"][\"tasks\"][\"Row\"];\r\n\r\nexport default function Admin() {\r\n  const { profile } = useAuth();\r\n  const [users, setUsers] = useState<(Profile & { tasks?: Task[] })[]>([]);\r\n  const [recentTasks, setRecentTasks] = useState<Task[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const [deleteUserId, setDeleteUserId] = useState<string | null>(null);\r\n  const [viewTasksUser, setViewTasksUser] = useState<(Profile & { tasks?: Task[] }) | null>(null);\r\n  const [editUser, setEditUser] = useState<Profile | null>(null);\r\n  const [editForm, setEditForm] = useState({\r\n    full_name: \"\",\r\n    email: \"\",\r\n    phone: \"\",\r\n    role: \"user\" as \"admin\" | \"user\",\r\n  });\r\n  const [categories, setCategories] = useState<{ id: string; name: string }[]>([]);\r\n  const [sendingEmails, setSendingEmails] = useState(false);\r\n  const [transferDialogOpen, setTransferDialogOpen] = useState(false);\r\n  const [createTaskOpen, setCreateTaskOpen] = useState(false);\r\n  const [totalTasks, setTotalTasks] = useState(0);\r\n  const [reminderTargetId, setReminderTargetId] = useState<string>(\"all\");\r\n  const [refreshKey, setRefreshKey] = useState(0);\r\n  const [savingAutomation, setSavingAutomation] = useState(false);\r\n  const [testingAutomation, setTestingAutomation] = useState(false);\r\n  const [activeTab, setActiveTab] = useState(\"overview\");\r\n  const [automationEnabled, setAutomationEnabled] = useState(false);\r\n  const [automationTime, setAutomationTime] = useState(\"09:00\");\r\n\r\n  // User Directory filters & sorting\r\n  const [userSearch, setUserSearch] = useState(\"\");\r\n  const [userSortBy, setUserSortBy] = useState<\"name\" | \"pending\" | \"total\">(\"name\");\r\n  const [userFilterRole, setUserFilterRole] = useState<\"all\" | \"admin\" | \"user\">(\"all\");\r\n  const [userFilterStatus, setUserFilterStatus] = useState<\"all\" | \"attention\" | \"progress\" | \"ontrack\" | \"notasks\">(\"all\");\r\n\r\n  const istToUtc = (ist: string) => {\r\n    const [h, m] = ist.split(\":\").map(Number);\r\n    let totalMins = h * 60 + m - 330;\r\n    if (totalMins < 0) totalMins += 1440;\r\n    const rh = Math.floor(totalMins / 60).toString().padStart(2, \"0\");\r\n    const rm = (totalMins % 60).toString().padStart(2, \"0\");\r\n    return `${rh}:${rm}`;\r\n  };\r\n\r\n  const utcToIst = (utc: string) => {\r\n    if (!utc) return \"09:00\";\r\n    const [h, m] = utc.split(\":\").map(Number);\r\n    let totalMins = h * 60 + m + 330;\r\n    if (totalMins >= 1440) totalMins -= 1440;\r\n    const rh = Math.floor(totalMins / 60).toString().padStart(2, \"0\");\r\n    const rm = (totalMins % 60).toString().padStart(2, \"0\");\r\n    return `${rh}:${rm}`;\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!profile) return;\r\n\r\n    fetchUsers();\r\n    fetchTotalTasks();\r\n    fetchRecentTasks();\r\n    fetchCategories();\r\n    fetchOrgSettings();\r\n  }, [profile?.id, profile?.organization_id]);\r\n\r\n  const fetchTotalTasks = async () => {\r\n    if (!profile?.organization_id) return;\r\n    try {\r\n      const { count, error } = await supabase\r\n        .from(\"tasks\")\r\n        .select(\"*\", { count: \"exact\", head: true })\r\n        .eq(\"organization_id\", profile.organization_id); // üõ°Ô∏è Org isolation\r\n\r\n      if (error) throw error;\r\n      setTotalTasks(count || 0);\r\n    } catch (error) {\r\n      console.error(\"Error fetching total tasks:\", error);\r\n    }\r\n  };\r\n\r\n  const fetchRecentTasks = async () => {\r\n    if (!profile?.organization_id) return;\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"tasks\")\r\n        .select(\"*\")\r\n        .eq(\"organization_id\", profile.organization_id) // üõ°Ô∏è Org isolation\r\n        .eq(\"completed\", false)\r\n        .order(\"deadline\", { ascending: true })\r\n        .limit(6);\r\n\r\n      if (error) throw error;\r\n      setRecentTasks(data || []);\r\n    } catch (error) {\r\n      console.error(\"Error fetching recent tasks:\", error);\r\n    }\r\n  };\r\n\r\n  const fetchUsers = async () => {\r\n    try {\r\n      // Fetch profiles first\r\n      const { data: profilesData, error: profilesError } = await supabase\r\n        .from(\"profiles\")\r\n        .select(\"*\")\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (profilesError) throw profilesError;\r\n\r\n      // Fetch all tasks\r\n      const { data: tasksData, error: tasksError } = await supabase\r\n        .from(\"tasks\")\r\n        .select(\"*\");\r\n\r\n      if (tasksError) throw tasksError;\r\n\r\n      // Combine profiles with their tasks\r\n      const usersWithTasks = (profilesData || []).map((profile) => ({\r\n        ...profile,\r\n        tasks: (tasksData || []).filter((task) => task.user_id === profile.id),\r\n      }));\r\n\r\n      setUsers(usersWithTasks);\r\n    } catch (error) {\r\n      console.error(\"Error fetching users:\", error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n\r\n  const fetchOrgSettings = async () => {\r\n    if (!profile?.organization_id) return;\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"organizations\")\r\n        .select(\"is_automation_enabled, reminder_time\")\r\n        .eq(\"id\", profile.organization_id)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      if (data) {\r\n        setAutomationEnabled(data.is_automation_enabled);\r\n        setAutomationTime(utcToIst(data.reminder_time));\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching org settings:\", error);\r\n    }\r\n  };\r\n\r\n  const handleTestAutomation = async () => {\r\n    setTestingAutomation(true);\r\n    try {\r\n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\r\n      const { data: sessionData } = await supabase.auth.getSession();\r\n\r\n      const response = await fetch(`${supabaseUrl}/functions/v1/send-task-reminders`, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"Authorization\": `Bearer ${sessionData.session?.access_token}`,\r\n        },\r\n        body: JSON.stringify({ isAutomatedTrigger: true }),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (!response.ok) {\r\n        console.error(\"Automation error body:\", data);\r\n        throw new Error(data.details || data.error || \"Function call failed\");\r\n      }\r\n\r\n      toast.success(data.message || \"Automation scan completed!\");\r\n    } catch (error: any) {\r\n      toast.error(error.message || \"Failed to run automation scan\");\r\n    } finally {\r\n      setTestingAutomation(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveAutomation = async () => {\r\n    if (!profile?.organization_id) return;\r\n    setSavingAutomation(true);\r\n    try {\r\n      const { error } = await supabase\r\n        .from(\"organizations\")\r\n        .update({\r\n          is_automation_enabled: automationEnabled,\r\n          reminder_time: istToUtc(automationTime),\r\n        })\r\n        .eq(\"id\", profile.organization_id);\r\n\r\n      if (error) throw error;\r\n      toast.success(\"Automation settings saved successfully!\");\r\n    } catch (error) {\r\n      console.error(\"Error saving automation settings:\", error);\r\n      toast.error(\"Failed to save settings\");\r\n    } finally {\r\n      setSavingAutomation(false);\r\n    }\r\n  };\r\n\r\n  const fetchCategories = async () => {\r\n    if (!profile?.organization_id) return;\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from(\"categories\")\r\n        .select(\"*\")\r\n        .eq(\"organization_id\", profile.organization_id)\r\n        .order(\"name\", { ascending: true });\r\n\r\n      if (error) throw error;\r\n      setCategories(data || []);\r\n    } catch (error) {\r\n      console.error(\"Error fetching categories:\", error);\r\n    }\r\n  };\r\n\r\n  const handleDeleteCategory = async (id: string) => {\r\n    if (!profile?.organization_id) return;\r\n    try {\r\n      const { error } = await supabase\r\n        .from(\"categories\")\r\n        .delete()\r\n        .eq(\"id\", id)\r\n        .eq(\"organization_id\", profile.organization_id);\r\n      if (error) throw error;\r\n      setCategories(categories.filter((c) => c.id !== id));\r\n      toast.success(\"Category deleted\");\r\n    } catch (error) {\r\n      console.error(\"Error deleting category:\", error);\r\n      toast.error(\"Failed to delete category. It might be in use.\");\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (!deleteUserId) return;\r\n    try {\r\n      const { error } = await supabase.from(\"profiles\").delete().eq(\"id\", deleteUserId);\r\n      if (error) throw error;\r\n      setUsers(users.filter((u) => u.id !== deleteUserId));\r\n      setDeleteUserId(null);\r\n    } catch (error) {\r\n      console.error(\"Error deleting user:\", error);\r\n      alert(\"Failed to delete user\");\r\n    }\r\n  };\r\n\r\n  const handleEdit = (user: Profile) => {\r\n    setEditUser(user);\r\n    setEditForm({\r\n      full_name: user.full_name || \"\",\r\n      email: user.email,\r\n      phone: user.phone || \"\",\r\n      role: user.role as \"admin\" | \"user\",\r\n    });\r\n  };\r\n\r\n  const handleUpdate = async () => {\r\n    if (!editUser) return;\r\n    try {\r\n      // üõ°Ô∏è SECURITY: SaaS-Standard Validation (Zod)\r\n      const validation = profileSchema.safeParse({\r\n        full_name: editForm.full_name || undefined,\r\n        phone: editForm.phone || undefined,\r\n        role: editForm.role,\r\n      });\r\n\r\n      if (!validation.success) {\r\n        toast.error(validation.error.errors[0].message);\r\n        return;\r\n      }\r\n\r\n      const updateData = validation.data;\r\n\r\n      const { error } = await supabase\r\n        .from(\"profiles\")\r\n        .update(updateData)\r\n        .eq(\"id\", editUser.id);\r\n      if (error) throw error;\r\n      await fetchUsers();\r\n      setEditUser(null);\r\n    } catch (error) {\r\n      console.error(\"Error updating user:\", error);\r\n      alert(\"Failed to update user\");\r\n    }\r\n  };\r\n\r\n  const handleExportTasks = async (user: Profile) => {\r\n    try {\r\n      const tasks = await fetchUserTasks(user.id);\r\n      if (tasks.length === 0) {\r\n        toast.info(`No tasks found for ${user.full_name || user.email}`);\r\n        return;\r\n      }\r\n      downloadTasksCSV(tasks, user.full_name || user.email || \"user\");\r\n      toast.success(\"Tasks exported successfully\");\r\n    } catch (error) {\r\n      console.error(\"Error exporting tasks:\", error);\r\n      toast.error(\"Failed to export tasks\");\r\n    }\r\n  };\r\n\r\n  const handleSendReminders = async () => {\r\n    setSendingEmails(true);\r\n    try {\r\n      const target = reminderTargetId === \"all\" ? undefined : reminderTargetId;\r\n      const result = await triggerEmailReminders(target);\r\n      if (result.success) {\r\n        toast.success(`Sent ${result.sent} email reminders successfully`);\r\n      } else {\r\n        toast.error(result.message || \"Failed to send email reminders\");\r\n      }\r\n    } catch (error: any) {\r\n      toast.error(error.message || \"Failed to send email reminders\");\r\n    } finally {\r\n      setSendingEmails(false);\r\n    }\r\n  };\r\n\r\n  // --- Handlers for TaskCard actions (Mocked for dashboard/admin view)\r\n  const handleTaskAction = (taskId: string) => {\r\n    toast.info(\"Task completion should be done by the user!\");\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"animate-pulse text-muted-foreground\">Loading Compliance Dashboard...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background text-foreground transition-colors duration-300\">\r\n      <Header />\r\n\r\n      <main className=\"container mx-auto px-4 py-8 max-w-7xl\">\r\n        <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold tracking-tight mb-1 flex items-center gap-3\">\r\n              <Shield className=\"h-8 w-8 text-primary\" />\r\n              Compliance Dashboard\r\n            </h1>\r\n            <p className=\"text-muted-foreground\">\r\n              Welcome back, Admin. Here is your compliance overview.\r\n            </p>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <Button variant=\"outline\" onClick={() => {\r\n              fetchRecentTasks();\r\n              fetchTotalTasks();\r\n              fetchUsers();\r\n              setRefreshKey(prev => prev + 1);\r\n              toast.success(\"Dashboard refreshed\");\r\n            }}>\r\n              <Activity className=\"mr-2 h-4 w-4\" /> Refresh Data\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-12\">\r\n          <TabsList className=\"bg-transparent p-0 border-b border-slate-200 w-full justify-start h-auto rounded-none\">\r\n            <TabsTrigger value=\"overview\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">Overview</TabsTrigger>\r\n            <TabsTrigger value=\"calendar\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">Calendar</TabsTrigger>\r\n            <TabsTrigger value=\"tasks\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">Active Tasks</TabsTrigger>\r\n            <TabsTrigger value=\"categories\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">Categories</TabsTrigger>\r\n            <TabsTrigger value=\"users\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">Users</TabsTrigger>\r\n            <TabsTrigger value=\"automation\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">\r\n              <Clock className=\"h-4 w-4 mr-2\" />\r\n              Automation\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"client-reminders\" className=\"data-[state=active]:bg-transparent data-[state=active]:shadow-none data-[state=active]:border-b-2 data-[state=active]:border-primary rounded-none px-6 py-3 font-medium text-slate-500\">\r\n              <Mail className=\"h-4 w-4 mr-2\" />\r\n              Client Reminders\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          {/* OVERVIEW TAB */}\r\n          <TabsContent value=\"overview\" className=\"space-y-6\">\r\n            {/* Stats Row */}\r\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n              <StatCard\r\n                title=\"Total Users\"\r\n                value={users.length}\r\n                icon={Users}\r\n                trend={{ value: \"+2 new\", label: \"this month\", positive: true }}\r\n              />\r\n              <StatCard\r\n                title=\"Total Tasks\"\r\n                value={totalTasks}\r\n                icon={ListTodo}\r\n                trend={{ value: \"+12%\", label: \"growth\", positive: true }}\r\n              />\r\n              <StatCard\r\n                title=\"Pending Actions\"\r\n                value={recentTasks.length}\r\n                icon={AlertCircle}\r\n                description=\"Next 7 days\"\r\n                className=\"border-warning/30\"\r\n              />\r\n              <StatCard\r\n                title=\"Compliance Score\"\r\n                value=\"98%\"\r\n                icon={Activity}\r\n                trend={{ value: \"+1%\", label: \"vs last week\", positive: true }}\r\n              />\r\n            </div>\r\n\r\n            {/* Analytics Section */}\r\n            <AnalyticsCharts key={refreshKey} />\r\n\r\n            {/* Quick Actions Row */}\r\n            <div className=\"grid gap-6 md:grid-cols-2\">\r\n              {/* Email Reminders Card */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg flex items-center gap-2\">\r\n                    <Mail className=\"h-5 w-5 text-primary\" />\r\n                    Broadcast Reminders\r\n                  </CardTitle>\r\n                  <CardDescription>Send notifications for tasks due in 5 days</CardDescription>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <Select value={reminderTargetId} onValueChange={setReminderTargetId}>\r\n                      <SelectTrigger className=\"w-[180px]\">\r\n                        <SelectValue placeholder=\"Target User\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"all\">Check All Users</SelectItem>\r\n                        {users.map((u) => (\r\n                          <SelectItem key={u.id} value={u.id}>\r\n                            {u.full_name || u.email}\r\n                          </SelectItem>\r\n                        ))}\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <Button onClick={handleSendReminders} disabled={sendingEmails} className=\"flex-1 gap-2\">\r\n                      <Send className=\"h-4 w-4\" />\r\n                      {sendingEmails ? \"Sending...\" : \"Trigger Reminders\"}\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Transfers Card */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg flex items-center gap-2\">\r\n                    <ArrowRightLeft className=\"h-5 w-5 text-primary\" />\r\n                    Task Transfer\r\n                  </CardTitle>\r\n                  <CardDescription>Reassign tasks between team members</CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <Button onClick={() => setTransferDialogOpen(true)} variant=\"outline\" className=\"w-full gap-2\">\r\n                    <ArrowRightLeft className=\"h-4 w-4\" /> Open Transfer Tool\r\n                  </Button>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Urgent Tasks Preview */}\r\n            <div className=\"space-y-6\">\r\n              <h2 className=\"text-xl font-medium tracking-tight text-slate-800\">Urgent Attention</h2>\r\n              <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n                {recentTasks.slice(0, 3).map(task => (\r\n                  <TaskCard\r\n                    key={task.id}\r\n                    task={task}\r\n                    onComplete={() => handleTaskAction(task.id)}\r\n                  />\r\n                ))}\r\n                {recentTasks.length === 0 && (\r\n                  <div className=\"col-span-full p-8 text-center border rounded-lg border-dashed text-muted-foreground\">\r\n                    No urgent tasks found. Excellent work!\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </TabsContent>\r\n\r\n          {/* CALENDAR TAB */}\r\n          <TabsContent value=\"calendar\" className=\"space-y-6\">\r\n            <CalendarView key={refreshKey} />\r\n          </TabsContent>\r\n\r\n          {/* TASKS TAB */}\r\n          <TabsContent value=\"tasks\">\r\n            <TasksTabContent key={refreshKey} />\r\n          </TabsContent>\r\n\r\n          {/* CATEGORIES TAB */}\r\n          <TabsContent value=\"categories\">\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Category Management</CardTitle>\r\n                <CardDescription>View and manage task categories. Categories in use cannot be deleted.</CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n                  {categories.map((cat) => (\r\n                    <div key={cat.id} className=\"flex items-center justify-between p-3 border rounded-lg bg-card\">\r\n                      <span className=\"font-medium\">{cat.name}</span>\r\n                      <Button\r\n                        variant=\"ghost\"\r\n                        size=\"sm\"\r\n                        className=\"text-destructive h-8 w-8 p-0\"\r\n                        onClick={() => handleDeleteCategory(cat.id)}\r\n                      >\r\n                        <Plus className=\"h-4 w-4 rotate-45\" />\r\n                      </Button>\r\n                    </div>\r\n                  ))}\r\n                  {categories.length === 0 && (\r\n                    <div className=\"col-span-full py-8 text-center text-muted-foreground border border-dashed rounded-lg\">\r\n                      No categories found.\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          {/* AUTOMATION TAB */}\r\n          <TabsContent value=\"automation\" className=\"space-y-6\">\r\n            <Card>\r\n              <CardHeader>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <Mail className=\"h-5 w-5 text-primary\" />\r\n                      Email Automation Settings\r\n                    </CardTitle>\r\n                    <CardDescription>\r\n                      Configure your daily automatic reminder emails for your organization.\r\n                    </CardDescription>\r\n                  </div>\r\n                  <Badge variant={automationEnabled ? \"default\" : \"outline\"} className=\"capitalize\">\r\n                    {automationEnabled ? \"Active\" : \"Inactive\"}\r\n                  </Badge>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-8\">\r\n                <div className=\"flex flex-col md:flex-row md:items-center justify-between p-6 border rounded-xl bg-slate-50/50 gap-6\">\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-base font-semibold\">Automatic Reminders Status</Label>\r\n                    <p className=\"text-sm text-muted-foreground max-w-md\">\r\n                      When enabled, the system will automatically scan and send reminder emails to all users\r\n                      with pending tasks at your specified time.\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-4 bg-white p-2 rounded-lg border shadow-sm\">\r\n                    <span className={`text-sm font-medium ${automationEnabled ? \"text-primary\" : \"text-slate-400\"}`}>\r\n                      {automationEnabled ? \"Reminders ON\" : \"Reminders OFF\"}\r\n                    </span>\r\n                    <Button\r\n                      variant={automationEnabled ? \"default\" : \"outline\"}\r\n                      size=\"sm\"\r\n                      onClick={() => setAutomationEnabled(!automationEnabled)}\r\n                      className=\"transition-all duration-300\"\r\n                    >\r\n                      {automationEnabled ? \"Disable\" : \"Enable\"}\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid gap-6 max-w-2xl\">\r\n                  <div className=\"grid gap-3\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Clock className=\"h-4 w-4 text-primary\" />\r\n                      <Label htmlFor=\"reminder-time\" className=\"text-sm font-semibold uppercase tracking-wider text-slate-500\">\r\n                        Daily Reminder Time (IST)\r\n                      </Label>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4 border p-4 rounded-lg bg-white shadow-sm\">\r\n                      <Select value={automationTime} onValueChange={setAutomationTime}>\r\n                        <SelectTrigger id=\"reminder-time\" className=\"w-[200px] border-none shadow-none text-lg font-medium focus:ring-0\">\r\n                          <SelectValue placeholder=\"Select time\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          {Array.from({ length: 24 }).map((_, i) => {\r\n                            const hour = i.toString().padStart(2, \"0\");\r\n                            return (\r\n                              <SelectItem key={hour} value={`${hour}:00`}>\r\n                                {hour}:00 IST\r\n                              </SelectItem>\r\n                            );\r\n                          })}\r\n                        </SelectContent>\r\n                      </Select>\r\n                      <div className=\"h-8 w-px bg-slate-200\" />\r\n                      <div className=\"text-sm text-slate-500 flex flex-col items-start gap-1\">\r\n                        <div className=\"flex items-center gap-1 font-medium text-primary\">\r\n                          <Activity className=\"h-4 w-4\" /> Server Time: {new Date().getUTCHours().toString().padStart(2, \"0\")}:00 UTC\r\n                        </div>\r\n                        <span className=\"text-[10px] text-slate-400\">All automation runs in UTC</span>\r\n                      </div>\r\n                    </div>\r\n                    <p className=\"text-sm text-muted-foreground flex items-start gap-2 bg-blue-50/50 p-3 rounded-lg border border-blue-100\">\r\n                      <AlertCircle className=\"h-4 w-4 text-blue-500 mt-0.5\" />\r\n                      Note: Notifications are processed daily at this time. Only tasks due within the configured reminder window will trigger emails.\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"pt-6 border-t flex justify-end\">\r\n                  <Button\r\n                    onClick={handleSaveAutomation}\r\n                    disabled={savingAutomation}\r\n                    className=\"min-w-[200px] shadow-lg shadow-primary/20\"\r\n                    size=\"lg\"\r\n                  >\r\n                    {savingAutomation ? (\r\n                      <>\r\n                        <Plus className=\"mr-2 h-4 w-4 animate-spin\" /> Saving...\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Settings className=\"mr-2 h-4 w-4\" /> Save Automation Settings\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <Card className=\"border-primary/10 bg-gradient-to-br from-white to-slate-50/50\">\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Monitoring</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div className=\"flex justify-between items-center text-sm\">\r\n                    <span className=\"text-muted-foreground\">Last automated run</span>\r\n                    <span className=\"font-medium\">Never (Scheduled)</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center text-sm\">\r\n                    <span className=\"text-muted-foreground\">Emails sent today</span>\r\n                    <span className=\"font-medium text-primary\">0 emails</span>\r\n                  </div>\r\n                  <div className=\"pt-4 border-t\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"w-full gap-2\"\r\n                      onClick={handleTestAutomation}\r\n                      disabled={testingAutomation}\r\n                    >\r\n                      <Activity className={`h-4 w-4 ${testingAutomation ? 'animate-spin' : ''}`} />\r\n                      {testingAutomation ? 'Scanning...' : 'Test Full Automation Scan'}\r\n                    </Button>\r\n                    <p className=\"text-[10px] text-slate-400 mt-2\">\r\n                      Triggers the Master Job logic for all organizations.\r\n                    </p>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card className=\"border-primary/10 bg-gradient-to-br from-white to-slate-50/50\">\r\n                <CardHeader>\r\n                  <CardTitle className=\"text-lg\">Manual Override</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <p className=\"text-sm text-muted-foreground mb-4\">\r\n                    Need to send reminders right now? Use the trigger on the Overview tab.\r\n                  </p>\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setActiveTab(\"overview\")}>\r\n                    Go to Trigger\r\n                  </Button>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </TabsContent>\r\n\r\n          {/* CLIENT REMINDERS TAB */}\r\n          <TabsContent value=\"client-reminders\">\r\n            <ClientRemindersTab />\r\n          </TabsContent>\r\n\r\n          {/* USERS TAB - REDESIGNED */}\r\n          <TabsContent value=\"users\">\r\n            {/* üìä Admin Insights Bar */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n              <Card className=\"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-xs text-blue-600 font-medium uppercase tracking-wide\">Total Users</p>\r\n                      <p className=\"text-2xl font-bold text-blue-900\">{users.length}</p>\r\n                    </div>\r\n                    <Users className=\"h-8 w-8 text-blue-400\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-xs text-amber-600 font-medium uppercase tracking-wide\">With Pending</p>\r\n                      <p className=\"text-2xl font-bold text-amber-900\">\r\n                        {users.filter(u => u.tasks?.some(t => !t.completed)).length}\r\n                      </p>\r\n                    </div>\r\n                    <Clock className=\"h-8 w-8 text-amber-400\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"bg-gradient-to-br from-red-50 to-red-100/50 border-red-200\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-xs text-red-600 font-medium uppercase tracking-wide\">Overloaded (&gt;10)</p>\r\n                      <p className=\"text-2xl font-bold text-red-900\">\r\n                        {users.filter(u => (u.tasks?.filter(t => !t.completed).length || 0) > 10).length}\r\n                      </p>\r\n                    </div>\r\n                    <AlertCircle className=\"h-8 w-8 text-red-400\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"bg-gradient-to-br from-slate-50 to-slate-100/50 border-slate-200\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-xs text-slate-600 font-medium uppercase tracking-wide\">Admins / Users</p>\r\n                      <p className=\"text-2xl font-bold text-slate-900\">\r\n                        {users.filter(u => u.role === 'admin').length} / {users.filter(u => u.role === 'user').length}\r\n                      </p>\r\n                    </div>\r\n                    <Shield className=\"h-8 w-8 text-slate-400\" />\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            <Card>\r\n              <CardHeader className=\"pb-4\">\r\n                <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n                  <div>\r\n                    <CardTitle>User Directory</CardTitle>\r\n                    <CardDescription>Manage master user list and permissions ‚Ä¢ Quick overview of workload & status</CardDescription>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap items-center gap-2\">\r\n                    {/* Search */}\r\n                    <div className=\"relative\">\r\n                      <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\r\n                      <Input\r\n                        placeholder=\"Search users...\"\r\n                        className=\"pl-8 w-[180px] h-9\"\r\n                        value={userSearch}\r\n                        onChange={(e) => setUserSearch(e.target.value)}\r\n                      />\r\n                    </div>\r\n                    {/* Sort */}\r\n                    <Select value={userSortBy} onValueChange={(v: \"name\" | \"pending\" | \"total\") => setUserSortBy(v)}>\r\n                      <SelectTrigger className=\"w-[130px] h-9\">\r\n                        <SelectValue placeholder=\"Sort by\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"name\">Name</SelectItem>\r\n                        <SelectItem value=\"pending\">Pending ‚Üì</SelectItem>\r\n                        <SelectItem value=\"total\">Total Tasks ‚Üì</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    {/* Filter Role */}\r\n                    <Select value={userFilterRole} onValueChange={(v: \"all\" | \"admin\" | \"user\") => setUserFilterRole(v)}>\r\n                      <SelectTrigger className=\"w-[100px] h-9\">\r\n                        <SelectValue placeholder=\"Role\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"all\">All Roles</SelectItem>\r\n                        <SelectItem value=\"admin\">Admins</SelectItem>\r\n                        <SelectItem value=\"user\">Users</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    {/* Filter Status */}\r\n                    <Select value={userFilterStatus} onValueChange={(v: \"all\" | \"attention\" | \"progress\" | \"ontrack\" | \"notasks\") => setUserFilterStatus(v)}>\r\n                      <SelectTrigger className=\"w-[140px] h-9\">\r\n                        <SelectValue placeholder=\"Status\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"all\">All Status</SelectItem>\r\n                        <SelectItem value=\"attention\">‚ö†Ô∏è Needs Attention</SelectItem>\r\n                        <SelectItem value=\"progress\">üîÑ In Progress</SelectItem>\r\n                        <SelectItem value=\"ontrack\">‚úÖ On Track</SelectItem>\r\n                        <SelectItem value=\"notasks\">‚Äî No Tasks</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"rounded-md border\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow className=\"bg-muted/50\">\r\n                        <TableHead className=\"w-[250px]\">User</TableHead>\r\n                        <TableHead className=\"text-center\">Tasks</TableHead>\r\n                        <TableHead className=\"text-center\">Status</TableHead>\r\n                        <TableHead className=\"text-center\">Role</TableHead>\r\n                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {(() => {\r\n                        // Helper to get user status\r\n                        const getUserStatus = (user: typeof users[0]) => {\r\n                          const total = user.tasks?.length || 0;\r\n                          const pending = user.tasks?.filter(t => !t.completed).length || 0;\r\n                          if (total === 0) return \"notasks\";\r\n                          if (pending > 10) return \"attention\";\r\n                          if (pending > 0) return \"progress\";\r\n                          return \"ontrack\";\r\n                        };\r\n\r\n                        // Filter and sort users\r\n                        const filteredUsers = users\r\n                          .filter(user => {\r\n                            // Search filter\r\n                            if (userSearch) {\r\n                              const search = userSearch.toLowerCase();\r\n                              const matchesName = user.full_name?.toLowerCase().includes(search);\r\n                              const matchesEmail = user.email?.toLowerCase().includes(search);\r\n                              if (!matchesName && !matchesEmail) return false;\r\n                            }\r\n                            // Role filter\r\n                            if (userFilterRole !== \"all\" && user.role !== userFilterRole) return false;\r\n                            // Status filter\r\n                            if (userFilterStatus !== \"all\" && getUserStatus(user) !== userFilterStatus) return false;\r\n                            return true;\r\n                          })\r\n                          .sort((a, b) => {\r\n                            if (userSortBy === \"name\") {\r\n                              return (a.full_name || \"\").localeCompare(b.full_name || \"\");\r\n                            }\r\n                            if (userSortBy === \"pending\") {\r\n                              const aPending = a.tasks?.filter(t => !t.completed).length || 0;\r\n                              const bPending = b.tasks?.filter(t => !t.completed).length || 0;\r\n                              return bPending - aPending; // Descending\r\n                            }\r\n                            if (userSortBy === \"total\") {\r\n                              return (b.tasks?.length || 0) - (a.tasks?.length || 0); // Descending\r\n                            }\r\n                            return 0;\r\n                          });\r\n\r\n                        if (filteredUsers.length === 0) {\r\n                          return (\r\n                            <TableRow>\r\n                              <TableCell colSpan={5} className=\"text-center py-8 text-muted-foreground\">\r\n                                {users.length === 0 ? \"No users found\" : \"No users match your filters\"}\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          );\r\n                        }\r\n\r\n                        return filteredUsers.map((user) => {\r\n\r\n                          const totalTasks = user.tasks?.length || 0;\r\n                          const pendingTasks = user.tasks?.filter(t => !t.completed).length || 0;\r\n                          const completedTasks = totalTasks - pendingTasks;\r\n\r\n                          // Status logic\r\n                          let statusBadge;\r\n                          if (totalTasks === 0) {\r\n                            statusBadge = <Badge variant=\"outline\" className=\"bg-slate-50 text-slate-500 border-slate-200\">‚Äî No Tasks</Badge>;\r\n                          } else if (pendingTasks > 10) {\r\n                            statusBadge = <Badge variant=\"outline\" className=\"bg-red-50 text-red-700 border-red-200\"><AlertCircle className=\"h-3 w-3 mr-1\" />Needs Attention</Badge>;\r\n                          } else if (pendingTasks > 0) {\r\n                            statusBadge = <Badge variant=\"outline\" className=\"bg-amber-50 text-amber-700 border-amber-200\"><Clock className=\"h-3 w-3 mr-1\" />In Progress</Badge>;\r\n                          } else {\r\n                            statusBadge = <Badge variant=\"outline\" className=\"bg-green-50 text-green-700 border-green-200\"><CheckCircle2 className=\"h-3 w-3 mr-1\" />On Track</Badge>;\r\n                          }\r\n\r\n                          return (\r\n                            <TableRow key={user.id} className=\"hover:bg-muted/30 transition-colors\">\r\n                              <TableCell>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                  <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-primary/20 to-primary/40 flex items-center justify-center font-semibold text-primary\">\r\n                                    {(user.full_name || user.email || \"U\")[0].toUpperCase()}\r\n                                  </div>\r\n                                  <div className=\"flex flex-col\">\r\n                                    <span className=\"font-semibold text-sm\">{user.full_name || \"Un-named User\"}</span>\r\n                                    <span className=\"text-xs text-muted-foreground\">{user.email}</span>\r\n                                  </div>\r\n                                </div>\r\n                              </TableCell>\r\n                              <TableCell>\r\n                                <div\r\n                                  className=\"flex flex-col items-center gap-1 cursor-pointer group hover:bg-slate-100 p-2 rounded-md transition-all\"\r\n                                  onClick={() => setViewTasksUser(user)}\r\n                                >\r\n                                  <span className=\"text-lg font-bold text-slate-800 group-hover:text-primary transition-colors flex items-center gap-2\">\r\n                                    {totalTasks}\r\n                                    <Eye className=\"h-4 w-4 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                                  </span>\r\n                                  <div className=\"flex gap-2 text-xs\">\r\n                                    <span className=\"text-amber-600 font-medium\">{pendingTasks} pending</span>\r\n                                    <span className=\"text-green-600 font-medium\">{completedTasks} done</span>\r\n                                  </div>\r\n                                </div>\r\n                              </TableCell>\r\n                              <TableCell className=\"text-center\">\r\n                                {statusBadge}\r\n                              </TableCell>\r\n                              <TableCell className=\"text-center\">\r\n                                <Badge variant={user.role === \"admin\" ? \"default\" : \"secondary\"} className=\"uppercase text-[10px]\">\r\n                                  {user.role === \"admin\" ? <Shield className=\"h-3 w-3 mr-1\" /> : null}\r\n                                  {user.role}\r\n                                </Badge>\r\n                              </TableCell>\r\n                              <TableCell className=\"text-right\">\r\n                                <DropdownMenu>\r\n                                  <DropdownMenuTrigger asChild>\r\n                                    <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                                      <Settings className=\"h-4 w-4\" />\r\n                                    </Button>\r\n                                  </DropdownMenuTrigger>\r\n                                  <DropdownMenuContent align=\"end\" className=\"w-48\">\r\n                                    <DropdownMenuLabel>Actions</DropdownMenuLabel>\r\n                                    <DropdownMenuSeparator />\r\n                                    <DropdownMenuItem onClick={() => handleExportTasks(user)}>\r\n                                      <FileSpreadsheet className=\"h-4 w-4 mr-2\" /> Export Tasks\r\n                                    </DropdownMenuItem>\r\n                                    <DropdownMenuItem onClick={() => handleEdit(user)}>\r\n                                      <Mail className=\"h-4 w-4 mr-2\" /> Edit User\r\n                                    </DropdownMenuItem>\r\n                                    {user.id !== profile?.id && (\r\n                                      <DropdownMenuItem\r\n                                        className=\"text-destructive focus:text-destructive\"\r\n                                        onClick={() => setDeleteUserId(user.id)}\r\n                                      >\r\n                                        <AlertCircle className=\"h-4 w-4 mr-2\" /> Delete User\r\n                                      </DropdownMenuItem>\r\n                                    )}\r\n                                  </DropdownMenuContent>\r\n                                </DropdownMenu>\r\n                              </TableCell>\r\n                            </TableRow>\r\n                          );\r\n                        });\r\n                      })()}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n        </Tabs>\r\n\r\n        {/* --- Dialogs (Edit, Delete, Transfer) --- */}\r\n        {\r\n          editUser && (\r\n            <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\r\n              <Card className=\"w-full max-w-md shadow-2xl\">\r\n                <CardHeader>\r\n                  <CardTitle>Edit User Profile</CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Full Name</Label>\r\n                    <Input value={editForm.full_name} onChange={(e) => setEditForm({ ...editForm, full_name: e.target.value })} />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Email (Read-only)</Label>\r\n                    <Input value={editForm.email} disabled className=\"bg-muted\" />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Phone</Label>\r\n                    <Input value={editForm.phone} onChange={(e) => setEditForm({ ...editForm, phone: e.target.value })} />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Role</Label>\r\n                    <Select value={editForm.role} onValueChange={(value: \"admin\" | \"user\") => setEditForm({ ...editForm, role: value })}>\r\n                      <SelectTrigger><SelectValue /></SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"user\">User</SelectItem>\r\n                        <SelectItem value=\"admin\">Admin</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                  <div className=\"flex gap-2 pt-4 justify-end\">\r\n                    <Button variant=\"outline\" onClick={() => setEditUser(null)}>Cancel</Button>\r\n                    <Button onClick={handleUpdate}>Save Changes</Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          )\r\n        }\r\n\r\n        {/* Delete Confirmation */}\r\n        <AlertDialog open={!!deleteUserId} onOpenChange={(open) => !open && setDeleteUserId(null)}>\r\n          <AlertDialogContent>\r\n            <AlertDialogHeader>\r\n              <AlertDialogTitle>Are you absolutely sure?</AlertDialogTitle>\r\n              <AlertDialogDescription>\r\n                This action cannot be undone. This will permanently delete the user account and ALL associated tasks.\r\n              </AlertDialogDescription>\r\n            </AlertDialogHeader>\r\n            <AlertDialogFooter>\r\n              <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n              <AlertDialogAction onClick={handleDelete} className=\"bg-destructive hover:bg-destructive/90\">\r\n                Confirm Delete\r\n              </AlertDialogAction>\r\n            </AlertDialogFooter>\r\n          </AlertDialogContent>\r\n        </AlertDialog>\r\n\r\n        {/* Task Transfer Dialog */}\r\n        <TaskTransferDialog\r\n          open={transferDialogOpen}\r\n          onOpenChange={setTransferDialogOpen}\r\n          users={users}\r\n          currentAdminId={profile?.id || \"\"}\r\n          onTransferComplete={() => {\r\n            fetchTotalTasks();\r\n            fetchRecentTasks();\r\n            toast.success(\"Task transfer completed!\");\r\n          }}\r\n        />\r\n\r\n        <CreateTaskDialog\r\n          open={createTaskOpen}\r\n          onOpenChange={setCreateTaskOpen}\r\n          onTaskCreated={() => {\r\n            fetchRecentTasks();\r\n            fetchTotalTasks();\r\n            setRefreshKey(prev => prev + 1);\r\n          }}\r\n        />\r\n\r\n        {/* View User Tasks Sheet */}\r\n        <Sheet open={!!viewTasksUser} onOpenChange={(open) => !open && setViewTasksUser(null)}>\r\n          <SheetContent className=\"sm:max-w-xl w-full overflow-hidden flex flex-col h-full\">\r\n            <SheetHeader className=\"mb-6\">\r\n              <SheetTitle className=\"flex items-center gap-3\">\r\n                <div className=\"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold\">\r\n                  {(viewTasksUser?.full_name || viewTasksUser?.email || \"U\")[0].toUpperCase()}\r\n                </div>\r\n                <div>\r\n                  {viewTasksUser?.full_name || \"Un-named User\"}\r\n                  <span className=\"block text-sm font-normal text-muted-foreground\">{viewTasksUser?.email}</span>\r\n                </div>\r\n              </SheetTitle>\r\n              <SheetDescription>\r\n                Reviewing task workload and compliance status.\r\n              </SheetDescription>\r\n            </SheetHeader>\r\n\r\n            <Tabs defaultValue=\"pending\" className=\"flex-1 flex flex-col h-full overflow-hidden\">\r\n              <TabsList className=\"w-full justify-start border-b rounded-none bg-transparent p-0 mb-4 h-auto\">\r\n                <TabsTrigger value=\"pending\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:shadow-none px-4 py-2\">\r\n                  Pending ({viewTasksUser?.tasks?.filter(t => !t.completed).length || 0})\r\n                </TabsTrigger>\r\n                <TabsTrigger value=\"completed\" className=\"rounded-none border-b-2 border-transparent data-[state=active]:border-primary data-[state=active]:shadow-none px-4 py-2\">\r\n                  Completed ({viewTasksUser?.tasks?.filter(t => t.completed).length || 0})\r\n                </TabsTrigger>\r\n              </TabsList>\r\n\r\n              <ScrollArea className=\"flex-1 pr-4 -mr-4\">\r\n                <TabsContent value=\"pending\" className=\"mt-0 space-y-4 pb-4\">\r\n                  {viewTasksUser?.tasks?.filter(t => !t.completed).length === 0 ? (\r\n                    <div className=\"text-center py-12 border-2 border-dashed rounded-lg text-muted-foreground\">\r\n                      <Trophy className=\"h-12 w-12 mx-auto mb-2 text-yellow-400\" />\r\n                      <p>All clean! No pending tasks.</p>\r\n                    </div>\r\n                  ) : (\r\n                    viewTasksUser?.tasks?.filter(t => !t.completed)\r\n                      .sort((a, b) => new Date(a.deadline || \"\").getTime() - new Date(b.deadline || \"\").getTime())\r\n                      .map(task => (\r\n                        <TaskCard\r\n                          key={task.id}\r\n                          task={task}\r\n                          onComplete={() => {\r\n                            // Optimistic update\r\n                            const updatedTask = { ...task, completed: true };\r\n                            const updatedUser = {\r\n                              ...viewTasksUser,\r\n                              tasks: viewTasksUser.tasks?.map(t => t.id === task.id ? updatedTask : t)\r\n                            };\r\n                            setViewTasksUser(updatedUser);\r\n\r\n                            // Re-fetch in background\r\n                            setTimeout(fetchUsers, 500);\r\n                            toast.success(\"Marked as done (Local view)\");\r\n                          }}\r\n                        />\r\n                      ))\r\n                  )}\r\n                </TabsContent>\r\n\r\n                <TabsContent value=\"completed\" className=\"mt-0 space-y-4 pb-4\">\r\n                  {viewTasksUser?.tasks?.filter(t => t.completed).length === 0 ? (\r\n                    <div className=\"text-center py-12 border-2 border-dashed rounded-lg text-muted-foreground\">\r\n                      <p>No completed tasks yet.</p>\r\n                    </div>\r\n                  ) : (\r\n                    viewTasksUser?.tasks?.filter(t => t.completed)\r\n                      .sort((a, b) => new Date(b.created_at || \"\").getTime() - new Date(a.created_at || \"\").getTime())\r\n                      .map(task => (\r\n                        <div key={task.id} className=\"opacity-75\">\r\n                          <TaskCard task={task} onComplete={() => { }} />\r\n                        </div>\r\n                      ))\r\n                  )}\r\n                </TabsContent>\r\n              </ScrollArea>\r\n            </Tabs>\r\n          </SheetContent>\r\n        </Sheet>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\pages\\Auth.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\pages\\Index.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3052,3055],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3052,3055],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":121,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3363,3366],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3363,3366],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useMemo } from \"react\";\r\nimport { ComplianceTask } from \"@/types/task\";\r\nimport { useTasks } from \"@/hooks/useTasks\";\r\nimport {\r\n  filterTasksByCategory,\r\n  getUrgencyLevel,\r\n  getDaysUntilDeadline,\r\n} from \"@/lib/taskUtils\";\r\nimport { Header } from \"@/components/Header\";\r\nimport { StatsCard } from \"@/components/StatsCard\";\r\nimport { CategoryFilter } from \"@/components/CategoryFilter\";\r\nimport { TaskCard } from \"@/components/TaskCard\";\r\nimport { TaskDialog } from \"@/components/TaskDialog\";\r\nimport { EmptyState } from \"@/components/EmptyState\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n  Plus,\r\n  AlertTriangle,\r\n  Bell,\r\n  Clock,\r\n  CheckCircle2,\r\n} from \"lucide-react\";\r\n\r\nconst Index = () => {\r\n  const {\r\n    tasks,\r\n    isLoaded,\r\n    addTask,\r\n    updateTask,\r\n    deleteTask,\r\n    completeTask,\r\n  } = useTasks();\r\n\r\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n  const [editingTask, setEditingTask] =\r\n    useState<ComplianceTask | null>(null);\r\n  const [deleteConfirmId, setDeleteConfirmId] =\r\n    useState<string | null>(null);\r\n\r\n  // ‚úÖ ALL categories (default + custom)\r\n  const categories = useMemo(() => {\r\n    return Array.from(new Set(tasks.map((t) => t.category)));\r\n  }, [tasks]);\r\n\r\n  // Stats\r\n  const stats = useMemo(() => {\r\n    const pending = tasks.filter((t) => !t.completed);\r\n    const completed = tasks.filter((t) => t.completed);\r\n\r\n    const urgent = pending.filter(\r\n      (t) => getUrgencyLevel(t) === \"urgent\"\r\n    );\r\n\r\n    const dueSoon = pending.filter((t) => {\r\n      const days = getDaysUntilDeadline(t.deadline);\r\n      return days > 0 && days <= 5;\r\n    });\r\n\r\n    return {\r\n      total: pending.length,\r\n      urgent: urgent.length,\r\n      dueSoon: dueSoon.length,\r\n      completed: completed.length,\r\n    };\r\n  }, [tasks]);\r\n\r\n  // Filtered task groups\r\n  const taskGroups = useMemo(() => {\r\n    const filtered = filterTasksByCategory(tasks, selectedCategory);\r\n    const pending = filtered.filter((t) => !t.completed);\r\n    const completed = filtered.filter((t) => t.completed);\r\n\r\n    return {\r\n      urgent: pending.filter(\r\n        (t) => getUrgencyLevel(t) === \"urgent\"\r\n      ),\r\n      warning: pending.filter(\r\n        (t) => getUrgencyLevel(t) === \"warning\"\r\n      ),\r\n      upcoming: pending.filter(\r\n        (t) => getUrgencyLevel(t) === \"upcoming\"\r\n      ),\r\n      normal: pending.filter(\r\n        (t) => getUrgencyLevel(t) === \"normal\"\r\n      ),\r\n      completed,\r\n    };\r\n  }, [tasks, selectedCategory]);\r\n\r\n  const handleAddTask = async (\r\n    taskData: Omit<ComplianceTask, \"id\" | \"completed\">\r\n  ) => {\r\n    try {\r\n      await addTask(taskData);\r\n      toast.success(\"Task added\");\r\n    } catch (e: any) {\r\n      toast.error(e.message || \"Failed to add task\");\r\n    }\r\n  };\r\n\r\n  const handleUpdateTask = async (\r\n    id: string,\r\n    updates: Partial<ComplianceTask>\r\n  ) => {\r\n    try {\r\n      await updateTask(id, updates);\r\n      setEditingTask(null);\r\n      toast.success(\"Task updated\");\r\n    } catch (e: any) {\r\n      toast.error(e.message || \"Failed to update task\");\r\n    }\r\n  };\r\n\r\n  const handleDeleteConfirm = async () => {\r\n    if (!deleteConfirmId) return;\r\n    try {\r\n      await deleteTask(deleteConfirmId);\r\n      toast.success(\"Task deleted\");\r\n    } catch {\r\n      toast.error(\"Failed to delete task\");\r\n    } finally {\r\n      setDeleteConfirmId(null);\r\n    }\r\n  };\r\n\r\n  if (!isLoaded) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        Loading...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <Header />\r\n\r\n      <main className=\"container mx-auto px-4 py-6 max-w-5xl\">\r\n        {/* Stats */}\r\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n          <StatsCard title=\"Pending\" value={stats.total} icon={Clock} />\r\n          <StatsCard\r\n            title=\"Urgent\"\r\n            value={stats.urgent}\r\n            icon={AlertTriangle}\r\n            variant=\"urgent\"\r\n          />\r\n          <StatsCard\r\n            title=\"Due Soon\"\r\n            value={stats.dueSoon}\r\n            icon={Bell}\r\n            variant=\"warning\"\r\n          />\r\n          <StatsCard\r\n            title=\"Completed\"\r\n            value={stats.completed}\r\n            icon={CheckCircle2}\r\n            variant=\"success\"\r\n          />\r\n        </div>\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex flex-col sm:flex-row justify-between gap-4 mb-6\">\r\n          <CategoryFilter\r\n            selected={selectedCategory}\r\n            onSelect={setSelectedCategory}\r\n            categories={categories}\r\n          />\r\n\r\n          <Button onClick={() => setDialogOpen(true)}>\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            Add Task\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Tasks */}\r\n        {tasks.length === 0 ? (\r\n          <EmptyState onAddTask={() => setDialogOpen(true)} />\r\n        ) : (\r\n          <div className=\"space-y-6\">\r\n            {Object.entries(taskGroups).map(\r\n              ([key, list]) =>\r\n                list.length > 0 && (\r\n                  <div key={key} className=\"space-y-3\">\r\n                    {list.map((task) => (\r\n                      <TaskCard\r\n                        key={task.id}\r\n                        task={task}\r\n                        onComplete={completeTask}\r\n                        onEdit={(t) => {\r\n                          setEditingTask(t);\r\n                          setDialogOpen(true);\r\n                        }}\r\n                        onDelete={(id) => setDeleteConfirmId(id)}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                )\r\n            )}\r\n          </div>\r\n        )}\r\n      </main>\r\n\r\n      {/* Task Dialog */}\r\n      <TaskDialog\r\n        open={dialogOpen}\r\n        onOpenChange={setDialogOpen}\r\n        task={editingTask}\r\n        onSave={handleAddTask}\r\n        onUpdate={handleUpdateTask}\r\n      />\r\n\r\n      {/* Delete Confirm */}\r\n      <AlertDialog\r\n        open={!!deleteConfirmId}\r\n        onOpenChange={() => setDeleteConfirmId(null)}\r\n      >\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>Delete Task?</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              This cannot be undone.\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\r\n            <AlertDialogAction\r\n              onClick={handleDeleteConfirm}\r\n              className=\"bg-destructive\"\r\n            >\r\n              Delete\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Index;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\pages\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\pages\\ResetPassword.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\pages\\Settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\routes\\ProtectedAdminRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\test\\example.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\test\\setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\types\\task.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\utils\\emailService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[684,687],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[684,687],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from \"@/integrations/supabase/client\";\r\n\r\nexport async function triggerEmailReminders(targetUserId?: string): Promise<{\r\n  success: boolean;\r\n  message: string;\r\n  sent?: number;\r\n}> {\r\n  try {\r\n    // üîê This automatically attaches the logged-in user's access token\r\n    const { data, error } = await supabase.functions.invoke(\r\n      \"send-task-reminders\",\r\n      {\r\n        body: { targetUserId },\r\n      }\r\n    );\r\n\r\n    if (error) {\r\n      console.error(\"Edge Function error:\", error);\r\n      throw error;\r\n    }\r\n\r\n    return {\r\n      success: true,\r\n      message: \"Email reminders sent successfully\",\r\n      sent: data?.sent ?? 0,\r\n    };\r\n  } catch (err: any) {\r\n    console.error(\"Email reminder error:\", err);\r\n    return {\r\n      success: false,\r\n      message: err.message || \"Failed to send reminders\",\r\n    };\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\utils\\googleCalendarService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\utils\\taskTransferService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[997,1000],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[997,1000],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1904,1907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1904,1907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4382,4385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4382,4385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":186,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5592,5595],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5592,5595],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from \"@/integrations/supabase/client\";\r\n\r\nexport interface SystemTask {\r\n    id: string;\r\n    name: string;\r\n    category: string;\r\n    deadline: string;\r\n    completed: boolean;\r\n    user_id: string;\r\n    user_email?: string;\r\n    user_name?: string;\r\n}\r\n\r\n/**\r\n * Fetch all tasks in the system (admin only)\r\n * Returns tasks with user information for display\r\n */\r\nexport async function fetchAllSystemTasks(): Promise<SystemTask[]> {\r\n    const { data, error } = await supabase\r\n        .from(\"tasks\")\r\n        .select(`\r\n      id,\r\n      name,\r\n      category,\r\n      deadline,\r\n      completed,\r\n      user_id,\r\n      profiles!tasks_user_id_fkey (\r\n        email,\r\n        full_name\r\n      )\r\n    `)\r\n        .order(\"deadline\", { ascending: true });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching system tasks:\", error);\r\n        throw new Error(\"Failed to fetch tasks\");\r\n    }\r\n\r\n    // Transform data to include user info\r\n    return (data || []).map((task: any) => ({\r\n        id: task.id,\r\n        name: task.name,\r\n        category: task.category,\r\n        deadline: task.deadline,\r\n        completed: task.completed,\r\n        user_id: task.user_id,\r\n        user_email: task.profiles?.email,\r\n        user_name: task.profiles?.full_name,\r\n    }));\r\n}\r\n\r\n/**\r\n * Fetch tasks for a specific user (admin fetching another user's tasks)\r\n */\r\nexport async function fetchUserTasks(userId: string): Promise<SystemTask[]> {\r\n    const { data, error } = await supabase\r\n        .from(\"tasks\")\r\n        .select(`\r\n      id,\r\n      name,\r\n      category,\r\n      deadline,\r\n      completed,\r\n      user_id\r\n    `)\r\n        .eq(\"user_id\", userId)\r\n        .order(\"deadline\", { ascending: true });\r\n\r\n    if (error) {\r\n        console.error(\"Error fetching user tasks:\", error);\r\n        throw new Error(\"Failed to fetch tasks\");\r\n    }\r\n\r\n    return (data || []).map((task: any) => ({\r\n        id: task.id,\r\n        name: task.name,\r\n        category: task.category,\r\n        deadline: task.deadline,\r\n        completed: task.completed,\r\n        user_id: task.user_id,\r\n    }));\r\n}\r\n\r\n/**\r\n * Transfer tasks from one user to another\r\n * @param taskIds - Array of task IDs to transfer\r\n * @param targetUserId - The user ID to transfer tasks to\r\n * @param adminId - The admin performing the transfer (for audit)\r\n * @returns Object with success status and count of transferred tasks\r\n */\r\nexport async function transferTasks(\r\n    taskIds: string[],\r\n    targetUserId: string,\r\n    adminId: string\r\n): Promise<{ success: boolean; count: number; message: string }> {\r\n    if (taskIds.length === 0) {\r\n        return { success: false, count: 0, message: \"No tasks selected\" };\r\n    }\r\n\r\n    try {\r\n        // üõ°Ô∏è SECURITY: Fetch target user's organization_id to ensure task isolation\r\n        const { data: profile, error: profileError } = await supabase\r\n            .from(\"profiles\")\r\n            .select(\"organization_id\")\r\n            .eq(\"id\", targetUserId)\r\n            .single();\r\n\r\n        if (profileError || !profile) {\r\n            console.error(\"Error fetching target user profile:\", profileError);\r\n            throw new Error(\"Target user profile not found or organization missing\");\r\n        }\r\n\r\n        console.log(\"üîÑ TRANSFERRING_TASKS:\", {\r\n            count: taskIds.length,\r\n            targetUserId,\r\n            newOrgId: profile.organization_id,\r\n            adminId\r\n        });\r\n\r\n        // Update all tasks in a single batch\r\n        const { error } = await supabase\r\n            .from(\"tasks\")\r\n            .update({\r\n                user_id: targetUserId,\r\n                organization_id: profile.organization_id, // üõ°Ô∏è SYNC: Move task to new organization\r\n                transferred_from: adminId,\r\n                transferred_at: new Date().toISOString(),\r\n            })\r\n            .in(\"id\", taskIds);\r\n\r\n        if (error) {\r\n            console.error(\"Error transferring tasks:\", error);\r\n            throw error;\r\n        }\r\n\r\n        console.log(\"‚úÖ TRANSFER_SUCCESS:\", {\r\n            count: taskIds.length,\r\n            targetUserId,\r\n            orgId: profile.organization_id\r\n        });\r\n\r\n        return {\r\n            success: true,\r\n            count: taskIds.length,\r\n            message: `Successfully transferred ${taskIds.length} task${taskIds.length > 1 ? \"s\" : \"\"}`,\r\n        };\r\n    } catch (error: any) {\r\n        console.error(\"Transfer failed:\", error);\r\n        return {\r\n            success: false,\r\n            count: 0,\r\n            message: error.message || \"Failed to transfer tasks\",\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Transfer all tasks from one user to another\r\n * @param fromUserId - The user ID to transfer tasks FROM\r\n * @param toUserId - The user ID to transfer tasks TO\r\n * @param adminId - The admin performing the transfer\r\n */\r\nexport async function transferAllUserTasks(\r\n    fromUserId: string,\r\n    toUserId: string,\r\n    adminId: string\r\n): Promise<{ success: boolean; count: number; message: string }> {\r\n    try {\r\n        // First, get all tasks for the source user\r\n        const { data: tasks, error: fetchError } = await supabase\r\n            .from(\"tasks\")\r\n            .select(\"id\")\r\n            .eq(\"user_id\", fromUserId);\r\n\r\n        if (fetchError) {\r\n            throw fetchError;\r\n        }\r\n\r\n        if (!tasks || tasks.length === 0) {\r\n            return { success: false, count: 0, message: \"No tasks found to transfer\" };\r\n        }\r\n\r\n        const taskIds = tasks.map((t) => t.id);\r\n        return await transferTasks(taskIds, toUserId, adminId);\r\n    } catch (error: any) {\r\n        console.error(\"Transfer all tasks failed:\", error);\r\n        return {\r\n            success: false,\r\n            count: 0,\r\n            message: error.message || \"Failed to transfer tasks\",\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * Export a user's tasks to a CSV file\r\n * @param tasks - Array of tasks to export\r\n * @param userName - Name of the user (for filename)\r\n */\r\nexport function downloadTasksCSV(tasks: SystemTask[], userName: string) {\r\n    if (!tasks || tasks.length === 0) {\r\n        return;\r\n    }\r\n\r\n    // Define columns\r\n    const headers = [\r\n        \"Task ID\",\r\n        \"Name\",\r\n        \"Category\",\r\n        \"Deadline\",\r\n        \"Status\"\r\n    ];\r\n\r\n    // Format data rows\r\n    const rows = tasks.map(task => [\r\n        task.id,\r\n        `\"${task.name.replace(/\"/g, '\"\"')}\"`, // Escape quotes\r\n        task.category,\r\n        new Date(task.deadline).toLocaleDateString(),\r\n        task.completed ? \"Completed\" : \"Pending\"\r\n    ]);\r\n\r\n    // Combine headers and rows\r\n    const csvContent = [\r\n        headers.join(\",\"),\r\n        ...rows.map(row => row.join(\",\"))\r\n    ].join(\"\\n\");\r\n\r\n    // Create a Blob\r\n    const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n\r\n    // Create download link\r\n    const link = document.createElement(\"a\");\r\n    if (link.download !== undefined) {\r\n        const url = URL.createObjectURL(blob);\r\n        const dateStr = new Date().toISOString().split('T')[0];\r\n        const safeUserName = userName.replace(/[^a-z0-9]/gi, '_').toLowerCase();\r\n        link.setAttribute(\"href\", url);\r\n        link.setAttribute(\"download\", `tasks_${safeUserName}_${dateStr}.csv`);\r\n        link.style.visibility = \"hidden\";\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\supabase\\functions\\google-oauth-callback\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\supabase\\functions\\google-oauth-start\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\supabase\\functions\\send-client-reminders\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":105,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3583,3586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3583,3586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":164,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6117,6120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6117,6120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":179,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6627,6630],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6627,6630],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { serve } from \"https://deno.land/std@0.168.0/http/server.ts\";\r\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2\";\r\nimport { z } from \"https://deno.land/x/zod@v3.22.4/mod.ts\";\r\n\r\n// --- SECURITY: Rate Limiting ---\r\nconst rateLimitStore = new Map<string, { count: number; resetTime: number }>();\r\nconst RATE_LIMIT_WINDOW = 60 * 1000; // 1 minute\r\nconst MAX_REQUESTS_PER_WINDOW = 10;\r\n\r\nfunction isRateLimited(ip: string): boolean {\r\n    const now = Date.now();\r\n    const userData = rateLimitStore.get(ip);\r\n\r\n    if (!userData || now > userData.resetTime) {\r\n        rateLimitStore.set(ip, { count: 1, resetTime: now + RATE_LIMIT_WINDOW });\r\n        return false;\r\n    }\r\n\r\n    if (userData.count >= MAX_REQUESTS_PER_WINDOW) {\r\n        return true;\r\n    }\r\n\r\n    userData.count++;\r\n    return false;\r\n}\r\n\r\n// --- Input Validation Schema ---\r\nconst RecipientSchema = z.object({\r\n    email: z.string().email(),\r\n    name: z.string().min(1),\r\n    tasks: z.array(z.string()).optional(),\r\n});\r\n\r\nconst RequestSchema = z.object({\r\n    recipients: z.array(RecipientSchema).min(1).max(50),\r\n    subject: z.string().min(1).max(200),\r\n    body: z.string().min(1).max(5000),\r\n});\r\n\r\nconst corsHeaders = {\r\n    \"Access-Control-Allow-Origin\": \"*\",\r\n    \"Access-Control-Allow-Headers\":\r\n        \"authorization, x-client-info, apikey, content-type\",\r\n    \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\r\n};\r\n\r\nserve(async (req) => {\r\n    if (req.method === \"OPTIONS\") {\r\n        return new Response(null, { status: 204, headers: corsHeaders });\r\n    }\r\n\r\n    // üõ°Ô∏è Rate Limiting\r\n    const clientIp = req.headers.get(\"x-real-ip\") || req.headers.get(\"x-forwarded-for\") || \"unknown\";\r\n    if (isRateLimited(clientIp)) {\r\n        return new Response(\r\n            JSON.stringify({ error: \"Too many requests. Please try again later.\" }),\r\n            { status: 429, headers: { ...corsHeaders, \"Retry-After\": \"60\" } }\r\n        );\r\n    }\r\n\r\n    try {\r\n        const supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\r\n        const serviceRoleKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\r\n        const resendKey = Deno.env.get(\"RESEND_API_KEY\");\r\n\r\n        if (!supabaseUrl || !serviceRoleKey || !resendKey) {\r\n            return new Response(\r\n                JSON.stringify({ error: \"Missing server configuration\" }),\r\n                { status: 500, headers: corsHeaders }\r\n            );\r\n        }\r\n\r\n        // üîê Auth: Require Admin role\r\n        const authHeader = req.headers.get(\"Authorization\") ?? \"\";\r\n        const supabaseUser = createClient(supabaseUrl, serviceRoleKey, {\r\n            global: { headers: { Authorization: authHeader } },\r\n        });\r\n\r\n        const { data: { user }, error: authError } = await supabaseUser.auth.getUser();\r\n        if (!user || authError) {\r\n            return new Response(\r\n                JSON.stringify({ error: \"Unauthorized\" }),\r\n                { status: 401, headers: corsHeaders }\r\n            );\r\n        }\r\n\r\n        const { data: profile } = await supabaseUser\r\n            .from(\"profiles\")\r\n            .select(\"role, organization_id\")\r\n            .eq(\"id\", user.id)\r\n            .single();\r\n\r\n        if (profile?.role !== \"admin\") {\r\n            return new Response(\r\n                JSON.stringify({ error: \"Admin access required\" }),\r\n                { status: 403, headers: corsHeaders }\r\n            );\r\n        }\r\n\r\n        // üõ°Ô∏è Validate Input\r\n        let payload;\r\n        try {\r\n            const rawBody = await req.json();\r\n            payload = RequestSchema.parse(rawBody);\r\n        } catch (err: any) {\r\n            return new Response(\r\n                JSON.stringify({ error: \"Invalid request\", details: err.errors }),\r\n                { status: 400, headers: corsHeaders }\r\n            );\r\n        }\r\n\r\n        const { recipients, subject, body } = payload;\r\n\r\n        console.log(`Admin ${user.email} sending client reminders to ${recipients.length} recipients`);\r\n\r\n        let sent = 0;\r\n        const errors: string[] = [];\r\n\r\n        for (const recipient of recipients) {\r\n            try {\r\n                // Build task list for email\r\n                const taskList = recipient.tasks?.length\r\n                    ? `<ul>${recipient.tasks.map(t => `<li>${t}</li>`).join(\"\")}</ul>`\r\n                    : \"\";\r\n\r\n                const htmlBody = `\r\n          <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\r\n            <h2 style=\"color: #1a365d;\">Compliance Reminder</h2>\r\n            <p>Dear ${recipient.name},</p>\r\n            <div style=\"white-space: pre-wrap;\">${body.replace(/\\n/g, \"<br>\")}</div>\r\n            ${taskList ? `<h3>Your Pending Tasks:</h3>${taskList}` : \"\"}\r\n            <hr style=\"margin: 20px 0; border: none; border-top: 1px solid #e2e8f0;\">\r\n            <p style=\"color: #718096; font-size: 12px;\">\r\n              This is an automated reminder from Compliance Tracker.\r\n            </p>\r\n          </div>\r\n        `;\r\n\r\n                const res = await fetch(\"https://api.resend.com/emails\", {\r\n                    method: \"POST\",\r\n                    headers: {\r\n                        Authorization: `Bearer ${resendKey}`,\r\n                        \"Content-Type\": \"application/json\",\r\n                    },\r\n                    body: JSON.stringify({\r\n                        from: \"Compliance Tracker <onboarding@resend.dev>\",\r\n                        to: recipient.email,\r\n                        subject: subject,\r\n                        html: htmlBody,\r\n                    }),\r\n                });\r\n\r\n                if (res.ok) {\r\n                    sent++;\r\n                    console.log(`‚úÖ Email sent to ${recipient.email}`);\r\n                } else {\r\n                    const errorData = await res.json();\r\n                    console.error(`‚ùå Failed to send to ${recipient.email}:`, errorData);\r\n                    errors.push(`${recipient.email}: ${errorData.message || \"Send failed\"}`);\r\n                }\r\n\r\n                // Rate limit to Resend API\r\n                await new Promise((r) => setTimeout(r, 500));\r\n            } catch (err: any) {\r\n                console.error(`Error sending to ${recipient.email}:`, err);\r\n                errors.push(`${recipient.email}: ${err.message}`);\r\n            }\r\n        }\r\n\r\n        return new Response(\r\n            JSON.stringify({\r\n                success: true,\r\n                sent,\r\n                failed: recipients.length - sent,\r\n                errors: errors.length > 0 ? errors : undefined,\r\n            }),\r\n            { status: 200, headers: corsHeaders }\r\n        );\r\n    } catch (err: any) {\r\n        console.error(\"Function error:\", err);\r\n        return new Response(\r\n            JSON.stringify({ error: err.message }),\r\n            { status: 500, headers: corsHeaders }\r\n        );\r\n    }\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\supabase\\functions\\send-task-reminders\\index.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3227,3230],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3227,3230],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":257,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":257,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10377,10380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10377,10380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":296,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11821,11824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11821,11824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":312,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":312,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12538,12541],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12538,12541],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":354,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":354,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14199,14202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14199,14202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// @ts-nocheck\r\nimport { serve } from \"https://deno.land/std@0.177.0/http/server.ts\";\r\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.39.3\";\r\nimport { z } from \"https://deno.land/x/zod@v3.22.4/mod.ts\";\r\nimport nodemailer from \"npm:nodemailer@6.9.10\";\r\n\r\n// --- SECURITY: Rate Limiting ---\r\n// In-memory store for rate limiting (per function instance)\r\nconst rateLimitStore = new Map<string, { count: number; resetTime: number }>();\r\nconst RATE_LIMIT_WINDOW = 60 * 1000; // 1 minute\r\nconst MAX_REQUESTS_PER_WINDOW = 5;    // Max 5 triggerings per minute per IP\r\n\r\nfunction isRateLimited(ip: string): boolean {\r\n  const now = Date.now();\r\n  const userData = rateLimitStore.get(ip);\r\n\r\n  if (!userData || now > userData.resetTime) {\r\n    rateLimitStore.set(ip, { count: 1, resetTime: now + RATE_LIMIT_WINDOW });\r\n    return false;\r\n  }\r\n\r\n  if (userData.count >= MAX_REQUESTS_PER_WINDOW) {\r\n    return true;\r\n  }\r\n\r\n  userData.count++;\r\n  return false;\r\n}\r\n\r\n// --- SECURITY: Input Validation ---\r\nconst ClientRecipientSchema = z.object({\r\n  email: z.string().email(),\r\n  name: z.string().min(1),\r\n  tasks: z.array(z.string()).optional(),\r\n});\r\n\r\nconst RequestSchema = z.object({\r\n  targetUserId: z.string().uuid().optional().nullable(),\r\n  isAutomatedTrigger: z.boolean().optional(),\r\n  // NEW: Direct client email mode\r\n  clientMode: z.boolean().optional(),\r\n  recipients: z.array(ClientRecipientSchema).optional(),\r\n  subject: z.string().max(200).optional(),\r\n  body: z.string().max(5000).optional(),\r\n});\r\n\r\nconst corsHeaders = {\r\n  \"Access-Control-Allow-Origin\": \"*\",\r\n  \"Access-Control-Allow-Headers\":\r\n    \"authorization, x-client-info, apikey, content-type\",\r\n  \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\r\n};\r\n\r\nserve(async (req) => {\r\n  if (req.method === \"OPTIONS\") {\r\n    return new Response(null, { status: 204, headers: corsHeaders });\r\n  }\r\n\r\n  // üõ°Ô∏è SECURITY: Rate Limiting check\r\n  const clientIp = req.headers.get(\"x-real-ip\") || req.headers.get(\"x-forwarded-for\") || \"unknown\";\r\n  if (isRateLimited(clientIp)) {\r\n    console.warn(`Rate limit exceeded for IP: ${clientIp}`);\r\n    return new Response(\r\n      JSON.stringify({ error: \"Too many requests. Please try again in a minute.\" }),\r\n      { status: 429, headers: { ...corsHeaders, \"Retry-After\": \"60\" } }\r\n    );\r\n  }\r\n\r\n  try {\r\n    const supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\r\n    const serviceRoleKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\r\n    const gmailUser = Deno.env.get(\"GMAIL_USER\");\r\n    const gmailPass = Deno.env.get(\"GMAIL_APP_PASSWORD\");\r\n\r\n    if (!supabaseUrl || !serviceRoleKey || !gmailUser || !gmailPass) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Missing config: GMAIL_USER or GMAIL_APP_PASSWORD\" }),\r\n        { status: 500, headers: corsHeaders }\r\n      );\r\n    }\r\n\r\n    // Configure Nodemailer Transporter\r\n    const transporter = nodemailer.createTransport({\r\n      service: \"gmail\",\r\n      auth: {\r\n        user: gmailUser,\r\n        pass: gmailPass,\r\n      },\r\n    });\r\n\r\n    // üõ°Ô∏è SECURITY: Strict Input Validation\r\n    let payload;\r\n    try {\r\n      const rawBody = await req.json().catch(() => ({}));\r\n      payload = RequestSchema.parse(rawBody);\r\n    } catch (err: any) {\r\n      return new Response(\r\n        JSON.stringify({ error: \"Invalid request payload\", details: err.errors }),\r\n        { status: 400, headers: corsHeaders }\r\n      );\r\n    }\r\n\r\n    const { targetUserId, isAutomatedTrigger } = payload;\r\n    const authHeader = req.headers.get(\"Authorization\") ?? \"\";\r\n    const apiKeyHeader = req.headers.get(\"apikey\") ?? \"\";\r\n\r\n    // Check if either header contains the service role key\r\n    const isServiceKey = (serviceRoleKey && (authHeader.includes(serviceRoleKey) || apiKeyHeader === serviceRoleKey));\r\n\r\n    // üîê Auth check\r\n    let currentOrgId: string | undefined;\r\n\r\n    if (isAutomatedTrigger) {\r\n      // ü§ñ Automated triggers require the Service Role key OR a valid Admin session\r\n      let authorized = !!isServiceKey;\r\n\r\n      if (!authorized && authHeader) {\r\n        // Use ANON key + user's token to verify identity safely\r\n        const anonKey = Deno.env.get(\"SUPABASE_ANON_KEY\") ?? \"\";\r\n        const supabaseUser = createClient(supabaseUrl, anonKey, {\r\n          global: { headers: { Authorization: authHeader } },\r\n        });\r\n\r\n        const token = authHeader.replace(\"Bearer \", \"\");\r\n        const { data: { user } } = await supabaseUser.auth.getUser(token);\r\n\r\n        if (user) {\r\n          // Use service role to query profile (bypass RLS)\r\n          const supabaseAdmin = createClient(supabaseUrl, serviceRoleKey);\r\n          const { data: profile } = await supabaseAdmin.from(\"profiles\").select(\"role\").eq(\"id\", user.id).single();\r\n\r\n          if (profile?.role === \"admin\") {\r\n            authorized = true;\r\n            console.log(`Admin ${user.email} triggered a manual multi-tenant scan.`);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!authorized) {\r\n        console.error(\"Automated trigger blocked: Unauthorized access attempt\");\r\n        return new Response(\r\n          JSON.stringify({ error: \"Unauthorized: Automation scan requires Admin or Service Key\" }),\r\n          { status: 401, headers: corsHeaders }\r\n        );\r\n      }\r\n      console.log(\"Processing multi-tenant automation scan...\");\r\n    } else if (payload.clientMode) {\r\n      // üìß Client mode: Allow service key OR authenticated admin user\r\n      if (isServiceKey) {\r\n        console.log(\"Client mode with service role key - authorized\");\r\n      } else if (authHeader) {\r\n        // Use ANON key + user's token to verify identity safely\r\n        const anonKey = Deno.env.get(\"SUPABASE_ANON_KEY\") ?? \"\";\r\n        const supabaseUser = createClient(supabaseUrl, anonKey, {\r\n          global: { headers: { Authorization: authHeader } },\r\n        });\r\n\r\n        const token = authHeader.replace(\"Bearer \", \"\");\r\n        const { data: { user }, error: authError } = await supabaseUser.auth.getUser(token);\r\n\r\n        if (!user || authError) {\r\n          console.error(\"Client mode auth failed: No valid user\", authError);\r\n          return new Response(JSON.stringify({\r\n            error: \"Unauthorized\",\r\n            details: \"User token validation failed\",\r\n            debug: authError?.message\r\n          }), { status: 401, headers: corsHeaders });\r\n        }\r\n\r\n        console.log(`Client mode: User ${user.email} verified, checking admin role...`);\r\n\r\n        // Use service role to query profile (bypass RLS)\r\n        const supabaseAdmin = createClient(supabaseUrl, serviceRoleKey);\r\n        const { data: profile, error: profileError } = await supabaseAdmin\r\n          .from(\"profiles\")\r\n          .select(\"role\")\r\n          .eq(\"id\", user.id)\r\n          .single();\r\n\r\n        console.log(`Profile query result:`, { profile, profileError });\r\n\r\n        if (profileError || profile?.role !== \"admin\") {\r\n          console.error(\"Client mode auth failed: Not admin or query failed\", profile?.role, profileError);\r\n          return new Response(JSON.stringify({\r\n            error: \"Admin only\",\r\n            details: \"User is not an admin\",\r\n            role: profile?.role\r\n          }), { status: 403, headers: corsHeaders });\r\n        }\r\n        console.log(`Client mode authorized for admin: ${user.email}`);\r\n      } else {\r\n        console.error(\"Client mode auth failed: No auth header or service key\");\r\n        return new Response(JSON.stringify({ error: \"Unauthorized\", details: \"Missing Authorization header\" }), { status: 401, headers: corsHeaders });\r\n      }\r\n    } else {\r\n      // üë§ Manual triggers require Admin role\r\n      // Use ANON key + user's token to verify identity safely\r\n      const anonKey = Deno.env.get(\"SUPABASE_ANON_KEY\") ?? \"\";\r\n      const supabaseUser = createClient(supabaseUrl, anonKey, {\r\n        global: { headers: { Authorization: authHeader } },\r\n      });\r\n\r\n      const token = authHeader.replace(\"Bearer \", \"\");\r\n      const { data: { user }, error: authError } = await supabaseUser.auth.getUser(token);\r\n\r\n      if (!user || authError) return new Response(JSON.stringify({ error: \"Unauthorized\" }), { status: 401, headers: corsHeaders });\r\n\r\n      // Use service role to query profile (bypass RLS)\r\n      const supabaseAdmin = createClient(supabaseUrl, serviceRoleKey);\r\n      const { data: profile } = await supabaseAdmin\r\n        .from(\"profiles\")\r\n        .select(\"role, organization_id\")\r\n        .eq(\"id\", user.id)\r\n        .single();\r\n\r\n      if (profile?.role !== \"admin\") return new Response(JSON.stringify({ error: \"Admin only\" }), { status: 403, headers: corsHeaders });\r\n\r\n      currentOrgId = profile.organization_id;\r\n      console.log(`Manual trigger by Admin: ${user.email} for Org: ${currentOrgId}`);\r\n    }\r\n\r\n    // üìß CLIENT MODE: Send custom emails to specific recipients\r\n    if (payload.clientMode && payload.recipients && payload.recipients.length > 0) {\r\n      console.log(`Client mode: Sending to ${payload.recipients.length} recipients`);\r\n\r\n      let sent = 0;\r\n      const errors: string[] = [];\r\n\r\n      for (const recipient of payload.recipients) {\r\n        try {\r\n          const taskList = recipient.tasks?.length\r\n            ? `<ul>${recipient.tasks.map((t: string) => `<li>${t}</li>`).join(\"\")}</ul>`\r\n            : \"\";\r\n\r\n          const htmlBody = `\r\n            <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\r\n              <h2 style=\"color: #1a365d;\">Compliance Reminder</h2>\r\n              <p>Dear ${recipient.name},</p>\r\n              <div style=\"white-space: pre-wrap;\">${(payload.body || \"\").replace(/\\n/g, \"<br>\")}</div>\r\n              ${taskList ? `<h3>Your Pending Tasks:</h3>${taskList}` : \"\"}\r\n              <hr style=\"margin: 20px 0; border: none; border-top: 1px solid #e2e8f0;\">\r\n              <p style=\"color: #718096; font-size: 12px;\">This is an automated reminder from Compliance Tracker.</p>\r\n            </div>\r\n          `;\r\n\r\n          await transporter.sendMail({\r\n            from: `Compliance Tracker <${gmailUser}>`,\r\n            to: recipient.email,\r\n            subject: payload.subject || \"Compliance Reminder\",\r\n            html: htmlBody,\r\n          });\r\n\r\n          // console.log(`‚úÖ Client email sent to ${recipient.email}`); // Optional logging\r\n          sent++;\r\n\r\n          await new Promise((r) => setTimeout(r, 500));\r\n        } catch (err: any) {\r\n          console.error(`Failed to send to ${recipient.email}:`, err);\r\n          errors.push(`${recipient.email}: ${err.message}`);\r\n        }\r\n      }\r\n\r\n      return new Response(\r\n        JSON.stringify({ success: true, sent, failed: payload.recipients.length - sent, errors: errors.length > 0 ? errors : undefined }),\r\n        { status: 200, headers: corsHeaders }\r\n      );\r\n    }\r\n\r\n    const supabaseAdmin = createClient(supabaseUrl, serviceRoleKey);\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    const fiveDaysLater = new Date(today);\r\n    fiveDaysLater.setDate(today.getDate() + 5);\r\n\r\n    let query = supabaseAdmin\r\n      .from(\"tasks\")\r\n      .select(`\r\n        id, user_id, organization_id, name, deadline,\r\n        profiles!tasks_user_id_fkey ( email, full_name, notify_email )\r\n      `)\r\n      .eq(\"completed\", false)\r\n      .gte(\"deadline\", today.toISOString())\r\n      .lte(\"deadline\", fiveDaysLater.toISOString());\r\n\r\n    if (isAutomatedTrigger) {\r\n      // ‚è∞ Filter by current UTC time (HH:mm)\r\n      const now = new Date();\r\n      const currentTime = `${now.getUTCHours().toString().padStart(2, \"0\")}:${now.getUTCMinutes().toString().padStart(2, \"0\")}`;\r\n\r\n      const { data: activeOrgs } = await supabaseAdmin\r\n        .from(\"organizations\")\r\n        .select(\"id\")\r\n        .eq(\"is_automation_enabled\", true)\r\n        .eq(\"reminder_time\", currentTime);\r\n\r\n      const orgIds = (activeOrgs as any[])?.map(o => o.id) || [];\r\n      if (orgIds.length === 0) {\r\n        console.log(`No organizations scheduled for ${currentTime} UTC`);\r\n        return new Response(JSON.stringify({ success: true, sent: 0, message: \"No scheduled orgs\" }), { status: 200, headers: corsHeaders });\r\n      }\r\n      query = query.in(\"organization_id\", orgIds);\r\n    } else if (targetUserId) {\r\n      query = query.eq(\"user_id\", targetUserId);\r\n    } else if (currentOrgId) {\r\n      query = query.eq(\"organization_id\", currentOrgId);\r\n    }\r\n\r\n    const { data: tasks, error: fetchError } = await query;\r\n    if (fetchError) throw fetchError;\r\n\r\n    // Filter tasks whose users actually want emails\r\n    const tasksToNotify = (tasks as any[])?.filter(t => t.profiles?.notify_email) || [];\r\n    console.log(`Final tasks to notify: ${tasksToNotify.length}`);\r\n\r\n    let sent = 0;\r\n    for (const task of tasksToNotify) {\r\n      // üõ°Ô∏è SPAM PROTECTION: Check if already sent today\r\n      const todayDate = new Date().toISOString().split('T')[0];\r\n      const { data: existingLog } = await supabaseAdmin\r\n        .from(\"notification_logs\")\r\n        .select(\"id\")\r\n        .eq(\"task_id\", task.id)\r\n        .gte(\"sent_at\", todayDate + \"T00:00:00Z\")\r\n        .lte(\"sent_at\", todayDate + \"T23:59:59Z\")\r\n        .limit(1);\r\n\r\n      // Note: The notification_logs table has a refined index on sent_at\r\n\r\n      // Note: The notification_logs table has a refined index on sent_at\r\n\r\n      try {\r\n        await transporter.sendMail({\r\n          from: `Compliance Tracker <${gmailUser}>`,\r\n          to: task.profiles.email,\r\n          subject: `‚è∞ Reminder: ${task.name} is due soon`,\r\n          html: `<p>Hello ${task.profiles.full_name || \"User\"},</p><p>Your task <b>${task.name}</b> is due on ${new Date(task.deadline).toDateString()}.</p>`,\r\n        });\r\n\r\n        sent++;\r\n        await supabaseAdmin.from(\"notification_logs\").insert({\r\n          task_id: task.id,\r\n          user_id: task.user_id,\r\n          organization_id: task.organization_id,\r\n          channel: \"email\",\r\n          status: \"sent\",\r\n        });\r\n      } catch (err) {\r\n        console.error(`Failed to send to ${task.profiles.email}`, err);\r\n      }\r\n      await new Promise(r => setTimeout(r, 500));\r\n    }\r\n\r\n    return new Response(JSON.stringify({ success: true, sent }), { status: 200, headers: corsHeaders });\r\n  } catch (err: any) {\r\n    console.error(\"Function error:\", err);\r\n    return new Response(JSON.stringify({ error: err.message }), { status: 500, headers: corsHeaders });\r\n  }\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\supabase\\functions\\sync-calendar-event\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\tailwind.config.ts","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":129,"column":13,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":129,"endColumn":43}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./pages/**/*.{ts,tsx}\", \"./components/**/*.{ts,tsx}\", \"./app/**/*.{ts,tsx}\", \"./src/**/*.{ts,tsx}\"],\n  prefix: \"\",\n  theme: {\n    container: {\n      center: true,\n      padding: \"2rem\",\n      screens: {\n        \"2xl\": \"1400px\",\n      },\n    },\n    extend: {\n      colors: {\n        border: \"hsl(var(--border))\",\n        input: \"hsl(var(--input))\",\n        ring: \"hsl(var(--ring))\",\n        background: \"hsl(var(--background))\",\n        foreground: \"hsl(var(--foreground))\",\n        primary: {\n          DEFAULT: \"hsl(var(--primary))\",\n          foreground: \"hsl(var(--primary-foreground))\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary))\",\n          foreground: \"hsl(var(--secondary-foreground))\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive))\",\n          foreground: \"hsl(var(--destructive-foreground))\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted))\",\n          foreground: \"hsl(var(--muted-foreground))\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent))\",\n          foreground: \"hsl(var(--accent-foreground))\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover))\",\n          foreground: \"hsl(var(--popover-foreground))\",\n        },\n        card: {\n          DEFAULT: \"hsl(var(--card))\",\n          foreground: \"hsl(var(--card-foreground))\",\n        },\n        sidebar: {\n          DEFAULT: \"hsl(var(--sidebar-background))\",\n          foreground: \"hsl(var(--sidebar-foreground))\",\n          primary: \"hsl(var(--sidebar-primary))\",\n          \"primary-foreground\": \"hsl(var(--sidebar-primary-foreground))\",\n          accent: \"hsl(var(--sidebar-accent))\",\n          \"accent-foreground\": \"hsl(var(--sidebar-accent-foreground))\",\n          border: \"hsl(var(--sidebar-border))\",\n          ring: \"hsl(var(--sidebar-ring))\",\n        },\n        urgent: {\n          DEFAULT: \"hsl(var(--urgent))\",\n          foreground: \"hsl(var(--urgent-foreground))\",\n        },\n        warning: {\n          DEFAULT: \"hsl(var(--warning))\",\n          foreground: \"hsl(var(--warning-foreground))\",\n        },\n        upcoming: {\n          DEFAULT: \"hsl(var(--upcoming))\",\n          foreground: \"hsl(var(--upcoming-foreground))\",\n        },\n        success: {\n          DEFAULT: \"hsl(var(--success))\",\n          foreground: \"hsl(var(--success-foreground))\",\n        },\n        gst: {\n          DEFAULT: \"hsl(var(--gst))\",\n          bg: \"hsl(var(--gst-bg))\",\n        },\n        \"income-tax\": {\n          DEFAULT: \"hsl(var(--income-tax))\",\n          bg: \"hsl(var(--income-tax-bg))\",\n        },\n        insurance: {\n          DEFAULT: \"hsl(var(--insurance))\",\n          bg: \"hsl(var(--insurance-bg))\",\n        },\n        transport: {\n          DEFAULT: \"hsl(var(--transport))\",\n          bg: \"hsl(var(--transport-bg))\",\n        },\n      },\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n        \"pulse-urgent\": {\n          \"0%, 100%\": { opacity: \"1\" },\n          \"50%\": { opacity: \"0.7\" },\n        },\n        \"slide-in\": {\n          from: { opacity: \"0\", transform: \"translateY(-10px)\" },\n          to: { opacity: \"1\", transform: \"translateY(0)\" },\n        },\n        \"fade-in\": {\n          from: { opacity: \"0\" },\n          to: { opacity: \"1\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n        \"pulse-urgent\": \"pulse-urgent 1.5s ease-in-out infinite\",\n        \"slide-in\": \"slide-in 0.3s ease-out\",\n        \"fade-in\": \"fade-in 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\")],\n} satisfies Config;\n","usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"F:\\College\\placement\\projects\\TaskManager\\compliance-companion-main\\vitest.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]